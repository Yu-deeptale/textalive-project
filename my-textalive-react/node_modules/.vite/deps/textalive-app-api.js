import {
  __export
} from "./chunk-HKJ2B2AA.js";

// node_modules/axios/lib/helpers/bind.js
function bind(fn2, thisArg) {
  return function wrap() {
    return fn2.apply(thisArg, arguments);
  };
}

// node_modules/axios/lib/utils.js
var { toString } = Object.prototype;
var { getPrototypeOf } = Object;
var { iterator, toStringTag } = Symbol;
var kindOf = /* @__PURE__ */ ((cache) => (thing) => {
  const str = toString.call(thing);
  return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());
})(/* @__PURE__ */ Object.create(null));
var kindOfTest = (type) => {
  type = type.toLowerCase();
  return (thing) => kindOf(thing) === type;
};
var typeOfTest = (type) => (thing) => typeof thing === type;
var { isArray } = Array;
var isUndefined = typeOfTest("undefined");
function isBuffer(val) {
  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor) && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);
}
var isArrayBuffer = kindOfTest("ArrayBuffer");
function isArrayBufferView(val) {
  let result;
  if (typeof ArrayBuffer !== "undefined" && ArrayBuffer.isView) {
    result = ArrayBuffer.isView(val);
  } else {
    result = val && val.buffer && isArrayBuffer(val.buffer);
  }
  return result;
}
var isString = typeOfTest("string");
var isFunction = typeOfTest("function");
var isNumber = typeOfTest("number");
var isObject = (thing) => thing !== null && typeof thing === "object";
var isBoolean = (thing) => thing === true || thing === false;
var isPlainObject = (val) => {
  if (kindOf(val) !== "object") {
    return false;
  }
  const prototype3 = getPrototypeOf(val);
  return (prototype3 === null || prototype3 === Object.prototype || Object.getPrototypeOf(prototype3) === null) && !(toStringTag in val) && !(iterator in val);
};
var isDate = kindOfTest("Date");
var isFile = kindOfTest("File");
var isBlob = kindOfTest("Blob");
var isFileList = kindOfTest("FileList");
var isStream = (val) => isObject(val) && isFunction(val.pipe);
var isFormData = (thing) => {
  let kind;
  return thing && (typeof FormData === "function" && thing instanceof FormData || isFunction(thing.append) && ((kind = kindOf(thing)) === "formdata" || // detect form-data instance
  kind === "object" && isFunction(thing.toString) && thing.toString() === "[object FormData]"));
};
var isURLSearchParams = kindOfTest("URLSearchParams");
var [isReadableStream, isRequest, isResponse, isHeaders] = ["ReadableStream", "Request", "Response", "Headers"].map(kindOfTest);
var trim = (str) => str.trim ? str.trim() : str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
function forEach(obj, fn2, { allOwnKeys = false } = {}) {
  if (obj === null || typeof obj === "undefined") {
    return;
  }
  let i2;
  let l2;
  if (typeof obj !== "object") {
    obj = [obj];
  }
  if (isArray(obj)) {
    for (i2 = 0, l2 = obj.length; i2 < l2; i2++) {
      fn2.call(null, obj[i2], i2, obj);
    }
  } else {
    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);
    const len = keys.length;
    let key;
    for (i2 = 0; i2 < len; i2++) {
      key = keys[i2];
      fn2.call(null, obj[key], key, obj);
    }
  }
}
function findKey(obj, key) {
  key = key.toLowerCase();
  const keys = Object.keys(obj);
  let i2 = keys.length;
  let _key;
  while (i2-- > 0) {
    _key = keys[i2];
    if (key === _key.toLowerCase()) {
      return _key;
    }
  }
  return null;
}
var _global = (() => {
  if (typeof globalThis !== "undefined") return globalThis;
  return typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : global;
})();
var isContextDefined = (context) => !isUndefined(context) && context !== _global;
function merge() {
  const { caseless } = isContextDefined(this) && this || {};
  const result = {};
  const assignValue = (val, key) => {
    const targetKey = caseless && findKey(result, key) || key;
    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {
      result[targetKey] = merge(result[targetKey], val);
    } else if (isPlainObject(val)) {
      result[targetKey] = merge({}, val);
    } else if (isArray(val)) {
      result[targetKey] = val.slice();
    } else {
      result[targetKey] = val;
    }
  };
  for (let i2 = 0, l2 = arguments.length; i2 < l2; i2++) {
    arguments[i2] && forEach(arguments[i2], assignValue);
  }
  return result;
}
var extend = (a2, b2, thisArg, { allOwnKeys } = {}) => {
  forEach(b2, (val, key) => {
    if (thisArg && isFunction(val)) {
      a2[key] = bind(val, thisArg);
    } else {
      a2[key] = val;
    }
  }, { allOwnKeys });
  return a2;
};
var stripBOM = (content) => {
  if (content.charCodeAt(0) === 65279) {
    content = content.slice(1);
  }
  return content;
};
var inherits = (constructor, superConstructor, props, descriptors2) => {
  constructor.prototype = Object.create(superConstructor.prototype, descriptors2);
  constructor.prototype.constructor = constructor;
  Object.defineProperty(constructor, "super", {
    value: superConstructor.prototype
  });
  props && Object.assign(constructor.prototype, props);
};
var toFlatObject = (sourceObj, destObj, filter2, propFilter) => {
  let props;
  let i2;
  let prop;
  const merged = {};
  destObj = destObj || {};
  if (sourceObj == null) return destObj;
  do {
    props = Object.getOwnPropertyNames(sourceObj);
    i2 = props.length;
    while (i2-- > 0) {
      prop = props[i2];
      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {
        destObj[prop] = sourceObj[prop];
        merged[prop] = true;
      }
    }
    sourceObj = filter2 !== false && getPrototypeOf(sourceObj);
  } while (sourceObj && (!filter2 || filter2(sourceObj, destObj)) && sourceObj !== Object.prototype);
  return destObj;
};
var endsWith = (str, searchString, position) => {
  str = String(str);
  if (position === void 0 || position > str.length) {
    position = str.length;
  }
  position -= searchString.length;
  const lastIndex = str.indexOf(searchString, position);
  return lastIndex !== -1 && lastIndex === position;
};
var toArray = (thing) => {
  if (!thing) return null;
  if (isArray(thing)) return thing;
  let i2 = thing.length;
  if (!isNumber(i2)) return null;
  const arr = new Array(i2);
  while (i2-- > 0) {
    arr[i2] = thing[i2];
  }
  return arr;
};
var isTypedArray = /* @__PURE__ */ ((TypedArray) => {
  return (thing) => {
    return TypedArray && thing instanceof TypedArray;
  };
})(typeof Uint8Array !== "undefined" && getPrototypeOf(Uint8Array));
var forEachEntry = (obj, fn2) => {
  const generator = obj && obj[iterator];
  const _iterator = generator.call(obj);
  let result;
  while ((result = _iterator.next()) && !result.done) {
    const pair = result.value;
    fn2.call(obj, pair[0], pair[1]);
  }
};
var matchAll = (regExp, str) => {
  let matches;
  const arr = [];
  while ((matches = regExp.exec(str)) !== null) {
    arr.push(matches);
  }
  return arr;
};
var isHTMLForm = kindOfTest("HTMLFormElement");
var toCamelCase = (str) => {
  return str.toLowerCase().replace(
    /[-_\s]([a-z\d])(\w*)/g,
    function replacer(m2, p1, p2) {
      return p1.toUpperCase() + p2;
    }
  );
};
var hasOwnProperty = (({ hasOwnProperty: hasOwnProperty2 }) => (obj, prop) => hasOwnProperty2.call(obj, prop))(Object.prototype);
var isRegExp = kindOfTest("RegExp");
var reduceDescriptors = (obj, reducer) => {
  const descriptors2 = Object.getOwnPropertyDescriptors(obj);
  const reducedDescriptors = {};
  forEach(descriptors2, (descriptor, name2) => {
    let ret;
    if ((ret = reducer(descriptor, name2, obj)) !== false) {
      reducedDescriptors[name2] = ret || descriptor;
    }
  });
  Object.defineProperties(obj, reducedDescriptors);
};
var freezeMethods = (obj) => {
  reduceDescriptors(obj, (descriptor, name2) => {
    if (isFunction(obj) && ["arguments", "caller", "callee"].indexOf(name2) !== -1) {
      return false;
    }
    const value = obj[name2];
    if (!isFunction(value)) return;
    descriptor.enumerable = false;
    if ("writable" in descriptor) {
      descriptor.writable = false;
      return;
    }
    if (!descriptor.set) {
      descriptor.set = () => {
        throw Error("Can not rewrite read-only method '" + name2 + "'");
      };
    }
  });
};
var toObjectSet = (arrayOrString, delimiter) => {
  const obj = {};
  const define = (arr) => {
    arr.forEach((value) => {
      obj[value] = true;
    });
  };
  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));
  return obj;
};
var noop = () => {
};
var toFiniteNumber = (value, defaultValue) => {
  return value != null && Number.isFinite(value = +value) ? value : defaultValue;
};
function isSpecCompliantForm(thing) {
  return !!(thing && isFunction(thing.append) && thing[toStringTag] === "FormData" && thing[iterator]);
}
var toJSONObject = (obj) => {
  const stack = new Array(10);
  const visit = (source, i2) => {
    if (isObject(source)) {
      if (stack.indexOf(source) >= 0) {
        return;
      }
      if (!("toJSON" in source)) {
        stack[i2] = source;
        const target = isArray(source) ? [] : {};
        forEach(source, (value, key) => {
          const reducedValue = visit(value, i2 + 1);
          !isUndefined(reducedValue) && (target[key] = reducedValue);
        });
        stack[i2] = void 0;
        return target;
      }
    }
    return source;
  };
  return visit(obj, 0);
};
var isAsyncFn = kindOfTest("AsyncFunction");
var isThenable = (thing) => thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);
var _setImmediate = ((setImmediateSupported, postMessageSupported) => {
  if (setImmediateSupported) {
    return setImmediate;
  }
  return postMessageSupported ? ((token, callbacks) => {
    _global.addEventListener("message", ({ source, data }) => {
      if (source === _global && data === token) {
        callbacks.length && callbacks.shift()();
      }
    }, false);
    return (cb) => {
      callbacks.push(cb);
      _global.postMessage(token, "*");
    };
  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);
})(
  typeof setImmediate === "function",
  isFunction(_global.postMessage)
);
var asap = typeof queueMicrotask !== "undefined" ? queueMicrotask.bind(_global) : typeof process !== "undefined" && process.nextTick || _setImmediate;
var isIterable = (thing) => thing != null && isFunction(thing[iterator]);
var utils_default = {
  isArray,
  isArrayBuffer,
  isBuffer,
  isFormData,
  isArrayBufferView,
  isString,
  isNumber,
  isBoolean,
  isObject,
  isPlainObject,
  isReadableStream,
  isRequest,
  isResponse,
  isHeaders,
  isUndefined,
  isDate,
  isFile,
  isBlob,
  isRegExp,
  isFunction,
  isStream,
  isURLSearchParams,
  isTypedArray,
  isFileList,
  forEach,
  merge,
  extend,
  trim,
  stripBOM,
  inherits,
  toFlatObject,
  kindOf,
  kindOfTest,
  endsWith,
  toArray,
  forEachEntry,
  matchAll,
  isHTMLForm,
  hasOwnProperty,
  hasOwnProp: hasOwnProperty,
  // an alias to avoid ESLint no-prototype-builtins detection
  reduceDescriptors,
  freezeMethods,
  toObjectSet,
  toCamelCase,
  noop,
  toFiniteNumber,
  findKey,
  global: _global,
  isContextDefined,
  isSpecCompliantForm,
  toJSONObject,
  isAsyncFn,
  isThenable,
  setImmediate: _setImmediate,
  asap,
  isIterable
};

// node_modules/axios/lib/core/AxiosError.js
function AxiosError(message, code, config, request, response) {
  Error.call(this);
  if (Error.captureStackTrace) {
    Error.captureStackTrace(this, this.constructor);
  } else {
    this.stack = new Error().stack;
  }
  this.message = message;
  this.name = "AxiosError";
  code && (this.code = code);
  config && (this.config = config);
  request && (this.request = request);
  if (response) {
    this.response = response;
    this.status = response.status ? response.status : null;
  }
}
utils_default.inherits(AxiosError, Error, {
  toJSON: function toJSON() {
    return {
      // Standard
      message: this.message,
      name: this.name,
      // Microsoft
      description: this.description,
      number: this.number,
      // Mozilla
      fileName: this.fileName,
      lineNumber: this.lineNumber,
      columnNumber: this.columnNumber,
      stack: this.stack,
      // Axios
      config: utils_default.toJSONObject(this.config),
      code: this.code,
      status: this.status
    };
  }
});
var prototype = AxiosError.prototype;
var descriptors = {};
[
  "ERR_BAD_OPTION_VALUE",
  "ERR_BAD_OPTION",
  "ECONNABORTED",
  "ETIMEDOUT",
  "ERR_NETWORK",
  "ERR_FR_TOO_MANY_REDIRECTS",
  "ERR_DEPRECATED",
  "ERR_BAD_RESPONSE",
  "ERR_BAD_REQUEST",
  "ERR_CANCELED",
  "ERR_NOT_SUPPORT",
  "ERR_INVALID_URL"
  // eslint-disable-next-line func-names
].forEach((code) => {
  descriptors[code] = { value: code };
});
Object.defineProperties(AxiosError, descriptors);
Object.defineProperty(prototype, "isAxiosError", { value: true });
AxiosError.from = (error, code, config, request, response, customProps) => {
  const axiosError = Object.create(prototype);
  utils_default.toFlatObject(error, axiosError, function filter2(obj) {
    return obj !== Error.prototype;
  }, (prop) => {
    return prop !== "isAxiosError";
  });
  AxiosError.call(axiosError, error.message, code, config, request, response);
  axiosError.cause = error;
  axiosError.name = error.name;
  customProps && Object.assign(axiosError, customProps);
  return axiosError;
};
var AxiosError_default = AxiosError;

// node_modules/axios/lib/helpers/null.js
var null_default = null;

// node_modules/axios/lib/helpers/toFormData.js
function isVisitable(thing) {
  return utils_default.isPlainObject(thing) || utils_default.isArray(thing);
}
function removeBrackets(key) {
  return utils_default.endsWith(key, "[]") ? key.slice(0, -2) : key;
}
function renderKey(path, key, dots) {
  if (!path) return key;
  return path.concat(key).map(function each(token, i2) {
    token = removeBrackets(token);
    return !dots && i2 ? "[" + token + "]" : token;
  }).join(dots ? "." : "");
}
function isFlatArray(arr) {
  return utils_default.isArray(arr) && !arr.some(isVisitable);
}
var predicates = utils_default.toFlatObject(utils_default, {}, null, function filter(prop) {
  return /^is[A-Z]/.test(prop);
});
function toFormData(obj, formData, options) {
  if (!utils_default.isObject(obj)) {
    throw new TypeError("target must be an object");
  }
  formData = formData || new (null_default || FormData)();
  options = utils_default.toFlatObject(options, {
    metaTokens: true,
    dots: false,
    indexes: false
  }, false, function defined(option, source) {
    return !utils_default.isUndefined(source[option]);
  });
  const metaTokens = options.metaTokens;
  const visitor = options.visitor || defaultVisitor;
  const dots = options.dots;
  const indexes = options.indexes;
  const _Blob = options.Blob || typeof Blob !== "undefined" && Blob;
  const useBlob = _Blob && utils_default.isSpecCompliantForm(formData);
  if (!utils_default.isFunction(visitor)) {
    throw new TypeError("visitor must be a function");
  }
  function convertValue(value) {
    if (value === null) return "";
    if (utils_default.isDate(value)) {
      return value.toISOString();
    }
    if (utils_default.isBoolean(value)) {
      return value.toString();
    }
    if (!useBlob && utils_default.isBlob(value)) {
      throw new AxiosError_default("Blob is not supported. Use a Buffer instead.");
    }
    if (utils_default.isArrayBuffer(value) || utils_default.isTypedArray(value)) {
      return useBlob && typeof Blob === "function" ? new Blob([value]) : Buffer.from(value);
    }
    return value;
  }
  function defaultVisitor(value, key, path) {
    let arr = value;
    if (value && !path && typeof value === "object") {
      if (utils_default.endsWith(key, "{}")) {
        key = metaTokens ? key : key.slice(0, -2);
        value = JSON.stringify(value);
      } else if (utils_default.isArray(value) && isFlatArray(value) || (utils_default.isFileList(value) || utils_default.endsWith(key, "[]")) && (arr = utils_default.toArray(value))) {
        key = removeBrackets(key);
        arr.forEach(function each(el, index) {
          !(utils_default.isUndefined(el) || el === null) && formData.append(
            // eslint-disable-next-line no-nested-ternary
            indexes === true ? renderKey([key], index, dots) : indexes === null ? key : key + "[]",
            convertValue(el)
          );
        });
        return false;
      }
    }
    if (isVisitable(value)) {
      return true;
    }
    formData.append(renderKey(path, key, dots), convertValue(value));
    return false;
  }
  const stack = [];
  const exposedHelpers = Object.assign(predicates, {
    defaultVisitor,
    convertValue,
    isVisitable
  });
  function build(value, path) {
    if (utils_default.isUndefined(value)) return;
    if (stack.indexOf(value) !== -1) {
      throw Error("Circular reference detected in " + path.join("."));
    }
    stack.push(value);
    utils_default.forEach(value, function each(el, key) {
      const result = !(utils_default.isUndefined(el) || el === null) && visitor.call(
        formData,
        el,
        utils_default.isString(key) ? key.trim() : key,
        path,
        exposedHelpers
      );
      if (result === true) {
        build(el, path ? path.concat(key) : [key]);
      }
    });
    stack.pop();
  }
  if (!utils_default.isObject(obj)) {
    throw new TypeError("data must be an object");
  }
  build(obj);
  return formData;
}
var toFormData_default = toFormData;

// node_modules/axios/lib/helpers/AxiosURLSearchParams.js
function encode(str) {
  const charMap = {
    "!": "%21",
    "'": "%27",
    "(": "%28",
    ")": "%29",
    "~": "%7E",
    "%20": "+",
    "%00": "\0"
  };
  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {
    return charMap[match];
  });
}
function AxiosURLSearchParams(params, options) {
  this._pairs = [];
  params && toFormData_default(params, this, options);
}
var prototype2 = AxiosURLSearchParams.prototype;
prototype2.append = function append(name2, value) {
  this._pairs.push([name2, value]);
};
prototype2.toString = function toString2(encoder) {
  const _encode = encoder ? function(value) {
    return encoder.call(this, value, encode);
  } : encode;
  return this._pairs.map(function each(pair) {
    return _encode(pair[0]) + "=" + _encode(pair[1]);
  }, "").join("&");
};
var AxiosURLSearchParams_default = AxiosURLSearchParams;

// node_modules/axios/lib/helpers/buildURL.js
function encode2(val) {
  return encodeURIComponent(val).replace(/%3A/gi, ":").replace(/%24/g, "$").replace(/%2C/gi, ",").replace(/%20/g, "+").replace(/%5B/gi, "[").replace(/%5D/gi, "]");
}
function buildURL(url, params, options) {
  if (!params) {
    return url;
  }
  const _encode = options && options.encode || encode2;
  if (utils_default.isFunction(options)) {
    options = {
      serialize: options
    };
  }
  const serializeFn = options && options.serialize;
  let serializedParams;
  if (serializeFn) {
    serializedParams = serializeFn(params, options);
  } else {
    serializedParams = utils_default.isURLSearchParams(params) ? params.toString() : new AxiosURLSearchParams_default(params, options).toString(_encode);
  }
  if (serializedParams) {
    const hashmarkIndex = url.indexOf("#");
    if (hashmarkIndex !== -1) {
      url = url.slice(0, hashmarkIndex);
    }
    url += (url.indexOf("?") === -1 ? "?" : "&") + serializedParams;
  }
  return url;
}

// node_modules/axios/lib/core/InterceptorManager.js
var InterceptorManager = class {
  constructor() {
    this.handlers = [];
  }
  /**
   * Add a new interceptor to the stack
   *
   * @param {Function} fulfilled The function to handle `then` for a `Promise`
   * @param {Function} rejected The function to handle `reject` for a `Promise`
   *
   * @return {Number} An ID used to remove interceptor later
   */
  use(fulfilled, rejected, options) {
    this.handlers.push({
      fulfilled,
      rejected,
      synchronous: options ? options.synchronous : false,
      runWhen: options ? options.runWhen : null
    });
    return this.handlers.length - 1;
  }
  /**
   * Remove an interceptor from the stack
   *
   * @param {Number} id The ID that was returned by `use`
   *
   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise
   */
  eject(id) {
    if (this.handlers[id]) {
      this.handlers[id] = null;
    }
  }
  /**
   * Clear all interceptors from the stack
   *
   * @returns {void}
   */
  clear() {
    if (this.handlers) {
      this.handlers = [];
    }
  }
  /**
   * Iterate over all the registered interceptors
   *
   * This method is particularly useful for skipping over any
   * interceptors that may have become `null` calling `eject`.
   *
   * @param {Function} fn The function to call for each interceptor
   *
   * @returns {void}
   */
  forEach(fn2) {
    utils_default.forEach(this.handlers, function forEachHandler(h2) {
      if (h2 !== null) {
        fn2(h2);
      }
    });
  }
};
var InterceptorManager_default = InterceptorManager;

// node_modules/axios/lib/defaults/transitional.js
var transitional_default = {
  silentJSONParsing: true,
  forcedJSONParsing: true,
  clarifyTimeoutError: false
};

// node_modules/axios/lib/platform/browser/classes/URLSearchParams.js
var URLSearchParams_default = typeof URLSearchParams !== "undefined" ? URLSearchParams : AxiosURLSearchParams_default;

// node_modules/axios/lib/platform/browser/classes/FormData.js
var FormData_default = typeof FormData !== "undefined" ? FormData : null;

// node_modules/axios/lib/platform/browser/classes/Blob.js
var Blob_default = typeof Blob !== "undefined" ? Blob : null;

// node_modules/axios/lib/platform/browser/index.js
var browser_default = {
  isBrowser: true,
  classes: {
    URLSearchParams: URLSearchParams_default,
    FormData: FormData_default,
    Blob: Blob_default
  },
  protocols: ["http", "https", "file", "blob", "url", "data"]
};

// node_modules/axios/lib/platform/common/utils.js
var utils_exports = {};
__export(utils_exports, {
  hasBrowserEnv: () => hasBrowserEnv,
  hasStandardBrowserEnv: () => hasStandardBrowserEnv,
  hasStandardBrowserWebWorkerEnv: () => hasStandardBrowserWebWorkerEnv,
  navigator: () => _navigator,
  origin: () => origin
});
var hasBrowserEnv = typeof window !== "undefined" && typeof document !== "undefined";
var _navigator = typeof navigator === "object" && navigator || void 0;
var hasStandardBrowserEnv = hasBrowserEnv && (!_navigator || ["ReactNative", "NativeScript", "NS"].indexOf(_navigator.product) < 0);
var hasStandardBrowserWebWorkerEnv = (() => {
  return typeof WorkerGlobalScope !== "undefined" && // eslint-disable-next-line no-undef
  self instanceof WorkerGlobalScope && typeof self.importScripts === "function";
})();
var origin = hasBrowserEnv && window.location.href || "http://localhost";

// node_modules/axios/lib/platform/index.js
var platform_default = {
  ...utils_exports,
  ...browser_default
};

// node_modules/axios/lib/helpers/toURLEncodedForm.js
function toURLEncodedForm(data, options) {
  return toFormData_default(data, new platform_default.classes.URLSearchParams(), Object.assign({
    visitor: function(value, key, path, helpers) {
      if (platform_default.isNode && utils_default.isBuffer(value)) {
        this.append(key, value.toString("base64"));
        return false;
      }
      return helpers.defaultVisitor.apply(this, arguments);
    }
  }, options));
}

// node_modules/axios/lib/helpers/formDataToJSON.js
function parsePropPath(name2) {
  return utils_default.matchAll(/\w+|\[(\w*)]/g, name2).map((match) => {
    return match[0] === "[]" ? "" : match[1] || match[0];
  });
}
function arrayToObject(arr) {
  const obj = {};
  const keys = Object.keys(arr);
  let i2;
  const len = keys.length;
  let key;
  for (i2 = 0; i2 < len; i2++) {
    key = keys[i2];
    obj[key] = arr[key];
  }
  return obj;
}
function formDataToJSON(formData) {
  function buildPath(path, value, target, index) {
    let name2 = path[index++];
    if (name2 === "__proto__") return true;
    const isNumericKey = Number.isFinite(+name2);
    const isLast = index >= path.length;
    name2 = !name2 && utils_default.isArray(target) ? target.length : name2;
    if (isLast) {
      if (utils_default.hasOwnProp(target, name2)) {
        target[name2] = [target[name2], value];
      } else {
        target[name2] = value;
      }
      return !isNumericKey;
    }
    if (!target[name2] || !utils_default.isObject(target[name2])) {
      target[name2] = [];
    }
    const result = buildPath(path, value, target[name2], index);
    if (result && utils_default.isArray(target[name2])) {
      target[name2] = arrayToObject(target[name2]);
    }
    return !isNumericKey;
  }
  if (utils_default.isFormData(formData) && utils_default.isFunction(formData.entries)) {
    const obj = {};
    utils_default.forEachEntry(formData, (name2, value) => {
      buildPath(parsePropPath(name2), value, obj, 0);
    });
    return obj;
  }
  return null;
}
var formDataToJSON_default = formDataToJSON;

// node_modules/axios/lib/defaults/index.js
function stringifySafely(rawValue, parser, encoder) {
  if (utils_default.isString(rawValue)) {
    try {
      (parser || JSON.parse)(rawValue);
      return utils_default.trim(rawValue);
    } catch (e2) {
      if (e2.name !== "SyntaxError") {
        throw e2;
      }
    }
  }
  return (encoder || JSON.stringify)(rawValue);
}
var defaults = {
  transitional: transitional_default,
  adapter: ["xhr", "http", "fetch"],
  transformRequest: [function transformRequest(data, headers) {
    const contentType = headers.getContentType() || "";
    const hasJSONContentType = contentType.indexOf("application/json") > -1;
    const isObjectPayload = utils_default.isObject(data);
    if (isObjectPayload && utils_default.isHTMLForm(data)) {
      data = new FormData(data);
    }
    const isFormData2 = utils_default.isFormData(data);
    if (isFormData2) {
      return hasJSONContentType ? JSON.stringify(formDataToJSON_default(data)) : data;
    }
    if (utils_default.isArrayBuffer(data) || utils_default.isBuffer(data) || utils_default.isStream(data) || utils_default.isFile(data) || utils_default.isBlob(data) || utils_default.isReadableStream(data)) {
      return data;
    }
    if (utils_default.isArrayBufferView(data)) {
      return data.buffer;
    }
    if (utils_default.isURLSearchParams(data)) {
      headers.setContentType("application/x-www-form-urlencoded;charset=utf-8", false);
      return data.toString();
    }
    let isFileList2;
    if (isObjectPayload) {
      if (contentType.indexOf("application/x-www-form-urlencoded") > -1) {
        return toURLEncodedForm(data, this.formSerializer).toString();
      }
      if ((isFileList2 = utils_default.isFileList(data)) || contentType.indexOf("multipart/form-data") > -1) {
        const _FormData = this.env && this.env.FormData;
        return toFormData_default(
          isFileList2 ? { "files[]": data } : data,
          _FormData && new _FormData(),
          this.formSerializer
        );
      }
    }
    if (isObjectPayload || hasJSONContentType) {
      headers.setContentType("application/json", false);
      return stringifySafely(data);
    }
    return data;
  }],
  transformResponse: [function transformResponse(data) {
    const transitional2 = this.transitional || defaults.transitional;
    const forcedJSONParsing = transitional2 && transitional2.forcedJSONParsing;
    const JSONRequested = this.responseType === "json";
    if (utils_default.isResponse(data) || utils_default.isReadableStream(data)) {
      return data;
    }
    if (data && utils_default.isString(data) && (forcedJSONParsing && !this.responseType || JSONRequested)) {
      const silentJSONParsing = transitional2 && transitional2.silentJSONParsing;
      const strictJSONParsing = !silentJSONParsing && JSONRequested;
      try {
        return JSON.parse(data);
      } catch (e2) {
        if (strictJSONParsing) {
          if (e2.name === "SyntaxError") {
            throw AxiosError_default.from(e2, AxiosError_default.ERR_BAD_RESPONSE, this, null, this.response);
          }
          throw e2;
        }
      }
    }
    return data;
  }],
  /**
   * A timeout in milliseconds to abort a request. If set to 0 (default) a
   * timeout is not created.
   */
  timeout: 0,
  xsrfCookieName: "XSRF-TOKEN",
  xsrfHeaderName: "X-XSRF-TOKEN",
  maxContentLength: -1,
  maxBodyLength: -1,
  env: {
    FormData: platform_default.classes.FormData,
    Blob: platform_default.classes.Blob
  },
  validateStatus: function validateStatus(status) {
    return status >= 200 && status < 300;
  },
  headers: {
    common: {
      "Accept": "application/json, text/plain, */*",
      "Content-Type": void 0
    }
  }
};
utils_default.forEach(["delete", "get", "head", "post", "put", "patch"], (method) => {
  defaults.headers[method] = {};
});
var defaults_default = defaults;

// node_modules/axios/lib/helpers/parseHeaders.js
var ignoreDuplicateOf = utils_default.toObjectSet([
  "age",
  "authorization",
  "content-length",
  "content-type",
  "etag",
  "expires",
  "from",
  "host",
  "if-modified-since",
  "if-unmodified-since",
  "last-modified",
  "location",
  "max-forwards",
  "proxy-authorization",
  "referer",
  "retry-after",
  "user-agent"
]);
var parseHeaders_default = (rawHeaders) => {
  const parsed = {};
  let key;
  let val;
  let i2;
  rawHeaders && rawHeaders.split("\n").forEach(function parser(line) {
    i2 = line.indexOf(":");
    key = line.substring(0, i2).trim().toLowerCase();
    val = line.substring(i2 + 1).trim();
    if (!key || parsed[key] && ignoreDuplicateOf[key]) {
      return;
    }
    if (key === "set-cookie") {
      if (parsed[key]) {
        parsed[key].push(val);
      } else {
        parsed[key] = [val];
      }
    } else {
      parsed[key] = parsed[key] ? parsed[key] + ", " + val : val;
    }
  });
  return parsed;
};

// node_modules/axios/lib/core/AxiosHeaders.js
var $internals = Symbol("internals");
function normalizeHeader(header) {
  return header && String(header).trim().toLowerCase();
}
function normalizeValue(value) {
  if (value === false || value == null) {
    return value;
  }
  return utils_default.isArray(value) ? value.map(normalizeValue) : String(value);
}
function parseTokens(str) {
  const tokens = /* @__PURE__ */ Object.create(null);
  const tokensRE = /([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;
  let match;
  while (match = tokensRE.exec(str)) {
    tokens[match[1]] = match[2];
  }
  return tokens;
}
var isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());
function matchHeaderValue(context, value, header, filter2, isHeaderNameFilter) {
  if (utils_default.isFunction(filter2)) {
    return filter2.call(this, value, header);
  }
  if (isHeaderNameFilter) {
    value = header;
  }
  if (!utils_default.isString(value)) return;
  if (utils_default.isString(filter2)) {
    return value.indexOf(filter2) !== -1;
  }
  if (utils_default.isRegExp(filter2)) {
    return filter2.test(value);
  }
}
function formatHeader(header) {
  return header.trim().toLowerCase().replace(/([a-z\d])(\w*)/g, (w2, char, str) => {
    return char.toUpperCase() + str;
  });
}
function buildAccessors(obj, header) {
  const accessorName = utils_default.toCamelCase(" " + header);
  ["get", "set", "has"].forEach((methodName) => {
    Object.defineProperty(obj, methodName + accessorName, {
      value: function(arg1, arg2, arg3) {
        return this[methodName].call(this, header, arg1, arg2, arg3);
      },
      configurable: true
    });
  });
}
var AxiosHeaders = class {
  constructor(headers) {
    headers && this.set(headers);
  }
  set(header, valueOrRewrite, rewrite) {
    const self2 = this;
    function setHeader(_value, _header, _rewrite) {
      const lHeader = normalizeHeader(_header);
      if (!lHeader) {
        throw new Error("header name must be a non-empty string");
      }
      const key = utils_default.findKey(self2, lHeader);
      if (!key || self2[key] === void 0 || _rewrite === true || _rewrite === void 0 && self2[key] !== false) {
        self2[key || _header] = normalizeValue(_value);
      }
    }
    const setHeaders = (headers, _rewrite) => utils_default.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));
    if (utils_default.isPlainObject(header) || header instanceof this.constructor) {
      setHeaders(header, valueOrRewrite);
    } else if (utils_default.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {
      setHeaders(parseHeaders_default(header), valueOrRewrite);
    } else if (utils_default.isObject(header) && utils_default.isIterable(header)) {
      let obj = {}, dest, key;
      for (const entry of header) {
        if (!utils_default.isArray(entry)) {
          throw TypeError("Object iterator must return a key-value pair");
        }
        obj[key = entry[0]] = (dest = obj[key]) ? utils_default.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]] : entry[1];
      }
      setHeaders(obj, valueOrRewrite);
    } else {
      header != null && setHeader(valueOrRewrite, header, rewrite);
    }
    return this;
  }
  get(header, parser) {
    header = normalizeHeader(header);
    if (header) {
      const key = utils_default.findKey(this, header);
      if (key) {
        const value = this[key];
        if (!parser) {
          return value;
        }
        if (parser === true) {
          return parseTokens(value);
        }
        if (utils_default.isFunction(parser)) {
          return parser.call(this, value, key);
        }
        if (utils_default.isRegExp(parser)) {
          return parser.exec(value);
        }
        throw new TypeError("parser must be boolean|regexp|function");
      }
    }
  }
  has(header, matcher) {
    header = normalizeHeader(header);
    if (header) {
      const key = utils_default.findKey(this, header);
      return !!(key && this[key] !== void 0 && (!matcher || matchHeaderValue(this, this[key], key, matcher)));
    }
    return false;
  }
  delete(header, matcher) {
    const self2 = this;
    let deleted = false;
    function deleteHeader(_header) {
      _header = normalizeHeader(_header);
      if (_header) {
        const key = utils_default.findKey(self2, _header);
        if (key && (!matcher || matchHeaderValue(self2, self2[key], key, matcher))) {
          delete self2[key];
          deleted = true;
        }
      }
    }
    if (utils_default.isArray(header)) {
      header.forEach(deleteHeader);
    } else {
      deleteHeader(header);
    }
    return deleted;
  }
  clear(matcher) {
    const keys = Object.keys(this);
    let i2 = keys.length;
    let deleted = false;
    while (i2--) {
      const key = keys[i2];
      if (!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {
        delete this[key];
        deleted = true;
      }
    }
    return deleted;
  }
  normalize(format) {
    const self2 = this;
    const headers = {};
    utils_default.forEach(this, (value, header) => {
      const key = utils_default.findKey(headers, header);
      if (key) {
        self2[key] = normalizeValue(value);
        delete self2[header];
        return;
      }
      const normalized = format ? formatHeader(header) : String(header).trim();
      if (normalized !== header) {
        delete self2[header];
      }
      self2[normalized] = normalizeValue(value);
      headers[normalized] = true;
    });
    return this;
  }
  concat(...targets) {
    return this.constructor.concat(this, ...targets);
  }
  toJSON(asStrings) {
    const obj = /* @__PURE__ */ Object.create(null);
    utils_default.forEach(this, (value, header) => {
      value != null && value !== false && (obj[header] = asStrings && utils_default.isArray(value) ? value.join(", ") : value);
    });
    return obj;
  }
  [Symbol.iterator]() {
    return Object.entries(this.toJSON())[Symbol.iterator]();
  }
  toString() {
    return Object.entries(this.toJSON()).map(([header, value]) => header + ": " + value).join("\n");
  }
  getSetCookie() {
    return this.get("set-cookie") || [];
  }
  get [Symbol.toStringTag]() {
    return "AxiosHeaders";
  }
  static from(thing) {
    return thing instanceof this ? thing : new this(thing);
  }
  static concat(first, ...targets) {
    const computed = new this(first);
    targets.forEach((target) => computed.set(target));
    return computed;
  }
  static accessor(header) {
    const internals = this[$internals] = this[$internals] = {
      accessors: {}
    };
    const accessors = internals.accessors;
    const prototype3 = this.prototype;
    function defineAccessor(_header) {
      const lHeader = normalizeHeader(_header);
      if (!accessors[lHeader]) {
        buildAccessors(prototype3, _header);
        accessors[lHeader] = true;
      }
    }
    utils_default.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);
    return this;
  }
};
AxiosHeaders.accessor(["Content-Type", "Content-Length", "Accept", "Accept-Encoding", "User-Agent", "Authorization"]);
utils_default.reduceDescriptors(AxiosHeaders.prototype, ({ value }, key) => {
  let mapped = key[0].toUpperCase() + key.slice(1);
  return {
    get: () => value,
    set(headerValue) {
      this[mapped] = headerValue;
    }
  };
});
utils_default.freezeMethods(AxiosHeaders);
var AxiosHeaders_default = AxiosHeaders;

// node_modules/axios/lib/core/transformData.js
function transformData(fns, response) {
  const config = this || defaults_default;
  const context = response || config;
  const headers = AxiosHeaders_default.from(context.headers);
  let data = context.data;
  utils_default.forEach(fns, function transform(fn2) {
    data = fn2.call(config, data, headers.normalize(), response ? response.status : void 0);
  });
  headers.normalize();
  return data;
}

// node_modules/axios/lib/cancel/isCancel.js
function isCancel(value) {
  return !!(value && value.__CANCEL__);
}

// node_modules/axios/lib/cancel/CanceledError.js
function CanceledError(message, config, request) {
  AxiosError_default.call(this, message == null ? "canceled" : message, AxiosError_default.ERR_CANCELED, config, request);
  this.name = "CanceledError";
}
utils_default.inherits(CanceledError, AxiosError_default, {
  __CANCEL__: true
});
var CanceledError_default = CanceledError;

// node_modules/axios/lib/core/settle.js
function settle(resolve, reject, response) {
  const validateStatus2 = response.config.validateStatus;
  if (!response.status || !validateStatus2 || validateStatus2(response.status)) {
    resolve(response);
  } else {
    reject(new AxiosError_default(
      "Request failed with status code " + response.status,
      [AxiosError_default.ERR_BAD_REQUEST, AxiosError_default.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],
      response.config,
      response.request,
      response
    ));
  }
}

// node_modules/axios/lib/helpers/parseProtocol.js
function parseProtocol(url) {
  const match = /^([-+\w]{1,25})(:?\/\/|:)/.exec(url);
  return match && match[1] || "";
}

// node_modules/axios/lib/helpers/speedometer.js
function speedometer(samplesCount, min) {
  samplesCount = samplesCount || 10;
  const bytes = new Array(samplesCount);
  const timestamps = new Array(samplesCount);
  let head = 0;
  let tail = 0;
  let firstSampleTS;
  min = min !== void 0 ? min : 1e3;
  return function push(chunkLength) {
    const now = Date.now();
    const startedAt = timestamps[tail];
    if (!firstSampleTS) {
      firstSampleTS = now;
    }
    bytes[head] = chunkLength;
    timestamps[head] = now;
    let i2 = tail;
    let bytesCount = 0;
    while (i2 !== head) {
      bytesCount += bytes[i2++];
      i2 = i2 % samplesCount;
    }
    head = (head + 1) % samplesCount;
    if (head === tail) {
      tail = (tail + 1) % samplesCount;
    }
    if (now - firstSampleTS < min) {
      return;
    }
    const passed = startedAt && now - startedAt;
    return passed ? Math.round(bytesCount * 1e3 / passed) : void 0;
  };
}
var speedometer_default = speedometer;

// node_modules/axios/lib/helpers/throttle.js
function throttle(fn2, freq) {
  let timestamp = 0;
  let threshold = 1e3 / freq;
  let lastArgs;
  let timer;
  const invoke = (args, now = Date.now()) => {
    timestamp = now;
    lastArgs = null;
    if (timer) {
      clearTimeout(timer);
      timer = null;
    }
    fn2.apply(null, args);
  };
  const throttled = (...args) => {
    const now = Date.now();
    const passed = now - timestamp;
    if (passed >= threshold) {
      invoke(args, now);
    } else {
      lastArgs = args;
      if (!timer) {
        timer = setTimeout(() => {
          timer = null;
          invoke(lastArgs);
        }, threshold - passed);
      }
    }
  };
  const flush = () => lastArgs && invoke(lastArgs);
  return [throttled, flush];
}
var throttle_default = throttle;

// node_modules/axios/lib/helpers/progressEventReducer.js
var progressEventReducer = (listener, isDownloadStream, freq = 3) => {
  let bytesNotified = 0;
  const _speedometer = speedometer_default(50, 250);
  return throttle_default((e2) => {
    const loaded = e2.loaded;
    const total = e2.lengthComputable ? e2.total : void 0;
    const progressBytes = loaded - bytesNotified;
    const rate = _speedometer(progressBytes);
    const inRange = loaded <= total;
    bytesNotified = loaded;
    const data = {
      loaded,
      total,
      progress: total ? loaded / total : void 0,
      bytes: progressBytes,
      rate: rate ? rate : void 0,
      estimated: rate && total && inRange ? (total - loaded) / rate : void 0,
      event: e2,
      lengthComputable: total != null,
      [isDownloadStream ? "download" : "upload"]: true
    };
    listener(data);
  }, freq);
};
var progressEventDecorator = (total, throttled) => {
  const lengthComputable = total != null;
  return [(loaded) => throttled[0]({
    lengthComputable,
    total,
    loaded
  }), throttled[1]];
};
var asyncDecorator = (fn2) => (...args) => utils_default.asap(() => fn2(...args));

// node_modules/axios/lib/helpers/isURLSameOrigin.js
var isURLSameOrigin_default = platform_default.hasStandardBrowserEnv ? /* @__PURE__ */ ((origin2, isMSIE) => (url) => {
  url = new URL(url, platform_default.origin);
  return origin2.protocol === url.protocol && origin2.host === url.host && (isMSIE || origin2.port === url.port);
})(
  new URL(platform_default.origin),
  platform_default.navigator && /(msie|trident)/i.test(platform_default.navigator.userAgent)
) : () => true;

// node_modules/axios/lib/helpers/cookies.js
var cookies_default = platform_default.hasStandardBrowserEnv ? (
  // Standard browser envs support document.cookie
  {
    write(name2, value, expires, path, domain, secure) {
      const cookie = [name2 + "=" + encodeURIComponent(value)];
      utils_default.isNumber(expires) && cookie.push("expires=" + new Date(expires).toGMTString());
      utils_default.isString(path) && cookie.push("path=" + path);
      utils_default.isString(domain) && cookie.push("domain=" + domain);
      secure === true && cookie.push("secure");
      document.cookie = cookie.join("; ");
    },
    read(name2) {
      const match = document.cookie.match(new RegExp("(^|;\\s*)(" + name2 + ")=([^;]*)"));
      return match ? decodeURIComponent(match[3]) : null;
    },
    remove(name2) {
      this.write(name2, "", Date.now() - 864e5);
    }
  }
) : (
  // Non-standard browser env (web workers, react-native) lack needed support.
  {
    write() {
    },
    read() {
      return null;
    },
    remove() {
    }
  }
);

// node_modules/axios/lib/helpers/isAbsoluteURL.js
function isAbsoluteURL(url) {
  return /^([a-z][a-z\d+\-.]*:)?\/\//i.test(url);
}

// node_modules/axios/lib/helpers/combineURLs.js
function combineURLs(baseURL, relativeURL) {
  return relativeURL ? baseURL.replace(/\/?\/$/, "") + "/" + relativeURL.replace(/^\/+/, "") : baseURL;
}

// node_modules/axios/lib/core/buildFullPath.js
function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {
  let isRelativeUrl = !isAbsoluteURL(requestedURL);
  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {
    return combineURLs(baseURL, requestedURL);
  }
  return requestedURL;
}

// node_modules/axios/lib/core/mergeConfig.js
var headersToObject = (thing) => thing instanceof AxiosHeaders_default ? { ...thing } : thing;
function mergeConfig(config1, config2) {
  config2 = config2 || {};
  const config = {};
  function getMergedValue(target, source, prop, caseless) {
    if (utils_default.isPlainObject(target) && utils_default.isPlainObject(source)) {
      return utils_default.merge.call({ caseless }, target, source);
    } else if (utils_default.isPlainObject(source)) {
      return utils_default.merge({}, source);
    } else if (utils_default.isArray(source)) {
      return source.slice();
    }
    return source;
  }
  function mergeDeepProperties(a2, b2, prop, caseless) {
    if (!utils_default.isUndefined(b2)) {
      return getMergedValue(a2, b2, prop, caseless);
    } else if (!utils_default.isUndefined(a2)) {
      return getMergedValue(void 0, a2, prop, caseless);
    }
  }
  function valueFromConfig2(a2, b2) {
    if (!utils_default.isUndefined(b2)) {
      return getMergedValue(void 0, b2);
    }
  }
  function defaultToConfig2(a2, b2) {
    if (!utils_default.isUndefined(b2)) {
      return getMergedValue(void 0, b2);
    } else if (!utils_default.isUndefined(a2)) {
      return getMergedValue(void 0, a2);
    }
  }
  function mergeDirectKeys(a2, b2, prop) {
    if (prop in config2) {
      return getMergedValue(a2, b2);
    } else if (prop in config1) {
      return getMergedValue(void 0, a2);
    }
  }
  const mergeMap = {
    url: valueFromConfig2,
    method: valueFromConfig2,
    data: valueFromConfig2,
    baseURL: defaultToConfig2,
    transformRequest: defaultToConfig2,
    transformResponse: defaultToConfig2,
    paramsSerializer: defaultToConfig2,
    timeout: defaultToConfig2,
    timeoutMessage: defaultToConfig2,
    withCredentials: defaultToConfig2,
    withXSRFToken: defaultToConfig2,
    adapter: defaultToConfig2,
    responseType: defaultToConfig2,
    xsrfCookieName: defaultToConfig2,
    xsrfHeaderName: defaultToConfig2,
    onUploadProgress: defaultToConfig2,
    onDownloadProgress: defaultToConfig2,
    decompress: defaultToConfig2,
    maxContentLength: defaultToConfig2,
    maxBodyLength: defaultToConfig2,
    beforeRedirect: defaultToConfig2,
    transport: defaultToConfig2,
    httpAgent: defaultToConfig2,
    httpsAgent: defaultToConfig2,
    cancelToken: defaultToConfig2,
    socketPath: defaultToConfig2,
    responseEncoding: defaultToConfig2,
    validateStatus: mergeDirectKeys,
    headers: (a2, b2, prop) => mergeDeepProperties(headersToObject(a2), headersToObject(b2), prop, true)
  };
  utils_default.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {
    const merge2 = mergeMap[prop] || mergeDeepProperties;
    const configValue = merge2(config1[prop], config2[prop], prop);
    utils_default.isUndefined(configValue) && merge2 !== mergeDirectKeys || (config[prop] = configValue);
  });
  return config;
}

// node_modules/axios/lib/helpers/resolveConfig.js
var resolveConfig_default = (config) => {
  const newConfig = mergeConfig({}, config);
  let { data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth } = newConfig;
  newConfig.headers = headers = AxiosHeaders_default.from(headers);
  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);
  if (auth) {
    headers.set(
      "Authorization",
      "Basic " + btoa((auth.username || "") + ":" + (auth.password ? unescape(encodeURIComponent(auth.password)) : ""))
    );
  }
  let contentType;
  if (utils_default.isFormData(data)) {
    if (platform_default.hasStandardBrowserEnv || platform_default.hasStandardBrowserWebWorkerEnv) {
      headers.setContentType(void 0);
    } else if ((contentType = headers.getContentType()) !== false) {
      const [type, ...tokens] = contentType ? contentType.split(";").map((token) => token.trim()).filter(Boolean) : [];
      headers.setContentType([type || "multipart/form-data", ...tokens].join("; "));
    }
  }
  if (platform_default.hasStandardBrowserEnv) {
    withXSRFToken && utils_default.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));
    if (withXSRFToken || withXSRFToken !== false && isURLSameOrigin_default(newConfig.url)) {
      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies_default.read(xsrfCookieName);
      if (xsrfValue) {
        headers.set(xsrfHeaderName, xsrfValue);
      }
    }
  }
  return newConfig;
};

// node_modules/axios/lib/adapters/xhr.js
var isXHRAdapterSupported = typeof XMLHttpRequest !== "undefined";
var xhr_default = isXHRAdapterSupported && function(config) {
  return new Promise(function dispatchXhrRequest(resolve, reject) {
    const _config = resolveConfig_default(config);
    let requestData = _config.data;
    const requestHeaders = AxiosHeaders_default.from(_config.headers).normalize();
    let { responseType, onUploadProgress, onDownloadProgress } = _config;
    let onCanceled;
    let uploadThrottled, downloadThrottled;
    let flushUpload, flushDownload;
    function done() {
      flushUpload && flushUpload();
      flushDownload && flushDownload();
      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);
      _config.signal && _config.signal.removeEventListener("abort", onCanceled);
    }
    let request = new XMLHttpRequest();
    request.open(_config.method.toUpperCase(), _config.url, true);
    request.timeout = _config.timeout;
    function onloadend() {
      if (!request) {
        return;
      }
      const responseHeaders = AxiosHeaders_default.from(
        "getAllResponseHeaders" in request && request.getAllResponseHeaders()
      );
      const responseData = !responseType || responseType === "text" || responseType === "json" ? request.responseText : request.response;
      const response = {
        data: responseData,
        status: request.status,
        statusText: request.statusText,
        headers: responseHeaders,
        config,
        request
      };
      settle(function _resolve(value) {
        resolve(value);
        done();
      }, function _reject(err) {
        reject(err);
        done();
      }, response);
      request = null;
    }
    if ("onloadend" in request) {
      request.onloadend = onloadend;
    } else {
      request.onreadystatechange = function handleLoad() {
        if (!request || request.readyState !== 4) {
          return;
        }
        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf("file:") === 0)) {
          return;
        }
        setTimeout(onloadend);
      };
    }
    request.onabort = function handleAbort() {
      if (!request) {
        return;
      }
      reject(new AxiosError_default("Request aborted", AxiosError_default.ECONNABORTED, config, request));
      request = null;
    };
    request.onerror = function handleError() {
      reject(new AxiosError_default("Network Error", AxiosError_default.ERR_NETWORK, config, request));
      request = null;
    };
    request.ontimeout = function handleTimeout() {
      let timeoutErrorMessage = _config.timeout ? "timeout of " + _config.timeout + "ms exceeded" : "timeout exceeded";
      const transitional2 = _config.transitional || transitional_default;
      if (_config.timeoutErrorMessage) {
        timeoutErrorMessage = _config.timeoutErrorMessage;
      }
      reject(new AxiosError_default(
        timeoutErrorMessage,
        transitional2.clarifyTimeoutError ? AxiosError_default.ETIMEDOUT : AxiosError_default.ECONNABORTED,
        config,
        request
      ));
      request = null;
    };
    requestData === void 0 && requestHeaders.setContentType(null);
    if ("setRequestHeader" in request) {
      utils_default.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {
        request.setRequestHeader(key, val);
      });
    }
    if (!utils_default.isUndefined(_config.withCredentials)) {
      request.withCredentials = !!_config.withCredentials;
    }
    if (responseType && responseType !== "json") {
      request.responseType = _config.responseType;
    }
    if (onDownloadProgress) {
      [downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true);
      request.addEventListener("progress", downloadThrottled);
    }
    if (onUploadProgress && request.upload) {
      [uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress);
      request.upload.addEventListener("progress", uploadThrottled);
      request.upload.addEventListener("loadend", flushUpload);
    }
    if (_config.cancelToken || _config.signal) {
      onCanceled = (cancel) => {
        if (!request) {
          return;
        }
        reject(!cancel || cancel.type ? new CanceledError_default(null, config, request) : cancel);
        request.abort();
        request = null;
      };
      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);
      if (_config.signal) {
        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener("abort", onCanceled);
      }
    }
    const protocol = parseProtocol(_config.url);
    if (protocol && platform_default.protocols.indexOf(protocol) === -1) {
      reject(new AxiosError_default("Unsupported protocol " + protocol + ":", AxiosError_default.ERR_BAD_REQUEST, config));
      return;
    }
    request.send(requestData || null);
  });
};

// node_modules/axios/lib/helpers/composeSignals.js
var composeSignals = (signals, timeout) => {
  const { length } = signals = signals ? signals.filter(Boolean) : [];
  if (timeout || length) {
    let controller = new AbortController();
    let aborted;
    const onabort = function(reason) {
      if (!aborted) {
        aborted = true;
        unsubscribe();
        const err = reason instanceof Error ? reason : this.reason;
        controller.abort(err instanceof AxiosError_default ? err : new CanceledError_default(err instanceof Error ? err.message : err));
      }
    };
    let timer = timeout && setTimeout(() => {
      timer = null;
      onabort(new AxiosError_default(`timeout ${timeout} of ms exceeded`, AxiosError_default.ETIMEDOUT));
    }, timeout);
    const unsubscribe = () => {
      if (signals) {
        timer && clearTimeout(timer);
        timer = null;
        signals.forEach((signal2) => {
          signal2.unsubscribe ? signal2.unsubscribe(onabort) : signal2.removeEventListener("abort", onabort);
        });
        signals = null;
      }
    };
    signals.forEach((signal2) => signal2.addEventListener("abort", onabort));
    const { signal } = controller;
    signal.unsubscribe = () => utils_default.asap(unsubscribe);
    return signal;
  }
};
var composeSignals_default = composeSignals;

// node_modules/axios/lib/helpers/trackStream.js
var streamChunk = function* (chunk, chunkSize) {
  let len = chunk.byteLength;
  if (!chunkSize || len < chunkSize) {
    yield chunk;
    return;
  }
  let pos = 0;
  let end;
  while (pos < len) {
    end = pos + chunkSize;
    yield chunk.slice(pos, end);
    pos = end;
  }
};
var readBytes = async function* (iterable, chunkSize) {
  for await (const chunk of readStream(iterable)) {
    yield* streamChunk(chunk, chunkSize);
  }
};
var readStream = async function* (stream) {
  if (stream[Symbol.asyncIterator]) {
    yield* stream;
    return;
  }
  const reader = stream.getReader();
  try {
    for (; ; ) {
      const { done, value } = await reader.read();
      if (done) {
        break;
      }
      yield value;
    }
  } finally {
    await reader.cancel();
  }
};
var trackStream = (stream, chunkSize, onProgress, onFinish) => {
  const iterator2 = readBytes(stream, chunkSize);
  let bytes = 0;
  let done;
  let _onFinish = (e2) => {
    if (!done) {
      done = true;
      onFinish && onFinish(e2);
    }
  };
  return new ReadableStream({
    async pull(controller) {
      try {
        const { done: done2, value } = await iterator2.next();
        if (done2) {
          _onFinish();
          controller.close();
          return;
        }
        let len = value.byteLength;
        if (onProgress) {
          let loadedBytes = bytes += len;
          onProgress(loadedBytes);
        }
        controller.enqueue(new Uint8Array(value));
      } catch (err) {
        _onFinish(err);
        throw err;
      }
    },
    cancel(reason) {
      _onFinish(reason);
      return iterator2.return();
    }
  }, {
    highWaterMark: 2
  });
};

// node_modules/axios/lib/adapters/fetch.js
var isFetchSupported = typeof fetch === "function" && typeof Request === "function" && typeof Response === "function";
var isReadableStreamSupported = isFetchSupported && typeof ReadableStream === "function";
var encodeText = isFetchSupported && (typeof TextEncoder === "function" ? /* @__PURE__ */ ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) : async (str) => new Uint8Array(await new Response(str).arrayBuffer()));
var test = (fn2, ...args) => {
  try {
    return !!fn2(...args);
  } catch (e2) {
    return false;
  }
};
var supportsRequestStream = isReadableStreamSupported && test(() => {
  let duplexAccessed = false;
  const hasContentType = new Request(platform_default.origin, {
    body: new ReadableStream(),
    method: "POST",
    get duplex() {
      duplexAccessed = true;
      return "half";
    }
  }).headers.has("Content-Type");
  return duplexAccessed && !hasContentType;
});
var DEFAULT_CHUNK_SIZE = 64 * 1024;
var supportsResponseStream = isReadableStreamSupported && test(() => utils_default.isReadableStream(new Response("").body));
var resolvers = {
  stream: supportsResponseStream && ((res) => res.body)
};
isFetchSupported && ((res) => {
  ["text", "arrayBuffer", "blob", "formData", "stream"].forEach((type) => {
    !resolvers[type] && (resolvers[type] = utils_default.isFunction(res[type]) ? (res2) => res2[type]() : (_2, config) => {
      throw new AxiosError_default(`Response type '${type}' is not supported`, AxiosError_default.ERR_NOT_SUPPORT, config);
    });
  });
})(new Response());
var getBodyLength = async (body) => {
  if (body == null) {
    return 0;
  }
  if (utils_default.isBlob(body)) {
    return body.size;
  }
  if (utils_default.isSpecCompliantForm(body)) {
    const _request = new Request(platform_default.origin, {
      method: "POST",
      body
    });
    return (await _request.arrayBuffer()).byteLength;
  }
  if (utils_default.isArrayBufferView(body) || utils_default.isArrayBuffer(body)) {
    return body.byteLength;
  }
  if (utils_default.isURLSearchParams(body)) {
    body = body + "";
  }
  if (utils_default.isString(body)) {
    return (await encodeText(body)).byteLength;
  }
};
var resolveBodyLength = async (headers, body) => {
  const length = utils_default.toFiniteNumber(headers.getContentLength());
  return length == null ? getBodyLength(body) : length;
};
var fetch_default = isFetchSupported && (async (config) => {
  let {
    url,
    method,
    data,
    signal,
    cancelToken,
    timeout,
    onDownloadProgress,
    onUploadProgress,
    responseType,
    headers,
    withCredentials = "same-origin",
    fetchOptions
  } = resolveConfig_default(config);
  responseType = responseType ? (responseType + "").toLowerCase() : "text";
  let composedSignal = composeSignals_default([signal, cancelToken && cancelToken.toAbortSignal()], timeout);
  let request;
  const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {
    composedSignal.unsubscribe();
  });
  let requestContentLength;
  try {
    if (onUploadProgress && supportsRequestStream && method !== "get" && method !== "head" && (requestContentLength = await resolveBodyLength(headers, data)) !== 0) {
      let _request = new Request(url, {
        method: "POST",
        body: data,
        duplex: "half"
      });
      let contentTypeHeader;
      if (utils_default.isFormData(data) && (contentTypeHeader = _request.headers.get("content-type"))) {
        headers.setContentType(contentTypeHeader);
      }
      if (_request.body) {
        const [onProgress, flush] = progressEventDecorator(
          requestContentLength,
          progressEventReducer(asyncDecorator(onUploadProgress))
        );
        data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);
      }
    }
    if (!utils_default.isString(withCredentials)) {
      withCredentials = withCredentials ? "include" : "omit";
    }
    const isCredentialsSupported = "credentials" in Request.prototype;
    request = new Request(url, {
      ...fetchOptions,
      signal: composedSignal,
      method: method.toUpperCase(),
      headers: headers.normalize().toJSON(),
      body: data,
      duplex: "half",
      credentials: isCredentialsSupported ? withCredentials : void 0
    });
    let response = await fetch(request, fetchOptions);
    const isStreamResponse = supportsResponseStream && (responseType === "stream" || responseType === "response");
    if (supportsResponseStream && (onDownloadProgress || isStreamResponse && unsubscribe)) {
      const options = {};
      ["status", "statusText", "headers"].forEach((prop) => {
        options[prop] = response[prop];
      });
      const responseContentLength = utils_default.toFiniteNumber(response.headers.get("content-length"));
      const [onProgress, flush] = onDownloadProgress && progressEventDecorator(
        responseContentLength,
        progressEventReducer(asyncDecorator(onDownloadProgress), true)
      ) || [];
      response = new Response(
        trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {
          flush && flush();
          unsubscribe && unsubscribe();
        }),
        options
      );
    }
    responseType = responseType || "text";
    let responseData = await resolvers[utils_default.findKey(resolvers, responseType) || "text"](response, config);
    !isStreamResponse && unsubscribe && unsubscribe();
    return await new Promise((resolve, reject) => {
      settle(resolve, reject, {
        data: responseData,
        headers: AxiosHeaders_default.from(response.headers),
        status: response.status,
        statusText: response.statusText,
        config,
        request
      });
    });
  } catch (err) {
    unsubscribe && unsubscribe();
    if (err && err.name === "TypeError" && /Load failed|fetch/i.test(err.message)) {
      throw Object.assign(
        new AxiosError_default("Network Error", AxiosError_default.ERR_NETWORK, config, request),
        {
          cause: err.cause || err
        }
      );
    }
    throw AxiosError_default.from(err, err && err.code, config, request);
  }
});

// node_modules/axios/lib/adapters/adapters.js
var knownAdapters = {
  http: null_default,
  xhr: xhr_default,
  fetch: fetch_default
};
utils_default.forEach(knownAdapters, (fn2, value) => {
  if (fn2) {
    try {
      Object.defineProperty(fn2, "name", { value });
    } catch (e2) {
    }
    Object.defineProperty(fn2, "adapterName", { value });
  }
});
var renderReason = (reason) => `- ${reason}`;
var isResolvedHandle = (adapter) => utils_default.isFunction(adapter) || adapter === null || adapter === false;
var adapters_default = {
  getAdapter: (adapters) => {
    adapters = utils_default.isArray(adapters) ? adapters : [adapters];
    const { length } = adapters;
    let nameOrAdapter;
    let adapter;
    const rejectedReasons = {};
    for (let i2 = 0; i2 < length; i2++) {
      nameOrAdapter = adapters[i2];
      let id;
      adapter = nameOrAdapter;
      if (!isResolvedHandle(nameOrAdapter)) {
        adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];
        if (adapter === void 0) {
          throw new AxiosError_default(`Unknown adapter '${id}'`);
        }
      }
      if (adapter) {
        break;
      }
      rejectedReasons[id || "#" + i2] = adapter;
    }
    if (!adapter) {
      const reasons = Object.entries(rejectedReasons).map(
        ([id, state]) => `adapter ${id} ` + (state === false ? "is not supported by the environment" : "is not available in the build")
      );
      let s2 = length ? reasons.length > 1 ? "since :\n" + reasons.map(renderReason).join("\n") : " " + renderReason(reasons[0]) : "as no adapter specified";
      throw new AxiosError_default(
        `There is no suitable adapter to dispatch the request ` + s2,
        "ERR_NOT_SUPPORT"
      );
    }
    return adapter;
  },
  adapters: knownAdapters
};

// node_modules/axios/lib/core/dispatchRequest.js
function throwIfCancellationRequested(config) {
  if (config.cancelToken) {
    config.cancelToken.throwIfRequested();
  }
  if (config.signal && config.signal.aborted) {
    throw new CanceledError_default(null, config);
  }
}
function dispatchRequest(config) {
  throwIfCancellationRequested(config);
  config.headers = AxiosHeaders_default.from(config.headers);
  config.data = transformData.call(
    config,
    config.transformRequest
  );
  if (["post", "put", "patch"].indexOf(config.method) !== -1) {
    config.headers.setContentType("application/x-www-form-urlencoded", false);
  }
  const adapter = adapters_default.getAdapter(config.adapter || defaults_default.adapter);
  return adapter(config).then(function onAdapterResolution(response) {
    throwIfCancellationRequested(config);
    response.data = transformData.call(
      config,
      config.transformResponse,
      response
    );
    response.headers = AxiosHeaders_default.from(response.headers);
    return response;
  }, function onAdapterRejection(reason) {
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);
      if (reason && reason.response) {
        reason.response.data = transformData.call(
          config,
          config.transformResponse,
          reason.response
        );
        reason.response.headers = AxiosHeaders_default.from(reason.response.headers);
      }
    }
    return Promise.reject(reason);
  });
}

// node_modules/axios/lib/env/data.js
var VERSION = "1.10.0";

// node_modules/axios/lib/helpers/validator.js
var validators = {};
["object", "boolean", "number", "function", "string", "symbol"].forEach((type, i2) => {
  validators[type] = function validator(thing) {
    return typeof thing === type || "a" + (i2 < 1 ? "n " : " ") + type;
  };
});
var deprecatedWarnings = {};
validators.transitional = function transitional(validator, version, message) {
  function formatMessage(opt, desc) {
    return "[Axios v" + VERSION + "] Transitional option '" + opt + "'" + desc + (message ? ". " + message : "");
  }
  return (value, opt, opts) => {
    if (validator === false) {
      throw new AxiosError_default(
        formatMessage(opt, " has been removed" + (version ? " in " + version : "")),
        AxiosError_default.ERR_DEPRECATED
      );
    }
    if (version && !deprecatedWarnings[opt]) {
      deprecatedWarnings[opt] = true;
      console.warn(
        formatMessage(
          opt,
          " has been deprecated since v" + version + " and will be removed in the near future"
        )
      );
    }
    return validator ? validator(value, opt, opts) : true;
  };
};
validators.spelling = function spelling(correctSpelling) {
  return (value, opt) => {
    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);
    return true;
  };
};
function assertOptions(options, schema, allowUnknown) {
  if (typeof options !== "object") {
    throw new AxiosError_default("options must be an object", AxiosError_default.ERR_BAD_OPTION_VALUE);
  }
  const keys = Object.keys(options);
  let i2 = keys.length;
  while (i2-- > 0) {
    const opt = keys[i2];
    const validator = schema[opt];
    if (validator) {
      const value = options[opt];
      const result = value === void 0 || validator(value, opt, options);
      if (result !== true) {
        throw new AxiosError_default("option " + opt + " must be " + result, AxiosError_default.ERR_BAD_OPTION_VALUE);
      }
      continue;
    }
    if (allowUnknown !== true) {
      throw new AxiosError_default("Unknown option " + opt, AxiosError_default.ERR_BAD_OPTION);
    }
  }
}
var validator_default = {
  assertOptions,
  validators
};

// node_modules/axios/lib/core/Axios.js
var validators2 = validator_default.validators;
var Axios = class {
  constructor(instanceConfig) {
    this.defaults = instanceConfig || {};
    this.interceptors = {
      request: new InterceptorManager_default(),
      response: new InterceptorManager_default()
    };
  }
  /**
   * Dispatch a request
   *
   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)
   * @param {?Object} config
   *
   * @returns {Promise} The Promise to be fulfilled
   */
  async request(configOrUrl, config) {
    try {
      return await this._request(configOrUrl, config);
    } catch (err) {
      if (err instanceof Error) {
        let dummy = {};
        Error.captureStackTrace ? Error.captureStackTrace(dummy) : dummy = new Error();
        const stack = dummy.stack ? dummy.stack.replace(/^.+\n/, "") : "";
        try {
          if (!err.stack) {
            err.stack = stack;
          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\n.+\n/, ""))) {
            err.stack += "\n" + stack;
          }
        } catch (e2) {
        }
      }
      throw err;
    }
  }
  _request(configOrUrl, config) {
    if (typeof configOrUrl === "string") {
      config = config || {};
      config.url = configOrUrl;
    } else {
      config = configOrUrl || {};
    }
    config = mergeConfig(this.defaults, config);
    const { transitional: transitional2, paramsSerializer, headers } = config;
    if (transitional2 !== void 0) {
      validator_default.assertOptions(transitional2, {
        silentJSONParsing: validators2.transitional(validators2.boolean),
        forcedJSONParsing: validators2.transitional(validators2.boolean),
        clarifyTimeoutError: validators2.transitional(validators2.boolean)
      }, false);
    }
    if (paramsSerializer != null) {
      if (utils_default.isFunction(paramsSerializer)) {
        config.paramsSerializer = {
          serialize: paramsSerializer
        };
      } else {
        validator_default.assertOptions(paramsSerializer, {
          encode: validators2.function,
          serialize: validators2.function
        }, true);
      }
    }
    if (config.allowAbsoluteUrls !== void 0) {
    } else if (this.defaults.allowAbsoluteUrls !== void 0) {
      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;
    } else {
      config.allowAbsoluteUrls = true;
    }
    validator_default.assertOptions(config, {
      baseUrl: validators2.spelling("baseURL"),
      withXsrfToken: validators2.spelling("withXSRFToken")
    }, true);
    config.method = (config.method || this.defaults.method || "get").toLowerCase();
    let contextHeaders = headers && utils_default.merge(
      headers.common,
      headers[config.method]
    );
    headers && utils_default.forEach(
      ["delete", "get", "head", "post", "put", "patch", "common"],
      (method) => {
        delete headers[method];
      }
    );
    config.headers = AxiosHeaders_default.concat(contextHeaders, headers);
    const requestInterceptorChain = [];
    let synchronousRequestInterceptors = true;
    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {
      if (typeof interceptor.runWhen === "function" && interceptor.runWhen(config) === false) {
        return;
      }
      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;
      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);
    });
    const responseInterceptorChain = [];
    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {
      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);
    });
    let promise;
    let i2 = 0;
    let len;
    if (!synchronousRequestInterceptors) {
      const chain = [dispatchRequest.bind(this), void 0];
      chain.unshift.apply(chain, requestInterceptorChain);
      chain.push.apply(chain, responseInterceptorChain);
      len = chain.length;
      promise = Promise.resolve(config);
      while (i2 < len) {
        promise = promise.then(chain[i2++], chain[i2++]);
      }
      return promise;
    }
    len = requestInterceptorChain.length;
    let newConfig = config;
    i2 = 0;
    while (i2 < len) {
      const onFulfilled = requestInterceptorChain[i2++];
      const onRejected = requestInterceptorChain[i2++];
      try {
        newConfig = onFulfilled(newConfig);
      } catch (error) {
        onRejected.call(this, error);
        break;
      }
    }
    try {
      promise = dispatchRequest.call(this, newConfig);
    } catch (error) {
      return Promise.reject(error);
    }
    i2 = 0;
    len = responseInterceptorChain.length;
    while (i2 < len) {
      promise = promise.then(responseInterceptorChain[i2++], responseInterceptorChain[i2++]);
    }
    return promise;
  }
  getUri(config) {
    config = mergeConfig(this.defaults, config);
    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);
    return buildURL(fullPath, config.params, config.paramsSerializer);
  }
};
utils_default.forEach(["delete", "get", "head", "options"], function forEachMethodNoData(method) {
  Axios.prototype[method] = function(url, config) {
    return this.request(mergeConfig(config || {}, {
      method,
      url,
      data: (config || {}).data
    }));
  };
});
utils_default.forEach(["post", "put", "patch"], function forEachMethodWithData(method) {
  function generateHTTPMethod(isForm) {
    return function httpMethod(url, data, config) {
      return this.request(mergeConfig(config || {}, {
        method,
        headers: isForm ? {
          "Content-Type": "multipart/form-data"
        } : {},
        url,
        data
      }));
    };
  }
  Axios.prototype[method] = generateHTTPMethod();
  Axios.prototype[method + "Form"] = generateHTTPMethod(true);
});
var Axios_default = Axios;

// node_modules/axios/lib/cancel/CancelToken.js
var CancelToken = class _CancelToken {
  constructor(executor) {
    if (typeof executor !== "function") {
      throw new TypeError("executor must be a function.");
    }
    let resolvePromise;
    this.promise = new Promise(function promiseExecutor(resolve) {
      resolvePromise = resolve;
    });
    const token = this;
    this.promise.then((cancel) => {
      if (!token._listeners) return;
      let i2 = token._listeners.length;
      while (i2-- > 0) {
        token._listeners[i2](cancel);
      }
      token._listeners = null;
    });
    this.promise.then = (onfulfilled) => {
      let _resolve;
      const promise = new Promise((resolve) => {
        token.subscribe(resolve);
        _resolve = resolve;
      }).then(onfulfilled);
      promise.cancel = function reject() {
        token.unsubscribe(_resolve);
      };
      return promise;
    };
    executor(function cancel(message, config, request) {
      if (token.reason) {
        return;
      }
      token.reason = new CanceledError_default(message, config, request);
      resolvePromise(token.reason);
    });
  }
  /**
   * Throws a `CanceledError` if cancellation has been requested.
   */
  throwIfRequested() {
    if (this.reason) {
      throw this.reason;
    }
  }
  /**
   * Subscribe to the cancel signal
   */
  subscribe(listener) {
    if (this.reason) {
      listener(this.reason);
      return;
    }
    if (this._listeners) {
      this._listeners.push(listener);
    } else {
      this._listeners = [listener];
    }
  }
  /**
   * Unsubscribe from the cancel signal
   */
  unsubscribe(listener) {
    if (!this._listeners) {
      return;
    }
    const index = this._listeners.indexOf(listener);
    if (index !== -1) {
      this._listeners.splice(index, 1);
    }
  }
  toAbortSignal() {
    const controller = new AbortController();
    const abort = (err) => {
      controller.abort(err);
    };
    this.subscribe(abort);
    controller.signal.unsubscribe = () => this.unsubscribe(abort);
    return controller.signal;
  }
  /**
   * Returns an object that contains a new `CancelToken` and a function that, when called,
   * cancels the `CancelToken`.
   */
  static source() {
    let cancel;
    const token = new _CancelToken(function executor(c2) {
      cancel = c2;
    });
    return {
      token,
      cancel
    };
  }
};
var CancelToken_default = CancelToken;

// node_modules/axios/lib/helpers/spread.js
function spread(callback) {
  return function wrap(arr) {
    return callback.apply(null, arr);
  };
}

// node_modules/axios/lib/helpers/isAxiosError.js
function isAxiosError(payload) {
  return utils_default.isObject(payload) && payload.isAxiosError === true;
}

// node_modules/axios/lib/helpers/HttpStatusCode.js
var HttpStatusCode = {
  Continue: 100,
  SwitchingProtocols: 101,
  Processing: 102,
  EarlyHints: 103,
  Ok: 200,
  Created: 201,
  Accepted: 202,
  NonAuthoritativeInformation: 203,
  NoContent: 204,
  ResetContent: 205,
  PartialContent: 206,
  MultiStatus: 207,
  AlreadyReported: 208,
  ImUsed: 226,
  MultipleChoices: 300,
  MovedPermanently: 301,
  Found: 302,
  SeeOther: 303,
  NotModified: 304,
  UseProxy: 305,
  Unused: 306,
  TemporaryRedirect: 307,
  PermanentRedirect: 308,
  BadRequest: 400,
  Unauthorized: 401,
  PaymentRequired: 402,
  Forbidden: 403,
  NotFound: 404,
  MethodNotAllowed: 405,
  NotAcceptable: 406,
  ProxyAuthenticationRequired: 407,
  RequestTimeout: 408,
  Conflict: 409,
  Gone: 410,
  LengthRequired: 411,
  PreconditionFailed: 412,
  PayloadTooLarge: 413,
  UriTooLong: 414,
  UnsupportedMediaType: 415,
  RangeNotSatisfiable: 416,
  ExpectationFailed: 417,
  ImATeapot: 418,
  MisdirectedRequest: 421,
  UnprocessableEntity: 422,
  Locked: 423,
  FailedDependency: 424,
  TooEarly: 425,
  UpgradeRequired: 426,
  PreconditionRequired: 428,
  TooManyRequests: 429,
  RequestHeaderFieldsTooLarge: 431,
  UnavailableForLegalReasons: 451,
  InternalServerError: 500,
  NotImplemented: 501,
  BadGateway: 502,
  ServiceUnavailable: 503,
  GatewayTimeout: 504,
  HttpVersionNotSupported: 505,
  VariantAlsoNegotiates: 506,
  InsufficientStorage: 507,
  LoopDetected: 508,
  NotExtended: 510,
  NetworkAuthenticationRequired: 511
};
Object.entries(HttpStatusCode).forEach(([key, value]) => {
  HttpStatusCode[value] = key;
});
var HttpStatusCode_default = HttpStatusCode;

// node_modules/axios/lib/axios.js
function createInstance(defaultConfig) {
  const context = new Axios_default(defaultConfig);
  const instance = bind(Axios_default.prototype.request, context);
  utils_default.extend(instance, Axios_default.prototype, context, { allOwnKeys: true });
  utils_default.extend(instance, context, null, { allOwnKeys: true });
  instance.create = function create(instanceConfig) {
    return createInstance(mergeConfig(defaultConfig, instanceConfig));
  };
  return instance;
}
var axios = createInstance(defaults_default);
axios.Axios = Axios_default;
axios.CanceledError = CanceledError_default;
axios.CancelToken = CancelToken_default;
axios.isCancel = isCancel;
axios.VERSION = VERSION;
axios.toFormData = toFormData_default;
axios.AxiosError = AxiosError_default;
axios.Cancel = axios.CanceledError;
axios.all = function all(promises) {
  return Promise.all(promises);
};
axios.spread = spread;
axios.isAxiosError = isAxiosError;
axios.mergeConfig = mergeConfig;
axios.AxiosHeaders = AxiosHeaders_default;
axios.formToJSON = (thing) => formDataToJSON_default(utils_default.isHTMLForm(thing) ? new FormData(thing) : thing);
axios.getAdapter = adapters_default.getAdapter;
axios.HttpStatusCode = HttpStatusCode_default;
axios.default = axios;
var axios_default = axios;

// node_modules/axios/index.js
var {
  Axios: Axios2,
  AxiosError: AxiosError2,
  CanceledError: CanceledError2,
  isCancel: isCancel2,
  CancelToken: CancelToken2,
  VERSION: VERSION2,
  all: all2,
  Cancel,
  isAxiosError: isAxiosError2,
  spread: spread2,
  toFormData: toFormData2,
  AxiosHeaders: AxiosHeaders2,
  HttpStatusCode: HttpStatusCode2,
  formToJSON,
  getAdapter,
  mergeConfig: mergeConfig2
} = axios_default;

// node_modules/textalive-app-api/dist/index.es.js
var e = { exports: {} };
!function(t) {
  function e2(t2, e3, r2) {
    for (var n2 = r2 && "number" != typeof e3 ? r2(e3) : e3, i2 = 0, o2 = t2.length; i2 < o2; ) {
      var s2 = i2 + o2 >>> 1;
      (r2 ? r2(t2[s2]) : t2[s2]) < n2 ? i2 = s2 + 1 : o2 = s2;
    }
    return i2;
  }
  t.sortedIndex = e2, Object.defineProperty(t, "__esModule", { value: true });
}(e.exports);
var r = e.exports;
var n = { NONE: 0, PHRASE: 1, WORD: 2, CHAR: 4, GRAPHIC: 8, ALL: 63, PUBLIC: 64 };
var i = /^https?:\/\/uploader\.ongaaccel\.jp\/files\?guid=([a-zA-Z0-9]+)/i;
var o = /^https?:\/\/songle\.jp\/uploads\/([a-zA-Z0-9]+)\.mp3$/i;
var s = /^uploaded:([a-zA-Z0-9]+)$/i;
var a = /^songle\.jp\/uploads\/([a-zA-Z0-9]+)\.mp3$/i;
var u = /^https?:\/\/piapro\.jp\/t\/([^/]+)(\/[0-9]+)?$/i;
var c = { getSongPathFromUrl: function(t) {
  if (c.isUploaderUrl(t)) {
    var e2 = o.exec(t);
    if (e2) return "songle.jp/uploads/".concat(e2[1], ".mp3");
    var r2 = i.exec(t);
    if (r2) return "songle.jp/uploads/".concat(r2[1], ".mp3");
  }
  return /https?:\/\/(.+)/.exec(t)[1];
}, isUploaderUrl: function(t) {
  return o.test(t) || i.test(t);
}, isUploaderPath: function(t) {
  return a.test(t) || s.test(t);
}, getUploaderGuid: function(t) {
  var e2 = a.exec(t);
  if (e2) return e2[1];
  var r2 = s.exec(t);
  return r2 ? r2[1] : null;
}, getSongUrlFromUploaderGuid: function(t) {
  return t ? "https://songle.jp/uploads/".concat(t, ".mp3") : null;
}, getAltSongUrlFromUploaderGuid: function(t) {
  return t ? "https://api.textalive.jp/songle/me/uploads/".concat(t) : null;
}, getSongUrlFromPath: function(t) {
  var e2 = c.getUploaderGuid(t);
  return e2 ? c.getSongUrlFromUploaderGuid(e2) : "https://".concat(t);
}, isYouTubeUrl: function(t) {
  return /^https?:\/\/((www|m)\.)?youtube\.com/i.test(t);
}, isNicovideoUrl: function(t) {
  return /^https?:\/\/(www\.)?nicovideo.jp/i.test(t);
}, isVideoSiteUrl: function(t) {
  return c.isYouTubeUrl(t) || c.isNicovideoUrl(t);
}, isPiaproUrl: function(t) {
  return u.test(t);
} };
var l = /^https:\/\/songle\.jp\/api\/v[0-9]+\/users\/(.+)\/uploads\/(.+)$/;
var p = function(t) {
  return l.test(t);
};
var h = function(t) {
  var e2 = l.exec(t);
  return e2 ? { user: e2[1], identifier: e2[2] } : { user: null, identifier: null };
};
var d = function() {
  function t() {
  }
  return t.prototype.isLicenseLoading = function(t2) {
    return !t2 || !t2.song || void 0 === t2.lyrics || void 0 === t2.backgroundImage;
  }, t.prototype.checkLicenses = function(t2) {
    return !this.isLicenseLoading(t2) && this.checkLicense(t2.song) && this.checkLicense(t2.lyrics) && this.checkLicense(t2.backgroundImage);
  }, t.prototype.checkLicense = function(t2) {
    return null === t2 || (1 === t2.contentType ? this.checkMusicLicense(t2.license) : 2 === t2.contentType ? this.checkTextLicense(t2.license) : 0 === t2.contentType && (!!this.isBackgroundColorAsset(t2) || this.checkBackgroundImageLicense(t2.license)));
  }, t.prototype.checkMusicLicense = function(t2) {
    return t2.condition && t2.condition.uploader || !(!t2.condition || t2.condition.ns || t2.condition.nc || t2.condition.org || t2.condition.clb);
  }, t.prototype.checkTextLicense = function(t2) {
    return t2.condition && t2.condition.uploader || !(!t2.condition || t2.condition.ns || t2.condition.org || t2.condition.clb);
  }, t.prototype.checkBackgroundImageLicense = function(t2) {
    return !(!t2.condition || t2.condition.ns || t2.condition.nc || t2.condition.org || t2.condition.clb);
  }, t.prototype.isUploaderAsset = function(t2) {
    return t2 && t2.url && (c.isUploaderUrl(t2.url) || p(t2.url));
  }, t.prototype.isPiaproAsset = function(t2) {
    return t2 && t2.url && c.isPiaproUrl(t2.url);
  }, t.prototype.isBlankBackgroundAsset = function(t2) {
    return !t2 || !t2.originalUrl;
  }, t.prototype.isBackgroundColorAsset = function(t2) {
    var e2 = t2 && t2.originalUrl ? t2.originalUrl : "";
    return /^#[0-9a-fA-F]{3,6}$/.test(e2);
  }, t.prototype.isBackgroundPiaproImageAsset = function(t2) {
    var e2 = t2 && t2.originalUrl ? t2.originalUrl : "";
    return c.isPiaproUrl(e2);
  }, t.prototype.isBackgroundSpecialImageAsset = function(t2) {
    var e2 = t2 && t2.originalUrl ? t2.originalUrl : "";
    return /^snowmiku2016-([0-9]{2})$/.test(e2);
  }, t.prototype.getQueryParameter = function(t2) {
    return !t2 || t2.license && !this.checkBackgroundImageLicense(t2.license) ? null : t2.originalUrl;
  }, t;
}();
var f = function(t, e2) {
  return f = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t2, e3) {
    t2.__proto__ = e3;
  } || function(t2, e3) {
    for (var r2 in e3) Object.prototype.hasOwnProperty.call(e3, r2) && (t2[r2] = e3[r2]);
  }, f(t, e2);
};
var y = function() {
  return y = Object.assign || function(t) {
    for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++) for (var i2 in e2 = arguments[r2]) Object.prototype.hasOwnProperty.call(e2, i2) && (t[i2] = e2[i2]);
    return t;
  }, y.apply(this, arguments);
};
function g(t, e2, r2, n2) {
  return new (r2 || (r2 = Promise))(function(e3, i2) {
    function o2(t2) {
      try {
        a2(n2.next(t2));
      } catch (t3) {
        i2(t3);
      }
    }
    function s2(t2) {
      try {
        a2(n2.throw(t2));
      } catch (t3) {
        i2(t3);
      }
    }
    function a2(t2) {
      var n3;
      t2.done ? e3(t2.value) : (n3 = t2.value, n3 instanceof r2 ? n3 : new r2(function(t3) {
        t3(n3);
      })).then(o2, s2);
    }
    a2((n2 = n2.apply(t, [])).next());
  });
}
function v(t, e2) {
  var r2, n2, i2, o2, s2 = { label: 0, sent: function() {
    if (1 & i2[0]) throw i2[1];
    return i2[1];
  }, trys: [], ops: [] };
  return o2 = { next: a2(0), throw: a2(1), return: a2(2) }, "function" == typeof Symbol && (o2[Symbol.iterator] = function() {
    return this;
  }), o2;
  function a2(a3) {
    return function(u2) {
      return function(a4) {
        if (r2) throw new TypeError("Generator is already executing.");
        for (; o2 && (o2 = 0, a4[0] && (s2 = 0)), s2; ) try {
          if (r2 = 1, n2 && (i2 = 2 & a4[0] ? n2.return : a4[0] ? n2.throw || ((i2 = n2.return) && i2.call(n2), 0) : n2.next) && !(i2 = i2.call(n2, a4[1])).done) return i2;
          switch (n2 = 0, i2 && (a4 = [2 & a4[0], i2.value]), a4[0]) {
            case 0:
            case 1:
              i2 = a4;
              break;
            case 4:
              return s2.label++, { value: a4[1], done: false };
            case 5:
              s2.label++, n2 = a4[1], a4 = [0];
              continue;
            case 7:
              a4 = s2.ops.pop(), s2.trys.pop();
              continue;
            default:
              if (!((i2 = (i2 = s2.trys).length > 0 && i2[i2.length - 1]) || 6 !== a4[0] && 2 !== a4[0])) {
                s2 = 0;
                continue;
              }
              if (3 === a4[0] && (!i2 || a4[1] > i2[0] && a4[1] < i2[3])) {
                s2.label = a4[1];
                break;
              }
              if (6 === a4[0] && s2.label < i2[1]) {
                s2.label = i2[1], i2 = a4;
                break;
              }
              if (i2 && s2.label < i2[2]) {
                s2.label = i2[2], s2.ops.push(a4);
                break;
              }
              i2[2] && s2.ops.pop(), s2.trys.pop();
              continue;
          }
          a4 = e2.call(t, s2);
        } catch (t2) {
          a4 = [6, t2], n2 = 0;
        } finally {
          r2 = i2 = 0;
        }
        if (5 & a4[0]) throw a4[1];
        return { value: a4[0] ? a4[1] : void 0, done: true };
      }([a3, u2]);
    };
  }
}
var m = { fallback: { protocol: "https" }, songle: { domain: "songle.jp" }, textalive: { domain: "api.textalive.jp" }, content: { domain: "content.textalive.jp" }, client: { version: "0.10.0", axios: null } };
function b(e2, r2, n2) {
  var i2, o2, s2;
  return g(this, 0, void 0, function() {
    var a2;
    return v(this, function(u2) {
      switch (u2.label) {
        case 0:
          a2 = { responseType: (null == n2 ? void 0 : n2.responseType) || "json" }, r2 && (a2.params = r2), (null == n2 ? void 0 : n2.auth) && (a2.auth = { username: null === (i2 = n2.auth) || void 0 === i2 ? void 0 : i2.username, password: null === (o2 = n2.auth) || void 0 === o2 ? void 0 : o2.password }), (null == n2 ? void 0 : n2.withCredentials) && (a2.withCredentials = true), a2.headers = {}, 0 === e2.indexOf(m.textalive.server) && (m.textalive.appToken && (a2.headers["x-ta-app-token"] = m.textalive.appToken), m.textalive.authUser && m.textalive.authToken && (a2.headers["x-ta-auth-user"] = m.textalive.authUser, a2.headers["x-ta-auth-token"] = m.textalive.authToken)), (null == n2 ? void 0 : n2.headers) && (a2.headers = y(y({}, a2.headers), n2.headers)), u2.label = 1;
        case 1:
          return u2.trys.push([1, 3, , 4]), [4, ((null == n2 ? void 0 : n2.client) || (null === (s2 = m.client) || void 0 === s2 ? void 0 : s2.axios) || axios_default).get(e2, a2)];
        case 2:
          return [2, u2.sent()];
        case 3:
          return u2.sent(), [2, null];
        case 4:
          return [2];
      }
    });
  });
}
function _(t) {
  var e2, r2, n2 = 0;
  if (0 === t.length) return n2;
  for (e2 = 0, r2 = t.length; e2 < r2; e2++) n2 = (n2 << 5) - n2 + t.charCodeAt(e2), n2 |= 0;
  return n2;
}
m.songle.protocol = m.songle.protocol || m.fallback.protocol, m.songle.server = "".concat(m.songle.protocol, "://").concat(m.songle.domain), m.textalive.protocol = m.textalive.protocol || m.fallback.protocol, m.textalive.server = "".concat(m.textalive.protocol, "://").concat(m.textalive.domain), m.textalive.appToken = null, m.content.protocol = m.content.protocol || m.fallback.protocol, m.content.server = "".concat(m.content.protocol, "://").concat(m.content.domain);
var w = new (function(t) {
  function e2() {
    return null !== t && t.apply(this, arguments) || this;
  }
  return function(t2, e3) {
    if ("function" != typeof e3 && null !== e3) throw new TypeError("Class extends value " + String(e3) + " is not a constructor or null");
    function r2() {
      this.constructor = t2;
    }
    f(t2, e3), t2.prototype = null === e3 ? Object.create(e3) : (r2.prototype = e3.prototype, new r2());
  }(e2, t), Object.defineProperty(e2.prototype, "endpoint", { get: function() {
    return "".concat(m.textalive.server, "/etc/license");
  }, enumerable: false, configurable: true }), e2.prototype.read = function(t2, e3) {
    var r2;
    return void 0 === e3 && (e3 = true), g(this, 0, void 0, function() {
      var n2, i2;
      return v(this, function(o2) {
        switch (o2.label) {
          case 0:
            return [4, b(this.endpoint, { url: t2, token: _("ta" + t2), skipOptoutCheck: !!e3 || void 0 })];
          case 1:
            return !(n2 = o2.sent()) || 200 !== n2.status || (null === (r2 = n2.data) || void 0 === r2 ? void 0 : r2.error) ? [2, { originalUrl: null, license: { code: n2 ? n2.status : 404 } }] : ((i2 = n2.data).license.code = n2.status, 0 === i2.contentType && (i2.css = 'url("' + i2.contentUrl + '")'), [2, i2]);
        }
      });
    });
  }, e2;
}(d))();
function P(e2, r2, n2) {
  var i2;
  return g(this, 0, void 0, function() {
    var o2;
    return v(this, function(s2) {
      switch (s2.label) {
        case 0:
          r2 || (r2 = {}), o2 = { responseType: (null == n2 ? void 0 : n2.responseType) || "json" }, (null == n2 ? void 0 : n2.withCredentials) && (o2.withCredentials = true), o2.headers = {}, 0 === e2.indexOf(m.textalive.server) && (m.textalive.appToken && (o2.headers["x-ta-app-token"] = m.textalive.appToken), m.textalive.authUser && m.textalive.authToken && (o2.headers["x-ta-auth-user"] = m.textalive.authUser, o2.headers["x-ta-auth-token"] = m.textalive.authToken)), (null == n2 ? void 0 : n2.postToken) && (o2.headers["x-ta-post-token"] = n2.postToken), (null == n2 ? void 0 : n2.headers) && (o2.headers || (o2.headers = {}), o2.headers = y(y({}, o2.headers), n2.headers)), s2.label = 1;
        case 1:
          return s2.trys.push([1, 3, , 4]), [4, ((null == n2 ? void 0 : n2.client) || (null === (i2 = m.client) || void 0 === i2 ? void 0 : i2.axios) || axios_default).post(e2, r2, o2)];
        case 2:
          return [2, s2.sent()];
        case 3:
          return s2.sent(), [2, null];
        case 4:
          return [2];
      }
    });
  });
}
var E = "data:text/plain;base64,";
function O(t) {
  return "string" == typeof t && 0 === t.indexOf(E);
}
function S(t) {
  if (!O(t)) return null;
  var e2 = t.split(",")[1];
  return decodeURIComponent(atob(e2).split("").map(function(t2) {
    return "%" + ("00" + t2.charCodeAt(0).toString(16)).slice(-2);
  }).join(""));
}
function T(t) {
  return "string" != typeof t ? null : E + btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g, function(t2, e2) {
    return String.fromCharCode(parseInt("0x" + e2));
  }));
}
function x(t, e2, r2, n2, i2) {
  var o2 = void 0 === window.screenLeft ? screen.left : window.screenLeft, s2 = void 0 === window.screenTop ? screen.top : window.screenTop, a2 = (window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width) / 2 - r2 / 2 + o2, u2 = (window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height) / 2 - n2 / 2 + s2, c2 = window.open(t, e2, "width=" + r2 + ",height=" + n2 + ",top=" + u2 + ",left=" + a2 + "," + i2);
  return window.focus && c2.focus(), c2;
}
var A = new (function() {
  function t() {
    this.listeners = [], this.pollingTimeout = null;
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return "".concat(m.textalive.server, "/");
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "songleEndpoint", { get: function() {
    return "".concat(m.songle.server, "/");
  }, enumerable: false, configurable: true }), t.prototype.isLoading = function() {
    return !!this.userProfile;
  }, t.prototype.spoof = function(t2) {
    this.userProfile = t2;
  }, t.prototype.getServerStatus = function() {
    return g(this, 0, void 0, function() {
      return v(this, function(t2) {
        return [2, this.serverStatus || this.doGetServerStatus()];
      });
    });
  }, t.prototype.doGetServerStatus = function() {
    return g(this, 0, void 0, function() {
      var t2;
      return v(this, function(e2) {
        switch (e2.label) {
          case 0:
            return this.serverStatusRequest || (this.serverStatusRequest = b(this.endpoint, null, { withCredentials: true })), [4, this.serverStatusRequest];
          case 1:
            return t2 = e2.sent(), this.serverStatusRequest = null, t2 && 200 === t2.status ? (this.serverStatus = t2.data, [2, this.serverStatus]) : [2, null];
        }
      });
    });
  }, t.prototype.getProfile = function() {
    return g(this, 0, void 0, function() {
      return v(this, function(t2) {
        return [2, this.userProfile || this.doGetProfile()];
      });
    });
  }, t.prototype.doGetProfile = function() {
    return g(this, 0, void 0, function() {
      var t2;
      return v(this, function(e2) {
        switch (e2.label) {
          case 0:
            return this.userProfileRequest || (this.userProfileRequest = b("".concat(this.endpoint, "profile"), null, { withCredentials: true })), [4, this.userProfileRequest];
          case 1:
            return t2 = e2.sent(), this.userProfileRequest = null, t2 && 200 === t2.status ? (this.emitUserProfile(t2.data), this.userProfile = t2.data, [2, this.userProfile]) : [2, null];
        }
      });
    });
  }, t.prototype.getMergingUsers = function() {
    return g(this, 0, void 0, function() {
      var t2;
      return v(this, function(e2) {
        switch (e2.label) {
          case 0:
            return [4, b("".concat(this.endpoint, "profile/merge"), null, { withCredentials: true })];
          case 1:
            return (t2 = e2.sent()) && 200 === t2.status && t2.data ? [2, [t2.data.user, t2.data.mergeWith]] : [2, [null, null]];
        }
      });
    });
  }, t.prototype.mergeUsers = function() {
    var t2;
    return g(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2;
      return v(this, function(a2) {
        switch (a2.label) {
          case 0:
            return [4, this.getToken()];
          case 1:
            return e2 = a2.sent(), [4, P("".concat(this.endpoint, "profile/merge"), null, { postToken: e2, withCredentials: true })];
          case 2:
            if (!(r2 = a2.sent()) || 200 !== r2.status || !(null === (t2 = r2.data) || void 0 === t2 ? void 0 : t2.success)) return [2, null];
            for (n2 = r2.data.user, i2 = 0, o2 = this.listeners; i2 < o2.length; i2++) (s2 = o2[i2]).onUserMerged && s2.onUserMerged(n2);
            return [2, n2];
        }
      });
    });
  }, t.prototype.updateUser = function(t2) {
    var e2;
    return g(this, 0, void 0, function() {
      var r2, n2, i2, o2;
      return v(this, function(s2) {
        switch (s2.label) {
          case 0:
            return [4, this.getToken()];
          case 1:
            return r2 = s2.sent(), [4, P("".concat(this.endpoint, "profile"), t2, { postToken: r2, withCredentials: true })];
          case 2:
            return (n2 = s2.sent()) && 200 === n2.status && (null === (e2 = n2.data) || void 0 === e2 ? void 0 : e2.success) ? (i2 = n2.data.user, [4, this.getProfile()]) : [2, null];
          case 3:
            return (o2 = s2.sent()).user = i2, this.emitUserProfile(o2), [2, i2];
        }
      });
    });
  }, t.prototype.isYouTubeUser = function(t2) {
    return t2 && t2.user && "string" == typeof t2.user.youtubeIdString;
  }, t.prototype.isPiaproUser = function(t2) {
    return t2 && t2.user && "string" == typeof t2.user.piaproIdString;
  }, t.prototype.isSongleUser = function(t2) {
    return t2 && t2.user && ("number" == typeof t2.user.songleUserId && t2.user.songleUserId >= 0 || "string" == typeof t2.user.songleAccessToken);
  }, t.prototype.isSpoofingSongleUser = function(t2) {
    return this.isSongleUser(t2) && ("number" != typeof t2.user.id || t2.user.id < 0);
  }, t.prototype.addListener = function(t2) {
    t2 && this.listeners.push(t2);
  }, t.prototype.removeListener = function(t2) {
    this.listeners = this.listeners.filter(function(e2) {
      return e2 !== t2;
    });
  }, t.prototype.emitUserProfile = function(t2) {
    this.userProfile = t2;
    for (var e2 = 0, r2 = this.listeners; e2 < r2.length; e2++) {
      var n2 = r2[e2];
      n2.onUserProfileUpdated && n2.onUserProfileUpdated(t2), this.userProfile.user ? n2.onUserLoggedIn && n2.onUserLoggedIn(t2.user) : n2.onUserLoggedOut && n2.onUserLoggedOut();
    }
  }, t.prototype.authenticate = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, b("".concat(this.endpoint, "profile/logins/basic"), null, { auth: { username: String(t2), password: e2 }, withCredentials: true })];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status && r2.data ? [2, r2.data] : [2, null];
        }
      });
    });
  }, t.prototype.loginTwitter = function(t2) {
    return this.login(t2, "twitter");
  }, t.prototype.loginGitHub = function(t2) {
    return this.login(t2, "github");
  }, t.prototype.loginYouTube = function(t2) {
    return this.login(t2, "youtube");
  }, t.prototype.loginPiapro = function(t2) {
    return this.login(t2, "piapro");
  }, t.prototype.loginSongle = function(t2) {
    return this.login(t2, "songle");
  }, t.prototype.login = function(t2, e2) {
    return t2 && t2.preventDefault(), !!e2 && (x("".concat(this.endpoint, "profile/logins/").concat(e2), "TextAliveAuth", 600, 480, "status=no,toolbar=no,menubar=no"), this.startMonitoringAuthState(), false);
  }, t.prototype.logoutTwitter = function(t2) {
    return this.logout(t2, "twitter");
  }, t.prototype.logoutGitHub = function(t2) {
    return this.logout(t2, "github");
  }, t.prototype.logoutYouTube = function(t2) {
    return this.logout(t2, "youtube");
  }, t.prototype.logoutPiapro = function(t2) {
    return this.logout(t2, "piapro");
  }, t.prototype.logoutSongle = function(t2) {
    return this.logout(t2, "songle");
  }, t.prototype.logout = function(t2, e2) {
    return void 0 === e2 && (e2 = null), t2 && t2.preventDefault(), x("".concat(this.endpoint, "profile/logouts/").concat(e2 || "all"), "TextAliveAuth", 600, 480, "status=no,toolbar=no,menubar=no"), this.startMonitoringAuthState(), false;
  }, t.prototype.startMonitoringAuthState = function() {
    var t2 = this;
    this.pollingTimeout && (clearTimeout(this.pollingTimeout), this.pollingTimeout = null);
    var e2 = function(r2) {
      if (r2.data && r2.data.textalive) {
        if (r2.source.postMessage("close", r2.origin), r2.data.merge) return t2.getMergingUsers().then(function(e3) {
          for (var r3 = e3[0], n2 = e3[1], i2 = 0, o2 = t2.listeners; i2 < o2.length; i2++) {
            var s2 = o2[i2];
            s2.onUserMergeRequired && s2.onUserMergeRequired(r3, n2);
          }
        }).catch(function() {
        }), void window.removeEventListener("message", e2);
        t2.doGetProfile(), window.removeEventListener("message", e2);
      }
    };
    window.addEventListener("message", e2);
  }, t.prototype.getToken = function() {
    return g(this, 0, void 0, function() {
      return v(this, function(t2) {
        return this.userProfile ? [2, this.userProfile.status.token] : this.token ? [2, this.token] : [2, this.doGetToken()];
      });
    });
  }, t.prototype.doGetToken = function() {
    var t2;
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.endpoint, "profile/token"), null, { withCredentials: true })];
          case 1:
            return e2 = r2.sent(), (null === (t2 = null == e2 ? void 0 : e2.data) || void 0 === t2 ? void 0 : t2.token) && (this.token = e2.data.token), [2, this.token];
        }
      });
    });
  }, t;
}())();
var R = new (function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return "".concat(m.textalive.server, "/text-parser/");
  }, enumerable: false, configurable: true }), t.prototype.parse = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, A.getToken()];
          case 1:
            return e2 = n2.sent(), [4, P(this.endpoint, { text: t2 }, { postToken: e2, withCredentials: true })];
          case 2:
            return (r2 = n2.sent()) && 200 === r2.status ? [2, r2.data] : [2, null];
        }
      });
    });
  }, t;
}())();
var C = new (function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return "".concat(m.content.server, "/fonts");
  }, enumerable: false, configurable: true }), t.prototype.listAvailableFonts = function() {
    return g(this, 0, void 0, function() {
      var t2 = this;
      return v(this, function(e2) {
        switch (e2.label) {
          case 0:
            return this.data ? [3, 2] : [4, this.fetchInfo()];
          case 1:
            e2.sent(), e2.label = 2;
          case 2:
            return this.data && this.data.fontFamilies ? [2, Object.keys(this.data.fontFamilies).map(function(e3) {
              return y({ key: e3 }, t2.data.fontFamilies[e3]);
            })] : [2, []];
        }
      });
    });
  }, t.prototype.getFrequentChars = function() {
    return g(this, 0, void 0, function() {
      return v(this, function(t2) {
        switch (t2.label) {
          case 0:
            return this.data ? [3, 2] : [4, this.fetchInfo()];
          case 1:
            t2.sent(), t2.label = 2;
          case 2:
            return [2, this.data && this.data.frequentChars || ""];
        }
      });
    });
  }, t.prototype.clearCache = function() {
    this.data = null;
  }, t.prototype.fetchInfo = function() {
    return g(this, 0, void 0, function() {
      var t2, e2, r2, n2;
      return v(this, function(i2) {
        switch (i2.label) {
          case 0:
            return [4, b("".concat(this.endpoint, "/index.json"))];
          case 1:
            if (!(t2 = i2.sent()) || 200 !== t2.status || !t2.data) return this.data = null, [2, null];
            for (r2 in this.data = t2.data, e2 = this.data.fontUrlPrefix, this.data.fontFamilies) (n2 = this.data.fontFamilies[r2]).typesquare || n2.typekit || n2.google || n2.url || (n2.url = "".concat(e2, "/").concat(r2, "-all.css"), n2.compactUrl = "".concat(e2, "/").concat(r2, ".css"));
            return [2];
        }
      });
    });
  }, t;
}())();
var N = new RegExp("\\b([CDEFGAB](?:b|bb)*(?:#|##|sus|maj|min|aug|m|M)*[\\d/]*(?:[CDEFGAB](?:b|bb)*(?:#|##|sus|maj|min|aug|m|M)*[\\d/]*)*\\-){2}");
function k(t, e2, r2) {
  return !N.test(t) && !t.match(/[(].+(?:|).*[)]/) && (!t.match(/(|).+(|)/) || 0 !== e2 && e2 !== r2.length - 2);
}
function j(t) {
  return !t.match(new RegExp("[(]?"));
}
var I = {};
var U = {};
var F = function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return "".concat(m.songle.server, "/lyrics/");
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "localLyricsEndpoint", { get: function() {
    return "".concat(m.textalive.server, "/etc/lyrics");
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "timingEndpoint", { get: function() {
    return "".concat(m.songle.server, "/songs/");
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "lyricsParserEndpoint", { get: function() {
    return m.songle.server;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "lyricsPostEndpoint", { get: function() {
    return m.songle.server;
  }, enumerable: false, configurable: true }), t.prototype.isUploaderUrl = function(t2) {
    return p(t2);
  }, t.prototype.parseUploaderUrl = function(t2) {
    return h(t2);
  }, t.prototype.getRecentlySynchronizedList = function(t2) {
    return void 0 === t2 && (t2 = {}), g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return e2 = {}, "number" == typeof t2 ? e2.page = t2 : t2 && (e2.page = t2.page, e2.per_page = t2.perPage), [4, b("".concat(this.endpoint, "recently_synchronized.json"), e2)];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status ? [2, r2.data] : [2, null];
        }
      });
    });
  }, t.prototype.load = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.timingEndpoint + t2, "/lyrics.json"))];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.clearCache = function() {
    I = {};
  }, t.prototype.loadDetail = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2, n2;
      return v(this, function(i2) {
        switch (i2.label) {
          case 0:
            return I[t2] && I[t2][e2] ? [2, I[t2][e2]] : [4, b("".concat(this.timingEndpoint + t2, "/lyrics/").concat(e2 < 0 ? "latest" : e2, ".json"))];
          case 1:
            return (r2 = i2.sent()) && 200 === r2.status ? (n2 = r2.data, I[t2] || (I[t2] = {}), I[t2][n2.id] = n2, e2 < 0 && (I[t2][-1] = n2), [2, n2]) : [2, null];
        }
      });
    });
  }, t.prototype.loadDiffs = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, b("".concat(this.timingEndpoint + t2, "/lyrics/").concat(e2, "/diffs.json"))];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status ? [2, r2.data] : [2, null];
        }
      });
    });
  }, t.prototype.loadDiff = function(t2, e2, r2) {
    return g(this, 0, void 0, function() {
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, b("".concat(this.timingEndpoint + t2, "/lyrics/").concat(e2).concat(r2 < 0 ? "" : 0 === r2 ? "/original" : "/diffs/".concat(r2, "/lyrics"), ".json"))];
          case 1:
            return [2, n2.sent().data];
        }
      });
    });
  }, t.prototype.loadAllRevisionsForSong = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2, u2, c2, l2;
      return v(this, function(p2) {
        switch (p2.label) {
          case 0:
            return [4, this.load(t2)];
          case 1:
            if (!(e2 = p2.sent())) return [2, null];
            r2 = [], n2 = 0, i2 = e2.lyrics, p2.label = 2;
          case 2:
            return n2 < i2.length ? (o2 = i2[n2], [4, this.loadDetail(t2, o2.id)]) : [3, 6];
          case 3:
            return s2 = p2.sent(), [4, this.loadDiffs(t2, s2.id)];
          case 4:
            if (a2 = p2.sent(), r2.push({ lyrics: s2, updated_at: new Date(s2.created_at) }), Array.isArray(a2)) for (u2 = 0, c2 = a2; u2 < c2.length; u2++) l2 = c2[u2], r2.push({ diff_id: l2.id, source_id: l2.source_id, lyrics: s2, updated_at: new Date(l2.updated_at) });
            p2.label = 5;
          case 5:
            return n2++, [3, 2];
          case 6:
            return [2, r2.sort(function(t3, e3) {
              var r3 = e3.updated_at.getTime() - t3.updated_at.getTime();
              return 0 === r3 ? e3.diff_id - t3.diff_id : r3;
            })];
        }
      });
    });
  }, t.prototype.getLatestRevision = function(t2) {
    return t2.filter(function(t3) {
      return !(t3.lyrics.processing || t3.lyrics.failed);
    })[0];
  }, t.prototype.fetchLocalLyricBody = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2, i2;
      return v(this, function(o2) {
        switch (o2.label) {
          case 0:
            return this.verbose && ("string" == typeof t2 ? console.log("load locally-stored lyrics for song code", t2) : console.log("load locally-stored lyrics for lyric id", t2)), e2 = {}, "string" == typeof t2 ? e2.code = t2 : e2.lyricId = t2, [4, b("".concat(this.localLyricsEndpoint, "/token"), e2)];
          case 1:
            return !(r2 = o2.sent()) || 200 !== r2.status || r2.data.error ? [2, null] : (n2 = r2.data.token, e2.token = n2, [4, b(this.localLyricsEndpoint, e2)]);
          case 2:
            return (i2 = o2.sent()) && 200 === i2.status ? (this.verbose && console.log("loaded locally-stored lyrics with params", e2), [2, i2.data]) : [2, null];
        }
      });
    });
  }, t.prototype.fetchSongleLyricBody = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2, n2, i2, o2, s2, a2, u2, c2, l2, p2, h2;
      return v(this, function(d2) {
        switch (d2.label) {
          case 0:
            if (!(r2 = this.parseUploaderUrl(t2)).identifier) throw new Error("unsupported lyrics url ".concat(t2));
            return [4, A.getProfile()];
          case 1:
            if (n2 = d2.sent(), !A.isSongleUser(n2)) throw new Error("Songle authentication is required");
            return i2 = "".concat(t2, "//").concat(e2), U[i2] ? [2, U[i2]] : (A.isSpoofingSongleUser(n2) && (s2 = n2.user, a2 = s2.songleUserId, u2 = s2.songleAccessToken, c2 = s2.songleRefreshToken, o2 = { songleUserId: a2, songleAccessToken: u2, songleRefreshToken: c2 }), [4, b("".concat(m.textalive.server, "/songle/users/").concat(r2.user, "/uploads/").concat(r2.identifier), o2, { withCredentials: true, responseType: "text" })]);
          case 2:
            return l2 = d2.sent(), p2 = null == l2 ? void 0 : l2.data, h2 = p2 ? { text: p2, url: t2 } : null, p2 && (U[i2] = h2), [2, h2];
        }
      });
    });
  }, t.prototype.fetchPiaproLyricBody = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2, n2, i2, o2, s2;
      return v(this, function(a2) {
        switch (a2.label) {
          case 0:
            if (!c.isPiaproUrl(t2)) throw new Error("unsupported lyrics url ".concat(t2));
            return r2 = "".concat(t2, "//").concat(e2), U[r2] ? [2, U[r2]] : [4, w.read(t2, true)];
          case 1:
            if (n2 = a2.sent(), !w.isPiaproAsset(n2)) throw new Error("unsupported piapro lyrics url ".concat(t2));
            return i2 = S(n2.contentUrl), [4, this.parseLyricBody(i2, e2)];
          case 2:
            return o2 = a2.sent(), (s2 = o2 ? { text: o2, artist: { name: n2.authorName, url: n2.authorPath ? "https://piapro.jp".concat(n2.authorPath) : null }, name: n2.name, url: t2 } : null) && (U[r2] = s2), [2, s2];
        }
      });
    });
  }, t.prototype.fetchInternalLyricBody = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        if (r2 = new URL(t2), "undefined" == typeof location || location.protocol !== r2.protocol || location.hostname !== r2.hostname) throw new Error("direct access not supported for lyrics url ".concat(t2));
        return [2, this.fetchCrossOriginLyricBody(t2, e2)];
      });
    });
  }, t.prototype.fetchCrossOriginLyricBody = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2, n2, i2, o2, s2;
      return v(this, function(a2) {
        switch (a2.label) {
          case 0:
            return r2 = "".concat(t2, "//").concat(e2), U[r2] ? [2, U[r2]] : [4, b(t2, null, { responseType: "text" })];
          case 1:
            return n2 = a2.sent(), i2 = null == n2 ? void 0 : n2.data, n2 && 200 === n2.status && i2 ? [4, this.parseLyricBody(i2, e2)] : (this.verbose && console.error("direct access not supported for lyrics url ".concat(t2)), [2, this.fetchProxiedLyricBody(t2, e2)]);
          case 2:
            return o2 = a2.sent(), (s2 = o2 ? { text: o2, url: t2 } : null) && (U[r2] = s2), [2, s2];
        }
      });
    });
  }, t.prototype.fetchProxiedLyricBody = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2, n2, i2;
      return v(this, function(o2) {
        switch (o2.label) {
          case 0:
            return r2 = "".concat(t2, "//").concat(e2), U[r2] ? [2, U[r2]] : (this.verbose && console.log("load lyrics from the external server", t2), [4, L(this.lyricsParserEndpoint + e2, function(e3) {
              return new Promise(function(r3, n3) {
                e3.Songle.Utils.url2Lyric(t2, function(t3) {
                  return r3(t3);
                }, function(t3) {
                  return n3(t3);
                });
              });
            }, this.verbose)]);
          case 1:
            return n2 = o2.sent(), (i2 = n2 ? { text: n2, url: t2 } : null) && (U[r2] = i2), [2, i2];
        }
      });
    });
  }, t.prototype.parseLyricBody = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return n2.trys.push([0, 2, , 3]), [4, L(this.lyricsParserEndpoint + e2, function(e3) {
              return e3.Songle.Utils.parseLyric(t2);
            }, this.verbose)];
          case 1:
            return r2 = n2.sent(), [3, 3];
          case 2:
            return n2.sent(), r2 = function(t3) {
              return function(t4) {
                return t4 = function(t5) {
                  var e3, r3 = t5.split(/\n/);
                  return r3.forEach(function(t6, r4) {
                    t6.match(/^\S+\S+$/m) && (e3 = r4);
                  }), void 0 !== e3 && e3 < 5 ? r3.slice(e3 + 1).join("\n") : t5;
                }(t4), t4 = function(t5) {
                  for (var e3, r3, n3, i2, o2, s2 = new RegExp("[(]?(.)[)]?", "g"); null !== (r3 = s2.exec(t5)); ) n3 = r3[1], i2 = new RegExp("^(" + n3 + "[\\s\\S]+?)(?=\\n\\n[^\\u3000|\\s])", "m"), null !== (o2 = t5.match(i2)) && (e3 = o2[1].replace(new RegExp("^" + n3, "m"), "").replace(new RegExp("^\\n"), "").replace(new RegExp("^\\u3000", "mg"), ""), t5 = (t5 = t5.replace(i2, function() {
                    return e3;
                  })).replace(new RegExp("[\\(]?" + n3 + "[\\)]?", "g"), e3).replace(new RegExp("^" + n3, "m"), ""));
                  return t5;
                }(t4 = t4.split(/\n/).filter(k).join("\n")), t4 = function(t5) {
                  var e3 = new RegExp("[\\u4E00-\\u9FAF|\\uFF66-\\uFF9D|\\u31F0-\\u31FF]+[\\(]([\\u3041-\\u3096\\u309D-\\u309F]+)[\\)]", "g");
                  return t5.replace(e3, function(t6, e4) {
                    return e4;
                  });
                }(t4), t4.split(/\n/).filter(j).join("\n").replace(/\n\n+/g, "\n\n").replace(/\n+$/g, "\n");
              }(t3.replace(/^\ufeff/, "").replace(/\r/, "").split(/\n/).filter(k).filter(function(t4) {
                return !t4.match(/^#/);
              }).join("\n").replace(/^\s+/, ""));
            }(t2), [3, 3];
          case 3:
            return [2, r2];
        }
      });
    });
  }, t.prototype.clearLyricBodyCache = function() {
    U = {};
  }, t.prototype.fetchLyricBody = function(t2, e2) {
    var r2, n2, i2 = e2.parserPath, o2 = e2.directAccess;
    return g(this, 0, void 0, function() {
      var e3, s2;
      return v(this, function(a2) {
        switch (a2.label) {
          case 0:
            if (O(t2)) return this.verbose && console.log("load lyrics from the data url", t2), [2, { text: S(t2) }];
            if (this.isUploaderUrl(t2)) return [2, this.fetchSongleLyricBody(t2, i2)];
            if (c.isPiaproUrl(t2)) return [2, this.fetchPiaproLyricBody(t2, i2)];
            a2.label = 1;
          case 1:
            return a2.trys.push([1, 5, , 6]), e3 = new URL(t2), o2 || "undefined" != typeof location && location.protocol !== e3.protocol && "https:" !== e3.protocol ? [3, 4] : "undefined" != typeof location && location.hostname !== e3.hostname ? [3, 2] : (o2 = true, [3, 4]);
          case 2:
            return [4, b("".concat(this.localLyricsEndpoint, "/cors"), { url: t2 })];
          case 3:
            s2 = a2.sent(), o2 = s2 && 200 === s2.status && (null === (n2 = null === (r2 = s2.data) || void 0 === r2 ? void 0 : r2.data) || void 0 === n2 ? void 0 : n2.enabled), a2.label = 4;
          case 4:
            return o2 ? (this.verbose && console.log("load lyrics directly", t2), [2, this.fetchCrossOriginLyricBody(t2, i2)]) : [3, 6];
          case 5:
            return a2.sent(), [3, 6];
          case 6:
            return [2, this.fetchProxiedLyricBody(t2, i2)];
        }
      });
    });
  }, t.prototype.post = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return e2 = t2.forceUpdate ? { url: t2.lyricsUrl, force_create: "true" } : { url: t2.lyricsUrl }, [4, P("".concat(this.lyricsPostEndpoint, "/songs/").concat(t2.songId, "/lyrics.json"), e2)];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status && r2.data ? [2, { success: true, lyricsId: r2.data.id }] : [2, { success: false, error: "failed to update lyrics url" }];
        }
      });
    });
  }, t.prototype.postPrivate = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2, u2, c2, l2, p2;
      return v(this, function(h2) {
        switch (h2.label) {
          case 0:
            return [4, A.getProfile()];
          case 1:
            if (e2 = h2.sent(), !A.isSongleUser(e2)) throw new Error("Songle authentication is required");
            return A.isSpoofingSongleUser(e2) ? (n2 = e2.user, i2 = n2.songleUserId, o2 = n2.songleAccessToken, s2 = n2.songleRefreshToken, a2 = { songleUserId: i2, songleAccessToken: o2, songleRefreshToken: s2 }, r2 = "?" + Object.keys(a2).map(function(t3) {
              return "".concat(t3, "=").concat(encodeURIComponent(a2[t3]));
            }).join("&")) : r2 = "", u2 = t2.songId, c2 = t2.lyricsText, (l2 = new FormData()).append("text", c2), [4, P("".concat(m.textalive.server, "/songle/me/songs/").concat(u2, "/lyrics.json").concat(r2), l2, { withCredentials: true })];
          case 2:
            return (p2 = h2.sent()) && 200 === p2.status && p2.data ? [2, { success: true, lyrics: p2.data.data.lyric }] : [2, { success: false, error: "failed to post lyrics text" }];
        }
      });
    });
  }, t.prototype.update = function(t2) {
    var e2;
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, P("".concat(this.lyricsPostEndpoint, "/songs/").concat(t2.songCode, "/lyrics/").concat(t2.lyricsId, "/diffs.json"), t2.lyricsData ? { lyric: JSON.stringify(t2.lyricsData) } : { source_diff_id: t2.lyricsDiffId })];
          case 1:
            return r2 = n2.sent(), [2, (null === (e2 = null == r2 ? void 0 : r2.data) || void 0 === e2 ? void 0 : e2.lyric_diff) ? { success: 200 === r2.status, lyricsId: r2.data.lyric_diff.lyric_id, lyricsDiffId: r2.data.lyric_diff.id } : { success: 200 === r2.status }];
        }
      });
    });
  }, t;
}();
function L(t, e2, r2) {
  var n2, i2 = this;
  return "undefined" == typeof window || !(null === (n2 = null === window || void 0 === window ? void 0 : window.navigator) || void 0 === n2 ? void 0 : n2.userAgent) || window.navigator.userAgent.includes("Node.js") || window.navigator.userAgent.includes("jsdom") ? function(t2, e3, r3) {
    return r3 && console.log("parse lyrics: loading on Node.js", t2), new Promise(function(r4, n3) {
      b(t2, { responseType: "text" }).then(function(t3) {
        var i3 = t3.data, o2 = new Function("let g=global;global={};".concat(i3, ";let res=global;global=g")), s2 = {};
        try {
          o2.bind(s2)(), r4(e3(s2));
        } catch (t4) {
          n3(t4);
        }
      }).catch(n3);
    });
  }(t, e2, r2) : (r2 && console.log("parse lyrics: loading", t), new Promise(function(n3, o2) {
    try {
      var s2 = document.createElement("script"), a2 = null;
      window.module && (a2 = window.module, delete window.module), s2.src = t, s2.onload = function() {
        return g(i2, 0, void 0, function() {
          var i3, u2;
          return v(this, function(c2) {
            switch (c2.label) {
              case 0:
                document.body.removeChild(s2), r2 && console.log("parse lyrics: load", t), window.Songle && window.Songle.Utils && window.Songle.Utils.url2Lyric || (a2 && (window.module = a2), o2("url2Lyric not found")), c2.label = 1;
              case 1:
                return c2.trys.push([1, 3, 4, 5]), i3 = n3, [4, e2(window)];
              case 2:
                return i3.apply(void 0, [c2.sent()]), [3, 5];
              case 3:
                return u2 = c2.sent(), o2(u2), [3, 5];
              case 4:
                return a2 && (window.module = a2), [7];
              case 5:
                return [2];
            }
          });
        });
      }, s2.onerror = function(t2) {
        return o2(t2.message);
      }, document.body.appendChild(s2);
    } catch (e3) {
      console.error("failed to call lyrics parser", t, e3);
    }
  }));
}
var D = new F();
var M = {};
var B = {};
var V = new (function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return m.textalive.server;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "songleEndpoint", { get: function() {
    return m.songle.server;
  }, enumerable: false, configurable: true }), t.prototype.getSongPathFromUrl = function(t2) {
    return c.getSongPathFromUrl(t2);
  }, t.prototype.isUploaderUrl = function(t2) {
    return c.isUploaderUrl(t2);
  }, t.prototype.isUploaderPath = function(t2) {
    return c.isUploaderPath(t2);
  }, t.prototype.getUploaderGuid = function(t2) {
    return c.getUploaderGuid(t2);
  }, t.prototype.getAltSongUrlFromUploaderGuid = function(t2) {
    return c.getAltSongUrlFromUploaderGuid(t2);
  }, t.prototype.getSongUrlFromUploaderGuid = function(t2) {
    return c.getSongUrlFromUploaderGuid(t2);
  }, t.prototype.getSongUrlFromPath = function(t2) {
    return c.getSongUrlFromPath(t2);
  }, t.prototype.isYouTubeUrl = function(t2) {
    return c.isYouTubeUrl(t2);
  }, t.prototype.isNicovideoUrl = function(t2) {
    return c.isNicovideoUrl(t2);
  }, t.prototype.isVideoSiteUrl = function(t2) {
    return c.isVideoSiteUrl(t2);
  }, t.prototype.isPiaproUrl = function(t2) {
    return c.isPiaproUrl(t2);
  }, t.prototype.load = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return e2 = t2.code || "number" == typeof t2.id && String(t2.id) || encodeURIComponent(t2.songPath), M[e2] ? [2, M[e2]] : (M[e2] = this.doLoad(e2), [4, M[e2]]);
          case 1:
            return r2 = n2.sent(), this.use(r2), [2, r2];
        }
      });
    });
  }, t.prototype.use = function(t2) {
    if (t2) {
      var e2 = String(t2.song.id), r2 = t2.song.code, n2 = this.getSongPathFromUrl(t2.song.permalink);
      M[e2] = M[r2] = M[n2] = Promise.resolve(t2);
    }
  }, t.prototype.clearCache = function() {
    M = {}, B = {};
  }, t.prototype.doLoad = function(t2) {
    var e2;
    return g(this, 0, void 0, function() {
      var r2, n2, i2;
      return v(this, function(o2) {
        switch (o2.label) {
          case 0:
            return [4, b("".concat(this.songleEndpoint, "/songs/").concat(t2, "?format=json"))];
          case 1:
            return (r2 = o2.sent()) && 200 === r2.status ? (n2 = r2.data, this.isUploaderUrl(null === (e2 = null == n2 ? void 0 : n2.song) || void 0 === e2 ? void 0 : e2.permalink) ? [4, this.doLoadPrivateSong(n2.song.id)] : [3, 3]) : [2, null];
          case 2:
            if (i2 = o2.sent()) return n2.status = n2.status || {}, n2.status.owner = true, [2, y(y({}, n2), { song: i2 })];
            n2.status = n2.status || {}, n2.status.owner = false, o2.label = 3;
          case 3:
            return [2, n2];
        }
      });
    });
  }, t.prototype.doLoadPrivateSong = function(t2) {
    var e2, r2;
    return g(this, 0, void 0, function() {
      var n2, i2, o2, s2, a2, u2, c2;
      return v(this, function(l2) {
        switch (l2.label) {
          case 0:
            return [4, A.getProfile()];
          case 1:
            return n2 = l2.sent(), A.isSongleUser(n2) ? (A.isSpoofingSongleUser(n2) && (o2 = n2.user, s2 = o2.songleUserId, a2 = o2.songleAccessToken, u2 = o2.songleRefreshToken, i2 = { songleUserId: s2, songleAccessToken: a2, songleRefreshToken: u2 }), [4, b("".concat(this.endpoint, "/songle/me/songs/").concat(t2, ".json"), i2, { withCredentials: true })]) : [2, null];
          case 2:
            return (c2 = l2.sent()) && 200 === c2.status && (null === (r2 = null === (e2 = c2.data) || void 0 === e2 ? void 0 : e2.data) || void 0 === r2 ? void 0 : r2.song) ? [2, c2.data.data.song] : [2, null];
        }
      });
    });
  }, t.prototype.loadInfo = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        return r2 = this.cacheKey(t2, e2), B[r2] || (B[r2] = this.doLoadInfo(t2, { min: true, revisions: null == e2 ? void 0 : e2.revisions })), [2, B[r2]];
      });
    });
  }, t.prototype.loadDetailInfo = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        return r2 = this.cacheKey(t2, e2) + "/dt", B[r2] || (B[r2] = this.doLoadInfo(t2, { min: false, revisions: null == e2 ? void 0 : e2.revisions })), [2, B[r2]];
      });
    });
  }, t.prototype.cacheKey = function(t2, e2) {
    var r2 = String(t2);
    return (null == e2 ? void 0 : e2.revisions) && ("number" == typeof e2.revisions.chord && (r2 += "/cd" + e2.revisions.chord), "number" == typeof e2.revisions.beat && (r2 += "/bt" + e2.revisions.beat), "number" == typeof e2.revisions.chorus && (r2 += "/cr" + e2.revisions.chorus)), r2;
  }, t.prototype.doLoadInfo = function(t2, e2) {
    var r2 = void 0 === e2 ? { min: true } : e2, n2 = r2.min, i2 = r2.revisions;
    return g(this, 0, void 0, function() {
      var e3, r3;
      return v(this, function(o2) {
        switch (o2.label) {
          case 0:
            return e3 = { min: n2 ? 1 : 0 }, "number" == typeof (null == i2 ? void 0 : i2.chord) && (e3.chord_revision_id = i2.chord), "number" == typeof (null == i2 ? void 0 : i2.beat) && (e3.beat_revision_id = i2.beat), "number" == typeof (null == i2 ? void 0 : i2.chorus) && (e3.chorus_revision_id = i2.chorus), [4, b("".concat(this.songleEndpoint, "/songs/").concat(t2, "/info.json"), e3)];
          case 1:
            return (r3 = o2.sent()) && 200 === r3.status ? [2, r3.data] : [2, null];
        }
      });
    });
  }, t.prototype.loadVocalAmplitude = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.songleEndpoint, "/songs/").concat(t2, "/vamplitude.json"))];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status && e2.data ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.loadValenceArousal = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.songleEndpoint, "/songs/").concat(t2, "/av.json"))];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status && e2.data ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.list = function(t2) {
    return void 0 === t2 && (t2 = {}), g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b(this.endpoint + "/songs", t2)];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.listPrivate = function(t2) {
    return void 0 === t2 && (t2 = {}), g(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2;
      return v(this, function(u2) {
        switch (u2.label) {
          case 0:
            return [4, A.getProfile()];
          case 1:
            return e2 = u2.sent(), A.isSongleUser(e2) ? (r2 = {}, A.isSpoofingSongleUser(e2) && (n2 = e2.user, i2 = n2.songleUserId, o2 = n2.songleAccessToken, s2 = n2.songleRefreshToken, r2 = { songleUserId: i2, songleAccessToken: o2, songleRefreshToken: s2 }), "number" == typeof t2.page && (r2.page = t2.page), "number" == typeof t2.perPage && (r2.per_page = t2.perPage), [4, b("".concat(this.endpoint, "/songle/me/songs.json"), y(y({}, r2), { private: true }), { withCredentials: true })]) : [2, { data: null, error: "Songle authentication is required" }];
          case 2:
            return (a2 = u2.sent()) && 200 === a2.status ? [2, a2.data] : [2, { data: null, error: "private songs not found" }];
        }
      });
    });
  }, t.prototype.create = function(t2) {
    return g(this, 0, void 0, function() {
      return v(this, function(e2) {
        return [2, this.doCreate(t2, false)];
      });
    });
  }, t.prototype.createPrivate = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, A.getProfile()];
          case 1:
            return e2 = r2.sent(), A.isSongleUser(e2) ? [2, this.doCreate(t2, true)] : [2, { success: false, song: null, error: "Songle authentication is required" }];
        }
      });
    });
  }, t.prototype.doCreate = function(t2, e2) {
    var r2, n2;
    return g(this, 0, void 0, function() {
      var i2, o2, s2, a2, u2;
      return v(this, function(c2) {
        switch (c2.label) {
          case 0:
            return i2 = t2.url, o2 = t2.name, s2 = t2.artistName, [4, A.getToken()];
          case 1:
            return a2 = c2.sent(), [4, P(e2 ? this.endpoint + "/etc/songs/private" : this.endpoint + "/etc/songs", { url: i2, name: o2, artist: s2 }, { postToken: a2, withCredentials: true })];
          case 2:
            return (u2 = c2.sent()) && 200 === u2.status ? e2 ? [2, { success: true, song: u2.data.data.song }] : [2, { success: true, song: u2.data.song }] : [2, { success: false, error: ((null === (r2 = null == u2 ? void 0 : u2.data) || void 0 === r2 ? void 0 : r2.data) ? u2.data.data.message : null === (n2 = null == u2 ? void 0 : u2.data) || void 0 === n2 ? void 0 : n2.message) || "failed to register a song" }];
        }
      });
    });
  }, t.prototype.uploadPrivate = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2, u2, c2;
      return v(this, function(l2) {
        switch (l2.label) {
          case 0:
            return [4, A.getProfile()];
          case 1:
            if (e2 = l2.sent(), !A.isSongleUser(e2)) throw new Error("Songle authentication is required");
            return A.isSpoofingSongleUser(e2) ? (n2 = e2.user, i2 = n2.songleUserId, o2 = n2.songleAccessToken, s2 = n2.songleRefreshToken, a2 = { songleUserId: i2, songleAccessToken: o2, songleRefreshToken: s2 }, r2 = "?" + Object.keys(a2).map(function(t3) {
              return "".concat(t3, "=").concat(encodeURIComponent(a2[t3]));
            }).join("&")) : r2 = "", (u2 = new FormData()).append("file", t2), [4, P("".concat(this.endpoint, "/songle/me/uploads.json").concat(r2), u2, { withCredentials: true })];
          case 2:
            return (c2 = l2.sent()) && 200 === c2.status && c2.data ? [2, c2.data.data] : [2, null];
        }
      });
    });
  }, t.prototype.search = function(t2, e2) {
    return void 0 === e2 && (e2 = true), g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, b("".concat(this.songleEndpoint, "/songs/search.json"), { q: t2, lyrics: e2 ? 1 : 0 })];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status && r2.data ? [2, { success: true, data: r2.data }] : [2, { success: false }];
        }
      });
    });
  }, t.prototype.copySongMap = function(t2) {
    var e2;
    return g(this, 0, void 0, function() {
      var r2, n2, i2, o2;
      return v(this, function(s2) {
        switch (s2.label) {
          case 0:
            return r2 = t2.sourceId, n2 = t2.destinationId, i2 = t2.types || ["beat", "chord", "chorus", "melody"], [4, P("".concat(this.endpoint, "/songle/me/songs/").concat(n2, "/actions/copy_music_map.json"), { source_id: r2, types: i2 }, { withCredentials: true })];
          case 1:
            return (o2 = s2.sent()) && (null === (e2 = o2.data) || void 0 === e2 ? void 0 : e2.success) ? [2, { success: true }] : [2, { success: false, error: null == o2 ? void 0 : o2.data }];
        }
      });
    });
  }, t.prototype.createStage = function() {
    var t2;
    return g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, A.getProfile()];
          case 1:
            return e2 = n2.sent(), [4, P("".concat(this.endpoint, "/etc/songs/stage"), null, { postToken: null === (t2 = null == e2 ? void 0 : e2.status) || void 0 === t2 ? void 0 : t2.token, withCredentials: true })];
          case 2:
            return [2, (null == (r2 = n2.sent()) ? void 0 : r2.data) || null];
        }
      });
    });
  }, t;
}())();
var G = function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return "".concat(m.textalive.server, "/templates/");
  }, enumerable: false, configurable: true }), t.prototype.list = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.endpoint), t2)];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.load = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.endpoint + t2))];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.loadByName = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2;
      return v(this, function(i2) {
        switch (i2.label) {
          case 0:
            return r2 = "latest", t2 && (e2 = t2.match(/(.+)@([0-9]+)/)) && (t2 = e2[1], r2 = e2[2]), [4, b("".concat(this.endpoint + t2, "/").concat(r2))];
          case 1:
            return (n2 = i2.sent()) && 200 === n2.status ? [2, n2.data] : "latest" !== r2 ? [2, this.loadByName(t2)] : [2, null];
        }
      });
    });
  }, t.prototype.loadForVideo = function(t2, e2) {
    return void 0 === e2 && (e2 = { script: true, withoutAuthors: true }), g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, b("".concat(this.endpoint, "for/").concat(t2), e2)];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status ? [2, r2.data] : [2, null];
        }
      });
    });
  }, t.prototype.create = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2;
      return v(this, function(i2) {
        switch (i2.label) {
          case 0:
            return [4, A.getToken()];
          case 1:
            return e2 = i2.sent(), [4, P(this.endpoint, t2, { postToken: e2, withCredentials: true })];
          case 2:
            return (r2 = i2.sent()) ? 200 !== r2.status || Array.isArray(r2.data) || r2.data.error ? (n2 = Array.isArray(r2.data) ? { parseErrors: r2.data } : r2.data, [2, y(y({}, n2), { success: false })]) : [2, y(y({}, r2.data), { success: true })] : [2, { success: false }];
        }
      });
    });
  }, t.prototype.listContributors = function(t2, e2) {
    return g(this, 0, void 0, function() {
      var r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, b("".concat(this.endpoint).concat(t2, "/").concat(e2, "/contributors"))];
          case 1:
            return (r2 = n2.sent()) && 200 === r2.status ? [2, r2.data] : [2, null];
        }
      });
    });
  }, t;
}();
var q = new G();
var W = new (function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "endpoint", { get: function() {
    return "".concat(m.textalive.server, "/videos/");
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "rendererEndpoint", { get: function() {
    return "".concat(m.textalive.server, "/renderer/");
  }, enumerable: false, configurable: true }), t.prototype.list = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.endpoint), t2)];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.load = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2;
      return v(this, function(u2) {
        switch (u2.label) {
          case 0:
            return e2 = {}, [4, A.getProfile()];
          case 1:
            return r2 = u2.sent(), A.isSpoofingSongleUser(r2) && (n2 = r2.user, i2 = n2.songleUserId, o2 = n2.songleAccessToken, s2 = n2.songleRefreshToken, e2 = { songleUserId: i2, songleAccessToken: o2, songleRefreshToken: s2 }), [4, b("".concat(this.endpoint + t2), e2, { withCredentials: true })];
          case 2:
            return (a2 = u2.sent()) && 200 === a2.status ? [2, a2.data] : [2, null];
        }
      });
    });
  }, t.prototype.create = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, A.getToken()];
          case 1:
            return e2 = n2.sent(), [4, P(this.endpoint, t2, { postToken: e2, withCredentials: true })];
          case 2:
            return (r2 = n2.sent()) ? 200 !== r2.status || r2.data.error ? [2, y(y({}, r2.data), { success: false })] : [2, y(y({}, r2.data), { success: true })] : [2, { success: false }];
        }
      });
    });
  }, t.prototype.delete = function(t2) {
    return g(this, 0, void 0, function() {
      var e2, r2;
      return v(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, A.getToken()];
          case 1:
            return e2 = n2.sent(), [4, P("".concat(this.endpoint, "delete"), { id: t2 }, { postToken: e2, withCredentials: true })];
          case 2:
            return (r2 = n2.sent()) && 200 === r2.status ? [2, { success: true, video: r2.data }] : [2, { success: false, video: null }];
        }
      });
    });
  }, t.prototype.listContributors = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.endpoint).concat(t2, "/contributors"), null, { withCredentials: true })];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.listRenderings = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.rendererEndpoint, "list"), { videoId: t2 }, { withCredentials: true })];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.getRenderingStatus = function(t2) {
    return g(this, 0, void 0, function() {
      var e2;
      return v(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, b("".concat(this.rendererEndpoint, "status"), { id: t2 }, { withCredentials: true })];
          case 1:
            return (e2 = r2.sent()) && 200 === e2.status ? [2, e2.data] : [2, null];
        }
      });
    });
  }, t.prototype.render = function(t2, e2, r2) {
    return g(this, 0, void 0, function() {
      var n2, i2, o2;
      return v(this, function(s2) {
        switch (s2.label) {
          case 0:
            return [4, A.getToken()];
          case 1:
            return n2 = s2.sent(), i2 = { token: n2, videoId: t2, quality: e2 }, r2 && (i2.authentication = true), [4, P("".concat(this.rendererEndpoint, "render"), i2, { withCredentials: true })];
          case 2:
            return (o2 = s2.sent()) && 200 === o2.status ? [2, o2.data] : [2, null];
        }
      });
    });
  }, t.prototype.getDownloadInfo = function() {
    return g(this, 0, void 0, function() {
      var t2;
      return v(this, function(e2) {
        switch (e2.label) {
          case 0:
            return t2 = { endpoint: "".concat(this.rendererEndpoint, "download") }, [4, A.getToken()];
          case 1:
            return [2, (t2.token = e2.sent(), t2)];
        }
      });
    });
  }, t;
}())();
var Y = { asset: w, endpoint: m, lyrics: D, song: V, template: q, text: R, font: C, user: A, video: W };
var z = function(t, e2) {
  return z = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t2, e3) {
    t2.__proto__ = e3;
  } || function(t2, e3) {
    for (var r2 in e3) Object.prototype.hasOwnProperty.call(e3, r2) && (t2[r2] = e3[r2]);
  }, z(t, e2);
};
function J(t, e2) {
  if ("function" != typeof e2 && null !== e2) throw new TypeError("Class extends value " + String(e2) + " is not a constructor or null");
  function r2() {
    this.constructor = t;
  }
  z(t, e2), t.prototype = null === e2 ? Object.create(e2) : (r2.prototype = e2.prototype, new r2());
}
function H(t, e2, r2) {
  if (2 === arguments.length) for (var n2, i2 = 0, o2 = e2.length; i2 < o2; i2++) !n2 && i2 in e2 || (n2 || (n2 = Array.prototype.slice.call(e2, 0, i2)), n2[i2] = e2[i2]);
  return t.concat(n2 || Array.prototype.slice.call(e2));
}
var X = function() {
  function t(t2) {
    this.a = 0, this.r = 0, this.g = 0, this.b = 0, this.from(t2);
  }
  return Object.defineProperty(t.prototype, "value", { get: function() {
    return this.valueArgb;
  }, set: function(t2) {
    this.fromNumber(t2, true);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "valueArgb", { get: function() {
    return this.valueRgb + 16777216 * (255 & this.a);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "valueRgb", { get: function() {
    return ((255 & this.r) << 8 | 255 & this.g) << 8 | 255 & this.b;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "hexRgb", { get: function() {
    return ("000000" + (16777215 & this.value).toString(16)).slice(-6);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "hexA", { get: function() {
    return ("00" + (255 & this.a).toString(16)).slice(-2);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "rgb", { get: function() {
    return "#".concat(this.hexRgb);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "cssRgb", { get: function() {
    return "rgb(" + this.r + "," + this.g + "," + this.b + ")";
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "rgba", { get: function() {
    return "".concat(this.rgb).concat(this.hexA);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "argb", { get: function() {
    return "0x".concat(this.hexA).concat(this.rgb.substring(1));
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "cssRgba", { get: function() {
    return "rgba(" + this.r + "," + this.g + "," + this.b + "," + this.a / 255 + ")";
  }, enumerable: false, configurable: true }), t.prototype.eq = function(e2) {
    return typeof this == typeof e2 && e2 instanceof t && this.value === e2.value;
  }, t.prototype.toString = function(t2) {
    return void 0 === t2 && (t2 = true), t2 ? this.rgba : this.rgb;
  }, t.prototype.from = function(t2) {
    if (void 0 === t2 && (t2 = "#000"), "object" == typeof t2) {
      if (!t2) return;
      return "number" == typeof t2.value ? void (this.value = t2.value) : "number" == typeof t2.r && "number" == typeof t2.g && "number" == typeof t2.b ? (this.a = "number" == typeof t2.a ? t2.a : 255, this.r = t2.r, this.g = t2.g, void (this.b = t2.b)) : void 0;
    }
    "string" == typeof t2 ? this.fromString(t2) : "number" == typeof t2 && this.fromNumber(t2);
  }, t.prototype.fromString = function(t2) {
    if (t2) {
      if ("#" === t2.charAt(0) && (t2 = t2.substring(1)), 4 === t2.length) {
        var e2 = t2.charAt(0), r2 = t2.charAt(1), n2 = t2.charAt(2), i2 = t2.charAt(3);
        t2 = "".concat(e2).concat(e2).concat(r2).concat(r2).concat(n2).concat(n2).concat(i2).concat(i2);
      } else 3 === t2.length && (e2 = t2.charAt(0), r2 = t2.charAt(1), n2 = t2.charAt(2), t2 = "".concat(e2).concat(e2).concat(r2).concat(r2).concat(n2).concat(n2)), 6 === t2.length && (t2 = "".concat(t2, "ff"));
      var o2 = parseInt("".concat(t2.substring(6)).concat(t2.substring(0, 6)), 16);
      this.fromNumber(o2, true);
    }
  }, t.prototype.fromNumber = function(t2, e2) {
    void 0 === e2 && (e2 = true), isNaN(t2) || (this.a = e2 ? t2 >>> 24 & 255 : 0, this.r = t2 >>> 16 & 255, this.g = t2 >>> 8 & 255, this.b = t2 >>> 0 & 255);
  }, t;
}();
var Z = function() {
  function t(t2, e2, r2) {
    void 0 === t2 && (t2 = "Noto Sans Japanese"), void 0 === e2 && (e2 = 40), void 0 === r2 && (r2 = ""), this._family = t2, this._size = e2, this._style = r2;
  }
  return Object.defineProperty(t.prototype, "family", { get: function() {
    return this._family;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "size", { get: function() {
    return this._size;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "style", { get: function() {
    return this._style;
  }, enumerable: false, configurable: true }), t.prototype.deriveFamily = function(e2) {
    return new t(e2, this._size, this._style);
  }, t.prototype.deriveStyle = function(e2) {
    return new t(this._family, this._size, e2);
  }, t.prototype.deriveSize = function(e2) {
    return new t(this._family, e2, this._style);
  }, t.prototype.clone = function() {
    return new t(this._family, this._size, this._style);
  }, t.prototype.eq = function(t2) {
    return this._family === t2._family && this._size === t2._size && this._style === t2._style;
  }, t.prototype.toString = function(t2) {
    void 0 === t2 && (t2 = 1);
    var e2, r2 = function(t3) {
      if (!t3 || t3.length <= 0) return [];
      for (var e3 = [], r3 = "", n2 = false, i2 = false, o2 = false, s2 = 0, a2 = t3; s2 < a2.length; s2++) {
        var u2 = a2[s2];
        if (i2 ? o2 ? o2 = false : "\\" === u2 ? o2 = true : u2 === i2 && (i2 = false) : '"' === u2 || "'" === u2 ? i2 = u2 : "," === u2 && (n2 = true), n2) {
          var c2 = r3.trim();
          "" !== c2 && e3.push(c2), r3 = "", n2 = false;
        } else r3 += u2;
      }
      var l2 = r3.trim();
      return "" !== l2 && e3.push(l2), e3;
    }(this._family);
    return e2 = r2.length < 1 ? "" : r2.length > 1 ? " " + r2.join(", ") : (e2 = r2[0]).length > 1 && e2[0] !== e2[e2.length - 1] || "'" !== e2[0] && '"' !== e2[0] ? " '".concat(e2, "'") : " ".concat(e2), this._style + (this._style.length > 0 ? " " : "") + this._size * t2 + "px" + e2;
  }, t;
}();
var $ = function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "duration", { get: function() {
    return this.endTime - this.startTime;
  }, enumerable: false, configurable: true }), t.prototype.contains = function(t2) {
    return t2 >= this.startTime && t2 <= this.endTime;
  }, t.prototype.overlaps = function(t2, e2) {
    if ("object" == typeof t2) return this.overlaps(t2.startTime, t2.endTime);
    var r2 = t2;
    return this.contains(r2) || this.contains(e2) || this.startTime <= r2 && this.endTime >= e2;
  }, t.prototype.progress = function(t2) {
    return this.contains(t2) ? (t2 - this.startTime) / this.duration : -1;
  }, t;
}();
var K = function(t) {
  function e2() {
    var e3 = null !== t && t.apply(this, arguments) || this;
    return e3._parent = null, e3._children = [], e3._previous = null, e3._next = null, e3._runtime = null, e3._templates = [], e3;
  }
  return J(e2, t), Object.defineProperty(e2.prototype, "video", { get: function() {
    return this.parent && this.parent.video;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "parent", { get: function() {
    return this._parent;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "children", { get: function() {
    return this._children;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "previous", { get: function() {
    return this._previous;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "next", { get: function() {
    return this._next;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "startTime", { get: function() {
    return this._data ? this._data.startTime : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "endTime", { get: function() {
    return this._data ? this._data.endTime : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "duration", { get: function() {
    return this.endTime - this.startTime;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "rendering", { get: function() {
    return this._runtime ? this._runtime.rendering : null;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "graphics", { get: function() {
    return this._runtime ? this._runtime.graphics : null;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "templates", { get: function() {
    return this._templates.slice();
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "templateCount", { get: function() {
    return this._templates.length;
  }, enumerable: false, configurable: true }), e2.prototype.maximize = function() {
    var t2 = false, e3 = this.endTime, r2 = Math.max(null === this._parent ? 0 : this._parent.startTime, null === this._previous ? 0 : this._previous.endTime);
    r2 !== this.startTime && (this.moveWithChildren(r2 - this.startTime), t2 = true);
    var n2 = Math.min(null === this._parent ? this.video.duration : this._parent.endTime, null === this._next ? this.video.duration : this._next.startTime);
    return n2 !== this.endTime && (this._data.endTime = n2, t2 = e3 !== n2), t2;
  }, e2.prototype.moveWithChildren = function(t2) {
    var e3 = [];
    for (e3.push(this); e3.length > 0; ) {
      var r2 = e3.pop();
      null != r2._children && r2._children.forEach(function(t3) {
        return e3.push(t3);
      }), r2._data.startTime += t2, r2._data.endTime += t2;
    }
  }, e2.prototype.getTemplate = function(t2) {
    return void 0 === t2 && (t2 = 0), t2 < 0 || t2 >= this._templates.length ? null : this._templates[t2];
  }, e2.prototype.addTemplateAt = function(t2, e3) {
    this._templates.splice(e3, 0, t2), t2.assignedUnit = this;
  }, e2.prototype.addTemplate = function(t2) {
    this._templates.push(t2), t2.assignedUnit = this;
  }, e2.prototype.removeTemplates = function() {
    for (var t2 = this._templates.slice(); this._templates.length > 0; ) this._templates.pop();
    return t2;
  }, e2.prototype.removeTemplateAt = function(t2) {
    if (t2 < 0 || t2 >= this._templates.length) return null;
    var e3 = this._templates.splice(t2, 1)[0];
    return e3.assignedUnit = null, e3;
  }, e2.prototype.removeTemplate = function(t2) {
    for (var e3 = 0; e3 < this._templates.length; e3++) {
      var r2 = this._templates[e3];
      if (r2 === t2) return this._templates.splice(e3, 1), t2.assignedUnit = null, r2;
    }
    return null;
  }, e2.prototype.getType = function() {
    return n.NONE;
  }, e2.prototype.toString = function() {
    return "RenderingUnit";
  }, e2;
}($);
function Q(t, e2) {
  return "number" == typeof e2 && !isNaN(e2) && e2 > t ? e2 : t;
}
function tt(t, e2) {
  return "number" == typeof e2 && !isNaN(e2) && e2 < t ? e2 : t;
}
var et = function(t) {
  function e2() {
    return null !== t && t.apply(this, arguments) || this;
  }
  return J(e2, t), Object.defineProperty(e2.prototype, "text", { get: function() {
    var t2 = "";
    return this.children.forEach(function(e3) {
      t2 += e3.text;
    }), t2;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "color", { get: function() {
    return this.children.reduce(function(t2, e3) {
      return null === t2 ? e3.color : void 0 === t2 || t2.eq(e3.color) ? t2 : void 0;
    }, null);
  }, set: function(t2) {
    null !== t2 && this.children.forEach(function(e3) {
      e3.color = t2;
    });
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "font", { set: function(t2) {
    null !== t2 && this.children.forEach(function(e3) {
      e3.font = t2;
    });
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "fontFamily", { get: function() {
    return this.children.reduce(function(t2, e3) {
      var r2 = e3.fontFamily;
      return void 0 === t2 || null !== t2 && t2 !== r2 ? void 0 : r2;
    }, null);
  }, set: function(t2) {
    this.children.forEach(function(e3) {
      e3.fontFamily = t2;
    });
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "fontStyle", { get: function() {
    return this.children.reduce(function(t2, e3) {
      var r2 = e3.fontStyle;
      return void 0 === t2 || null !== t2 && t2 !== r2 ? void 0 : r2;
    }, null);
  }, set: function(t2) {
    this.children.forEach(function(e3) {
      e3.fontStyle = t2;
    });
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "fontSize", { get: function() {
    return this.children.length <= 0 ? 0 : this.children.reduce(function(t2, e3) {
      return t2 + e3.fontSize;
    }, 0) / this.children.length;
  }, set: function(t2) {
    this.children.forEach(function(e3) {
      e3.fontSize = t2;
    });
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "advance", { get: function() {
    return this.children.reduce(function(t2, e3) {
      return t2 + e3.advance;
    }, 0);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "ascent", { get: function() {
    return this.children.reduce(function(t2, e3) {
      return Math.max(t2, e3.ascent);
    }, 0);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "descent", { get: function() {
    return this.children.reduce(function(t2, e3) {
      return Math.max(t2, e3.descent);
    }, 0);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "height", { get: function() {
    return this.ascent + this.descent;
  }, enumerable: false, configurable: true }), e2.prototype.expandTime = function(t2) {
    return { startTime: tt(this.startTime, t2.startTime), endTime: Q(this.endTime, t2.endTime) };
  }, e2.prototype.toString = function() {
    return this.text;
  }, e2;
}(K);
var rt = function(t) {
  function e2(e3) {
    var r2 = t.call(this) || this;
    return r2._data = e3, r2._font = new Z(e3 && e3.fontFamily, e3 && e3.fontSize, e3 && e3.fontStyle), r2._color = new X(), r2;
  }
  return J(e2, t), Object.defineProperty(e2.prototype, "parent", { get: function() {
    return this._parent;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "previous", { get: function() {
    return this._previous;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "next", { get: function() {
    return this._next;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "text", { get: function() {
    return this._data && this._data.char || "?";
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "advance", { get: function() {
    return this._runtime ? this._runtime.advance : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "ascent", { get: function() {
    return this._runtime ? this._runtime.ascent : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "descent", { get: function() {
    return this._runtime ? this._runtime.descent : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "font", { get: function() {
    return this._font;
  }, set: function(t2) {
    null === t2 || this.font.eq(t2) || (this._font = t2.clone(), this._data.fontFamily = t2.family, this._data.fontSize = t2.size, this._data.fontStyle = t2.style, this._runtime && this._runtime.onFontUpdate(this.font));
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "fontFamily", { get: function() {
    return this.font.family;
  }, set: function(t2) {
    this.font.family !== t2 && (this._font = this.font.deriveFamily(t2), this._data.fontFamily = t2, this._runtime && this._runtime.onFontUpdate(this.font));
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "fontStyle", { get: function() {
    return this.font.style;
  }, set: function(t2) {
    this.font.style !== t2 && (this._font = this.font.deriveStyle(t2), this._data.fontStyle = t2, this._runtime && this._runtime.onFontUpdate(this.font));
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "fontSize", { get: function() {
    return this.font.size;
  }, set: function(t2) {
    isNaN(t2) || this.font.size === t2 || (this._font = this.font.deriveSize(t2), this._data.fontSize = t2, this._runtime && this._runtime.onFontUpdate(this.font));
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "color", { get: function() {
    return this._color;
  }, set: function(t2) {
    t2 && !t2.eq(this.color) && (this._color = t2, this._runtime && this._runtime.onColorUpdate(t2));
  }, enumerable: false, configurable: true }), e2.prototype.getType = function() {
    return n.CHAR;
  }, e2;
}(et);
var nt = function(t) {
  function e2(e3) {
    var r2 = t.call(this) || this;
    return r2._data = e3, r2;
  }
  return J(e2, t), e2.prototype.getType = function() {
    return n.GRAPHIC;
  }, e2.prototype.toString = function() {
    return "Graphic";
  }, e2;
}(K);
var it = function(t) {
  function e2(e3) {
    var r2 = t.call(this) || this;
    return r2._data = e3, r2;
  }
  return J(e2, t), Object.defineProperty(e2.prototype, "parent", { get: function() {
    return this._parent;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "children", { get: function() {
    return this._children.slice();
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "previous", { get: function() {
    return this._previous;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "next", { get: function() {
    return this._next;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "startTime", { get: function() {
    return this.firstChar ? this.firstChar.startTime : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "endTime", { get: function() {
    return this.lastChar ? this.lastChar.endTime : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "pos", { get: function() {
    return this._data && this._data.pos || "";
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "rawPos", { get: function() {
    return this._data && this._data.rawPoS || "";
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "language", { get: function() {
    return this._data && this._data.language || "";
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "countDown", { get: function() {
    return this._data ? this._data.countDown : -1;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "countUp", { get: function() {
    return this._data ? this._data.countUp : -1;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "initialCount", { get: function() {
    return this._data ? this._data.initialCount : -1;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "charCount", { get: function() {
    return this._children.length;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstChar", { get: function() {
    return this._children.length <= 0 ? null : this._children[0];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastChar", { get: function() {
    return this._children.length <= 0 ? null : this._children[this._children.length - 1];
  }, enumerable: false, configurable: true }), e2.prototype.addChar = function(t2) {
    if (t2) {
      this._children.length > 0 && (t2._previous = this.lastChar, this.lastChar._next = t2), this._children.push(t2), t2._parent = this;
      var e3 = this.expandTime(t2), r2 = e3.startTime, n2 = e3.endTime;
      this._data.startTime = r2, this._data.endTime = n2;
    }
  }, e2.prototype.findIndex = function(t2) {
    return t2 instanceof rt ? this._children.indexOf(t2) : -1;
  }, e2.prototype.getType = function() {
    return n.WORD;
  }, e2;
}(et);
var ot = function(t) {
  function e2(e3, r2) {
    var n2 = t.call(this) || this;
    return n2._video = e3, n2._data = r2, n2.createUnits(), n2;
  }
  return J(e2, t), e2.prototype.createUnits = function() {
    var t2 = this, e3 = this._data;
    e3 && Array.isArray(e3.words) && e3.words.forEach(function(e4) {
      if (e4) {
        var r2 = new it(e4);
        Array.isArray(e4.characters) && e4.characters.forEach(function(t3) {
          return r2.addChar(new rt(t3));
        }), t2.addWord(r2);
      }
    });
  }, Object.defineProperty(e2.prototype, "children", { get: function() {
    return this._children.slice();
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "previous", { get: function() {
    return this._previous;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "next", { get: function() {
    return this._next;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "video", { get: function() {
    return this._video;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "startTime", { get: function() {
    return this.firstChar ? this.firstChar.startTime : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "endTime", { get: function() {
    return this.lastChar ? this.lastChar.endTime : 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "wordCount", { get: function() {
    return this._children.length;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "charCount", { get: function() {
    return this._children.reduce(function(t2, e3) {
      return t2 + e3.charCount;
    }, 0);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstWord", { get: function() {
    return this._children.length <= 0 ? null : this._children[0];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastWord", { get: function() {
    return this._children.length <= 0 ? null : this._children[this._children.length - 1];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstChar", { get: function() {
    var t2 = this.firstWord;
    return null === t2 ? null : t2.firstChar;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastChar", { get: function() {
    var t2 = this.lastWord;
    return null === t2 ? null : t2.lastChar;
  }, enumerable: false, configurable: true }), e2.prototype.getWord = function(t2) {
    return t2 < 0 || t2 >= this._children.length ? null : this._children[t2];
  }, e2.prototype.getChar = function(t2) {
    if (t2 < 0) return null;
    for (var e3 = 0, r2 = this.firstWord; ; ) {
      if (!r2) return null;
      if (e3 + r2.children.length > t2) break;
      e3 += r2.children.length, r2 = r2.next;
    }
    return r2.children[t2 - e3];
  }, e2.prototype.addWord = function(t2) {
    if (t2) {
      this._children.length > 0 && (t2._previous = this.lastWord, t2._previous._next = t2, t2.firstChar._previous = t2._previous.lastChar, t2._previous.lastChar._next = t2.firstChar), this._children.push(t2), t2._parent = this;
      var e3 = this.expandTime(t2), r2 = e3.startTime, n2 = e3.endTime;
      this._data.startTime = r2, this._data.endTime = n2;
    }
  }, e2.prototype.findIndex = function(t2) {
    if (t2 instanceof it) return this._children.indexOf(t2);
    if (t2 instanceof rt) {
      for (var e3 = 0, r2 = false, n2 = 0, i2 = this._children; n2 < i2.length; n2++) {
        var o2 = i2[n2], s2 = o2.findIndex(t2);
        if (!(s2 < 0)) {
          e3 += s2, r2 = true;
          break;
        }
        e3 += o2.charCount;
      }
      return r2 ? e3 : -1;
    }
    return -1;
  }, e2.prototype.getType = function() {
    return n.PHRASE;
  }, e2;
}(et);
function st(t, e2, n2) {
  if (!t || t.length <= 0) return null;
  var i2 = r.sortedIndex(t, e2, function(t2) {
    return t2.endTime;
  });
  if (i2 < 0) return null;
  if (n2 && "endTime" in n2 && "number" == typeof n2.endTime) {
    i2 >= t.length && (i2 = t.length - 1);
    var o2 = e2, s2 = n2.endTime;
    return t[i2].overlaps(o2, s2) ? t[i2] : i2 < 1 ? null : t[i2 - 1].overlaps(o2, s2) ? t[i2 - 1] : null;
  }
  return i2 >= t.length ? null : n2 && "loose" in n2 && n2.loose || t[i2].contains(e2) ? t[i2] : null;
}
function at(t, e2, n2) {
  if (!t || t.length <= 0) return { current: null, entered: [], left: [], previous: null, next: null };
  var i2 = r.sortedIndex(t, e2, function(t2) {
    return t2.startTime;
  });
  i2 < t.length && t[i2].startTime === e2 && i2++;
  var o2, s2, a2, u2 = i2 - 1 < 0 ? -1 : t[i2 - 1].startTime <= e2 && t[i2 - 1].endTime > e2 ? i2 - 2 : i2 - 1, c2 = r.sortedIndex(t, n2, function(t2) {
    return t2.endTime;
  });
  c2 >= t.length ? (o2 = -1, s2 = -1, a2 = t[c2 - 1].endTime > e2 ? t.length : 0) : (t[c2].startTime > n2 ? (o2 = -1, s2 = c2) : c2 + 1 >= t.length || t[c2 + 1].startTime > n2 ? (o2 = t[c2].endTime > n2 && t[c2].startTime <= n2 ? c2 : -1, s2 = c2 + 1) : (o2 = c2 + 1, s2 = c2 + 2), a2 = t[c2].endTime <= n2 ? c2 + 1 : c2);
  var l2 = u2 >= 0 ? t[u2] : null, p2 = s2 >= 0 && s2 < t.length ? t[s2] : null;
  return { current: o2 >= 0 ? t[o2] : null, entered: t.slice(i2, s2), left: t.slice(u2 + 1, a2), previous: l2, next: p2 };
}
var ut = function(t) {
  function e2(e3) {
    var r2 = t.call(this) || this;
    return r2._credits = [], r2._phrases = [], r2._graphics = [], r2.data = e3 || {}, r2.createUnits(), r2;
  }
  return J(e2, t), Object.defineProperty(e2.prototype, "credits", { get: function() {
    return this._credits.slice();
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "phrases", { get: function() {
    return this._phrases.slice();
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "words", { get: function() {
    return this._phrases.reduce(function(t2, e3) {
      return t2.splice.apply(t2, H([t2.length, 0], e3._children, false)), t2;
    }, []);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "chars", { get: function() {
    return this.words.reduce(function(t2, e3) {
      return t2.splice.apply(t2, H([t2.length, 0], e3._children, false)), t2;
    }, []);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "graphics", { get: function() {
    return this._graphics.slice();
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "rendering", { get: function() {
    return this._runtime.rendering;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "duration", { get: function() {
    return this.data.duration || 0;
  }, set: function(t2) {
    this.data.duration = t2;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "startTime", { get: function() {
    return this.data.startTime || 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "endTime", { get: function() {
    return this.data.endTime || 0;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "creditCount", { get: function() {
    return this._credits.length;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "phraseCount", { get: function() {
    return this._phrases.length;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "graphicCount", { get: function() {
    return this._graphics.length;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "wordCount", { get: function() {
    return this._phrases.reduce(function(t2, e3) {
      return t2 + e3.wordCount;
    }, 0);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "charCount", { get: function() {
    return this._phrases.reduce(function(t2, e3) {
      return t2 + e3.charCount;
    }, 0);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstCredit", { get: function() {
    return this._credits.length <= 0 ? null : this._credits[0];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastCredit", { get: function() {
    return this._credits.length <= 0 ? null : this._credits[this._credits.length - 1];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstPhrase", { get: function() {
    return this._phrases.length <= 0 ? null : this._phrases[0];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastPhrase", { get: function() {
    return this._phrases.length <= 0 ? null : this._phrases[this._phrases.length - 1];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstWord", { get: function() {
    var t2;
    return (null === (t2 = this.firstPhrase) || void 0 === t2 ? void 0 : t2.firstWord) || null;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastWord", { get: function() {
    var t2;
    return (null === (t2 = this.lastPhrase) || void 0 === t2 ? void 0 : t2.lastWord) || null;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstChar", { get: function() {
    var t2;
    return (null === (t2 = this.firstWord) || void 0 === t2 ? void 0 : t2.firstChar) || null;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastChar", { get: function() {
    var t2;
    return (null === (t2 = this.lastWord) || void 0 === t2 ? void 0 : t2.lastChar) || null;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "firstGraphic", { get: function() {
    return this._graphics.length <= 0 ? null : this._graphics[0];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "lastGraphic", { get: function() {
    return this._graphics.length <= 0 ? null : this._graphics[this._graphics.length - 1];
  }, enumerable: false, configurable: true }), e2.prototype.createUnits = function() {
    var t2, e3, r2 = this;
    Array.isArray(this.data.credits) ? (this.data.credits.sort(ct), this.data.credits.forEach(function(t3) {
      return r2.doAddCredit(new ot(r2, t3), false);
    }), this.organizeTimings(null === (t2 = this.firstCredit) || void 0 === t2 ? void 0 : t2.firstChar)) : this.data.credits = [], Array.isArray(this.data.phrases) ? (this.data.phrases.sort(ct), this.data.phrases.forEach(function(t3) {
      return r2.doAddPhrase(new ot(r2, t3), false);
    }), this.organizeTimings(null === (e3 = this.firstPhrase) || void 0 === e3 ? void 0 : e3.firstChar)) : this.data.phrases = [], Array.isArray(this.data.graphics) ? (this.data.graphics.sort(ct), this.data.graphics.forEach(function(t3) {
      return r2.doAddGraphic(new nt(t3), false);
    })) : this.data.graphics = [];
  }, e2.prototype.organizeTimings = function(t2) {
    for (; t2; ) t2.startTime === t2.endTime && t2.maximize(), t2 = t2.next;
  }, e2.prototype.exportData = function(t2) {
    this.updateTemplateData(t2);
    for (var r2 = e2.exportUnitData(this.data.credits, true), n2 = r2.units, i2 = r2.templateClasses, o2 = e2.exportUnitData(this.data.phrases, false), s2 = o2.units, a2 = o2.templateClasses, u2 = e2.exportUnitData(this.data.graphics, true), c2 = u2.units, l2 = u2.templateClasses, p2 = i2.concat(a2, l2).filter(function(t3, e3, r3) {
      return r3.indexOf(t3) === e3;
    }), h2 = {}; p2.length > 0; ) {
      var d2 = p2.shift(), f2 = t2.getByName(d2);
      if (f2) {
        h2[d2] = f2.id;
        for (var y2 = 0, g2 = t2.getRequiredTemplates(f2.script); y2 < g2.length; y2++) {
          var v2 = g2[y2];
          h2[v2] || p2.push(v2);
        }
      } else console.log("template class not found", d2);
    }
    return { credits: n2, phrases: s2, graphics: c2, templateClasses: h2 };
  }, e2.exportUnitData = function(t2, r2) {
    if (void 0 === r2 && (r2 = false), !t2) return { units: [], templateClasses: [] };
    for (var n2 = [], i2 = [], o2 = 0, s2 = t2; o2 < s2.length; o2++) {
      var a2 = s2[o2], u2 = { templates: a2.templates ? a2.templates.map(function(t3) {
        var e3 = t3.type;
        i2.push(e3);
        var r3 = {};
        return Object.keys(t3.value).forEach(function(e4) {
          var n3 = t3.value[e4];
          r3[e4] = "object" == typeof n3 ? Object.assign({}, n3) : n3;
        }), { type: e3, value: r3 };
      }) : [] }, c2 = void 0;
      if (a2.words) {
        var l2 = a2, p2 = e2.exportUnitData(l2.words);
        u2.words = p2.units, c2 = p2.templateClasses;
      } else if (a2.characters) {
        var h2 = a2, d2 = e2.exportUnitData(h2.characters);
        u2.characters = d2.units, c2 = d2.templateClasses;
      } else {
        for (var f2 = 0, y2 = ["fontFamily", "fontSize", "fontStyle"]; f2 < y2.length; f2++) {
          var g2 = y2[f2];
          a2[g2] && (u2[g2] = a2[g2]);
        }
        c2 = [];
      }
      r2 && (u2.startTime = a2.startTime, u2.endTime = a2.endTime), n2.push(u2), i2 = i2.concat(c2);
    }
    return { units: n2, templateClasses: i2 = i2.filter(function(t3, e3, r3) {
      return r3.indexOf(t3) === e3;
    }) };
  }, e2.prototype.updateTemplateData = function(t2) {
    e2.updateTemplateDataForUnits(t2, this.firstCredit, this.data.credits), e2.updateTemplateDataForUnits(t2, this.firstPhrase, this.data.phrases), e2.updateTemplateDataForUnits(t2, this.firstGraphic, this.data.graphics);
  }, e2.updateTemplateDataForUnits = function(t2, r2, n2) {
    if (r2 && n2) for (var i2 = 0, o2 = n2; i2 < o2.length; i2++) {
      var s2 = o2[i2];
      s2.templates = [];
      for (var a2 = 0; a2 < r2.templateCount; a2++) {
        var u2 = r2.getTemplate(a2), c2 = t2.exportInstance(u2);
        s2.templates.push(c2);
      }
      if (s2.words) {
        var l2 = s2;
        e2.updateTemplateDataForUnits(t2, r2.children[0], l2.words);
      } else if (s2.characters) {
        var p2 = s2;
        e2.updateTemplateDataForUnits(t2, r2.children[0], p2.characters);
      }
      r2 = r2.next;
    }
  }, e2.prototype.addCredit = function(t2) {
    this.doAddCredit(t2, true);
  }, e2.prototype.doAddCredit = function(t2, e3) {
    var r2 = this.addRenderingUnit(this._credits, t2);
    e3 && this.data.credits.splice(r2, 0, t2._data), this._runtime && this._runtime.addCredit(t2);
  }, e2.prototype.addPhrase = function(t2) {
    this.doAddPhrase(t2, true);
  }, e2.prototype.doAddPhrase = function(t2, e3) {
    var r2 = this.addRenderingUnit(this._phrases, t2);
    e3 && this.data.phrases.splice(r2, 0, t2._data), this._runtime && this._runtime.addPhrase(t2);
  }, e2.prototype.addGraphic = function(t2) {
    this.doAddGraphic(t2, true);
  }, e2.prototype.doAddGraphic = function(t2, e3) {
    if (t2) {
      var r2 = this.addRenderingUnit(this._graphics, t2);
      e3 && this.data.graphics.splice(r2, 0, t2._data), this._runtime && this._runtime.addGraphic(t2);
    }
  }, e2.prototype.addRenderingUnit = function(t2, e3) {
    if (e3) {
      var n2 = r.sortedIndex(t2, e3, lt), i2 = n2 > 0 ? t2[n2 - 1] : null, o2 = n2 < t2.length ? t2[n2] : null;
      if (t2.splice(n2, 0, e3), i2 && (e3._previous = i2, e3._previous._next = e3), o2 && (o2._previous = e3, e3._next = o2), e3 instanceof ot && e3.wordCount > 0) {
        for (var s2 = i2; s2 && !s2.lastWord; ) s2 = s2.previous;
        for (var a2 = o2; a2 && !a2.firstWord; ) a2 = a2.next;
        if (s2 && (e3.firstWord._previous = s2.lastWord, s2.lastWord._next = e3.firstWord), a2 && (e3.lastWord._next = a2.firstWord, a2.firstWord._previous = e3.lastWord), e3.charCount > 0) {
          for (var u2 = null == s2 ? void 0 : s2.lastWord; u2 && null === u2.lastChar; ) u2 = u2.previous;
          for (var c2 = null == a2 ? void 0 : a2.firstWord; c2 && null === c2.firstChar; ) c2 = c2.next;
          u2 && (e3.firstChar._previous = u2.lastChar, u2.lastChar._next = e3.firstChar), c2 && (e3.lastChar._next = c2.firstChar, c2.firstChar._previous = e3.lastChar);
        }
      }
      return this.updateStartAndEndTime(), n2;
    }
  }, e2.prototype.removeCredit = function(t2) {
    var e3 = this.removeRenderingUnit(this._credits, t2);
    return !(e3 < 0 || (this.data.credits.splice(e3, 1), this._runtime && this._runtime.removeCredit(t2), 0));
  }, e2.prototype.removeCredits = function() {
    var t2 = this;
    this._runtime && this._credits.forEach(function(e3) {
      return t2._runtime.removeCredit(e3);
    }), this._credits = [], this.data.credits.splice(0, this.data.credits.length);
  }, e2.prototype.removePhrase = function(t2) {
    var e3 = this.removeRenderingUnit(this._phrases, t2);
    return !(e3 < 0 || (this.data.phrases.splice(e3, 1), this._runtime && this._runtime.removePhrase(t2), 0));
  }, e2.prototype.removePhrases = function() {
    var t2 = this;
    this._runtime && this._phrases.forEach(function(e3) {
      return t2._runtime.removePhrase(e3);
    }), this._phrases = [], this.data.phrases.splice(0, this.data.phrases.length);
  }, e2.prototype.removeGraphic = function(t2) {
    var e3 = this.removeRenderingUnit(this._graphics, t2);
    return !(e3 < 0 || (this.data.graphics.splice(e3, 1), this._runtime && this._runtime.removeGraphic(t2), 0));
  }, e2.prototype.removeGraphics = function() {
    var t2 = this;
    this._runtime && this._graphics.forEach(function(e3) {
      return t2._runtime.removeGraphic(e3);
    }), this._graphics = [], this.data.graphics.splice(0, this.data.graphics.length), this.rendering.reset();
  }, e2.prototype.removeRenderingUnit = function(t2, e3) {
    var n2 = r.sortedIndex(t2, e3, lt);
    if (n2 < 0 || t2[n2] !== e3) return -1;
    if (t2.splice(n2, 1), e3 instanceof ot) {
      if (e3.charCount > 0) {
        for (var i2 = e3._previous; i2 && null === i2.lastChar; ) i2 = i2.previous;
        for (var o2 = e3._next; o2 && null === o2.firstChar; ) o2 = o2.next;
        i2 && o2 ? (i2.lastChar._next = o2.firstChar, o2.firstChar._previous = i2.lastChar) : i2 ? i2.lastChar._next = null : o2 && (o2.firstChar._previous = null);
      }
      if (e3.wordCount > 0) {
        for (i2 = e3._previous; i2 && null === i2.lastWord; ) i2 = i2.previous;
        for (o2 = e3._next; o2 && null === o2.firstWord; ) o2 = o2.next;
        i2 && o2 ? (i2.lastWord._next = o2.firstWord, o2.firstWord._previous = i2.lastWord) : i2 ? i2.lastWord._next = null : o2 && (o2.firstWord._previous = null);
      }
    }
    e3._previous && (e3._previous._next = e3._next), e3._next && (e3._next._previous = e3._previous), this.updateStartAndEndTime();
  }, e2.prototype.updateStartAndEndTime = function() {
    var t2, e3, r2, n2, i2, o2, s2, a2;
    this.data.endTime = Math.max((null === (e3 = null === (t2 = this.lastCredit) || void 0 === t2 ? void 0 : t2.lastChar) || void 0 === e3 ? void 0 : e3.endTime) || 0, (null === (r2 = this.lastChar) || void 0 === r2 ? void 0 : r2.endTime) || 0, (null === (n2 = this.lastGraphic) || void 0 === n2 ? void 0 : n2.endTime) || 0);
    var u2 = null === (o2 = null === (i2 = this.firstCredit) || void 0 === i2 ? void 0 : i2.firstChar) || void 0 === o2 ? void 0 : o2.startTime, c2 = null === (s2 = this.firstChar) || void 0 === s2 ? void 0 : s2.startTime, l2 = null === (a2 = this.firstGraphic) || void 0 === a2 ? void 0 : a2.startTime;
    this.data.startTime = Math.min("number" == typeof u2 ? u2 : Number.MAX_VALUE, "number" == typeof c2 ? c2 : Number.MAX_VALUE, "number" == typeof l2 ? l2 : Number.MAX_VALUE, this.data.endTime);
  }, e2.prototype.findIndex = function(t2) {
    if (t2 instanceof ot) return (e3 = this._phrases.indexOf(t2)) >= 0 ? e3 : this._credits.indexOf(t2);
    if (t2 instanceof it) {
      for (var e3 = 0, r2 = false, n2 = 0, i2 = this._phrases; n2 < i2.length; n2++) {
        if (!((u2 = (a2 = i2[n2]).findIndex(t2)) < 0)) {
          e3 += u2, r2 = true;
          break;
        }
        e3 += a2.wordCount;
      }
      return r2 ? e3 : -1;
    }
    if (t2 instanceof rt) {
      e3 = 0, r2 = false;
      for (var o2 = 0, s2 = this._phrases; o2 < s2.length; o2++) {
        var a2, u2;
        if (!((u2 = (a2 = s2[o2]).findIndex(t2)) < 0)) {
          e3 += u2, r2 = true;
          break;
        }
        e3 += a2.charCount;
      }
      return r2 ? e3 : -1;
    }
    return t2 instanceof nt ? this._graphics.indexOf(t2) : -1;
  }, e2.prototype.getCredit = function(t2) {
    return t2 < 0 || t2 >= this._credits.length ? null : this._credits[t2];
  }, e2.prototype.getPhrase = function(t2) {
    return t2 < 0 || t2 >= this._phrases.length ? null : this._phrases[t2];
  }, e2.prototype.getWord = function(t2) {
    if (t2 < 0) return null;
    for (var e3 = 0, r2 = this.firstPhrase; ; ) {
      if (!r2) return null;
      if (e3 + r2.children.length > t2) break;
      e3 += r2.children.length, r2 = r2.next;
    }
    return r2.children[t2 - e3];
  }, e2.prototype.getChar = function(t2) {
    if (t2 < 0) return null;
    for (var e3 = 0, r2 = this.firstWord; ; ) {
      if (!r2) return null;
      if (e3 + r2.children.length > t2) break;
      e3 += r2.children.length, r2 = r2.next;
    }
    return r2.children[t2 - e3];
  }, e2.prototype.getGraphic = function(t2) {
    return t2 < 0 || t2 >= this._graphics.length ? null : this._graphics[t2];
  }, e2.prototype.findCredit = function(t2, e3) {
    return st(this._credits, t2, e3);
  }, e2.prototype.findCreditChange = function(t2, e3) {
    return at(this._credits, t2, e3);
  }, e2.prototype.findPhrase = function(t2, e3) {
    return st(this._phrases, t2, e3);
  }, e2.prototype.findPhraseChange = function(t2, e3) {
    return at(this._phrases, t2, e3);
  }, e2.prototype.findWord = function(t2, e3) {
    var r2 = this.findPhrase(t2, e3);
    return r2 ? st(r2._children, t2, e3) : null;
  }, e2.prototype.findWordChange = function(t2, e3) {
    return at(this.words, t2, e3);
  }, e2.prototype.findChar = function(t2, e3) {
    var r2 = this.findWord(t2, e3);
    return r2 ? st(r2._children, t2, e3) : null;
  }, e2.prototype.findCharChange = function(t2, e3) {
    return at(this.chars, t2, e3);
  }, e2.prototype.findGraphic = function(t2, e3) {
    return st(this._graphics, t2, e3);
  }, e2.prototype.findGraphicChange = function(t2, e3) {
    return at(this._graphics, t2, e3);
  }, e2;
}($);
function ct(t, e2) {
  return t.startTime - e2.startTime;
}
function lt(t) {
  return t.startTime;
}
var pt = function() {
  function t(t2, e2, r2, n2, i2, o2) {
    void 0 === t2 && (t2 = 1), void 0 === e2 && (e2 = 0), void 0 === r2 && (r2 = 0), void 0 === n2 && (n2 = 1), void 0 === i2 && (i2 = 0), void 0 === o2 && (o2 = 0), this.setValues(t2, e2, r2, n2, i2, o2);
  }
  return t.prototype.setValues = function(t2, e2, r2, n2, i2, o2) {
    return void 0 === t2 && (t2 = 1), void 0 === e2 && (e2 = 0), void 0 === r2 && (r2 = 0), void 0 === n2 && (n2 = 1), void 0 === i2 && (i2 = 0), void 0 === o2 && (o2 = 0), this.a = t2, this.b = e2, this.c = r2, this.d = n2, this.tx = i2, this.ty = o2, this;
  }, t.prototype.append = function(t2, e2, r2, n2, i2, o2) {
    var s2 = this.a, a2 = this.b, u2 = this.c, c2 = this.d;
    return 1 == t2 && 0 == e2 && 0 == r2 && 1 == n2 || (this.a = s2 * t2 + u2 * e2, this.b = a2 * t2 + c2 * e2, this.c = s2 * r2 + u2 * n2, this.d = a2 * r2 + c2 * n2), this.tx = s2 * i2 + u2 * o2 + this.tx, this.ty = a2 * i2 + c2 * o2 + this.ty, this;
  }, t.prototype.prepend = function(t2, e2, r2, n2, i2, o2) {
    var s2 = this.a, a2 = this.c, u2 = this.tx;
    return this.a = t2 * s2 + r2 * this.b, this.b = e2 * s2 + n2 * this.b, this.c = t2 * a2 + r2 * this.d, this.d = e2 * a2 + n2 * this.d, this.tx = t2 * u2 + r2 * this.ty + i2, this.ty = e2 * u2 + n2 * this.ty + o2, this;
  }, t.prototype.appendMatrix = function(t2) {
    return this.append(t2.a, t2.b, t2.c, t2.d, t2.tx, t2.ty);
  }, t.prototype.prependMatrix = function(t2) {
    return this.prepend(t2.a, t2.b, t2.c, t2.d, t2.tx, t2.ty);
  }, t.prototype.appendTransform = function(e2, r2, n2, i2, o2, s2, a2, u2, c2) {
    var l2, p2, h2;
    return o2 % 360 ? (l2 = o2 * t.DEG_TO_RAD, p2 = Math.cos(l2), h2 = Math.sin(l2)) : (p2 = 1, h2 = 0), s2 || a2 ? (s2 *= t.DEG_TO_RAD, a2 *= t.DEG_TO_RAD, this.append(Math.cos(a2), Math.sin(a2), -Math.sin(s2), Math.cos(s2), e2, r2), this.append(p2 * n2, h2 * n2, -h2 * i2, p2 * i2, 0, 0)) : this.append(p2 * n2, h2 * n2, -h2 * i2, p2 * i2, e2, r2), (u2 || c2) && (this.tx -= u2 * this.a + c2 * this.c, this.ty -= u2 * this.b + c2 * this.d), this;
  }, t.prototype.prependTransform = function(e2, r2, n2, i2, o2, s2, a2, u2, c2) {
    var l2, p2, h2;
    return o2 % 360 ? (l2 = o2 * t.DEG_TO_RAD, p2 = Math.cos(l2), h2 = Math.sin(l2)) : (p2 = 1, h2 = 0), (u2 || c2) && (this.tx -= u2, this.ty -= c2), s2 || a2 ? (s2 *= t.DEG_TO_RAD, a2 *= t.DEG_TO_RAD, this.prepend(p2 * n2, h2 * n2, -h2 * i2, p2 * i2, 0, 0), this.prepend(Math.cos(a2), Math.sin(a2), -Math.sin(s2), Math.cos(s2), e2, r2)) : this.prepend(p2 * n2, h2 * n2, -h2 * i2, p2 * i2, e2, r2), this;
  }, t.prototype.rotate = function(e2) {
    e2 *= t.DEG_TO_RAD;
    var r2 = Math.cos(e2), n2 = Math.sin(e2), i2 = this.a, o2 = this.b;
    return this.a = i2 * r2 + this.c * n2, this.b = o2 * r2 + this.d * n2, this.c = -i2 * n2 + this.c * r2, this.d = -o2 * n2 + this.d * r2, this;
  }, t.prototype.skew = function(e2, r2) {
    return e2 *= t.DEG_TO_RAD, r2 *= t.DEG_TO_RAD, this.append(Math.cos(r2), Math.sin(r2), -Math.sin(e2), Math.cos(e2), 0, 0), this;
  }, t.prototype.scale = function(t2, e2) {
    return this.a *= t2, this.b *= t2, this.c *= e2, this.d *= e2, this;
  }, t.prototype.translate = function(t2, e2) {
    return this.tx += this.a * t2 + this.c * e2, this.ty += this.b * t2 + this.d * e2, this;
  }, t.prototype.identity = function() {
    return this.a = this.d = 1, this.b = this.c = this.tx = this.ty = 0, this;
  }, t.prototype.invert = function() {
    var t2 = this.a, e2 = this.b, r2 = this.c, n2 = this.d, i2 = this.tx, o2 = t2 * n2 - e2 * r2;
    return this.a = n2 / o2, this.b = -e2 / o2, this.c = -r2 / o2, this.d = t2 / o2, this.tx = (r2 * this.ty - n2 * i2) / o2, this.ty = -(t2 * this.ty - e2 * i2) / o2, this;
  }, t.prototype.isIdentity = function() {
    return 0 === this.tx && 0 === this.ty && 1 === this.a && 0 === this.b && 0 === this.c && 1 === this.d;
  }, t.prototype.equals = function(t2) {
    return this.tx === t2.tx && this.ty === t2.ty && this.a === t2.a && this.b === t2.b && this.c === t2.c && this.d === t2.d;
  }, t.prototype.transformPoint = function(t2, e2, r2) {
    return r2.x = t2 * this.a + e2 * this.c + this.tx, r2.y = t2 * this.b + e2 * this.d + this.ty, r2;
  }, t.prototype.decompose = function(e2) {
    void 0 === e2 && (e2 = {}), e2.x = this.tx, e2.y = this.ty, e2.scaleX = Math.sqrt(this.a * this.a + this.b * this.b), e2.scaleY = Math.sqrt(this.c * this.c + this.d * this.d);
    var r2 = Math.atan2(-this.c, this.d), n2 = Math.atan2(this.b, this.a);
    return Math.abs(1 - r2 / n2) < 1e-5 ? (e2.rotation = n2 / t.DEG_TO_RAD, this.a < 0 && this.d >= 0 && (e2.rotation += e2.rotation <= 0 ? 180 : -180), e2.skewX = e2.skewY = 0) : (e2.skewX = r2 / t.DEG_TO_RAD, e2.skewY = n2 / t.DEG_TO_RAD), e2;
  }, t.prototype.copy = function(t2) {
    return this.setValues(t2.a, t2.b, t2.c, t2.d, t2.tx, t2.ty);
  }, t.prototype.clone = function() {
    return new t(this.a, this.b, this.c, this.d, this.tx, this.ty);
  }, t.prototype.toString = function() {
    return "[".concat(this.constructor.name, " (a=").concat(this.a, " b=").concat(this.b, " c=").concat(this.c, " d=").concat(this.d, " tx=").concat(this.tx, " ty=").concat(this.ty, ")]");
  }, t.DEG_TO_RAD = Math.PI / 180, t.identity = new t(), t;
}();
var ht = function() {
  function t(t2, e2) {
    void 0 === t2 && (t2 = 0), void 0 === e2 && (e2 = 0), this.setValues(t2, e2);
  }
  return t.prototype.setValues = function(t2, e2) {
    return void 0 === t2 && (t2 = 0), void 0 === e2 && (e2 = 0), this.x = t2, this.y = e2, this;
  }, t.prototype.copy = function(t2) {
    return this.x = t2.x, this.y = t2.y, this;
  }, t.prototype.clone = function() {
    return new t(this.x, this.y);
  }, t.prototype.toString = function() {
    return "[".concat(this.constructor.name, " (x=").concat(this.x, " y=").concat(this.y, ")]");
  }, t;
}();
var dt = function() {
  function t() {
    this.tx = new pt(), this.alpha = 0, this.composite = "", this.visible = true;
  }
  return t.prototype.reset = function() {
  }, t;
}();
var ft = function() {
  function t() {
    this.rendering = new dt();
  }
  return t.prototype.addCredit = function(t2) {
    this.doAddPhrase(t2);
  }, t.prototype.removeCredit = function(t2) {
    t2._runtime = null;
  }, t.prototype.addPhrase = function(t2) {
    this.doAddPhrase(t2);
  }, t.prototype.removePhrase = function(t2) {
    t2._runtime = null;
  }, t.prototype.doAddPhrase = function(t2) {
    t2._runtime = { graphics: { clear: function() {
    } }, rendering: new dt(), update: function() {
    } };
    for (var e2 = t2.firstWord; e2; ) {
      e2._runtime = { graphics: { clear: function() {
      } }, rendering: new dt(), update: function() {
      } };
      for (var r2 = e2.firstChar; r2 && (r2._runtime = { graphics: { clear: function() {
      } }, rendering: new dt(), update: function() {
      }, advance: 0, ascent: 0, descent: 0, onFontUpdate: function() {
      }, onColorUpdate: function() {
      } }, r2 !== e2.lastChar); ) r2 = r2.next;
      if (e2 === t2.lastWord) break;
      e2 = e2.next;
    }
  }, t.prototype.addGraphic = function(t2) {
    t2._runtime = { graphics: { clear: function() {
    } }, rendering: new dt(), update: function() {
    } };
  }, t.prototype.removeGraphic = function(t2) {
    t2._runtime = null;
  }, t;
}();
var yt = function() {
  function t() {
    this.wrapperTable = {};
  }
  return t.prototype.isGraphics = function() {
    return false;
  }, t.prototype.setCanvas = function() {
    return Promise.resolve();
  }, t.prototype.createRuntime = function(t2) {
    return function(t3, e2, r2, n2) {
      return new (r2 || (r2 = Promise))(function(e3, i2) {
        function o2(t4) {
          try {
            a2(n2.next(t4));
          } catch (t5) {
            i2(t5);
          }
        }
        function s2(t4) {
          try {
            a2(n2.throw(t4));
          } catch (t5) {
            i2(t5);
          }
        }
        function a2(t4) {
          var n3;
          t4.done ? e3(t4.value) : (n3 = t4.value, n3 instanceof r2 ? n3 : new r2(function(t5) {
            t5(n3);
          })).then(o2, s2);
        }
        a2((n2 = n2.apply(t3, [])).next());
      });
    }(this, 0, void 0, function() {
      var e2, r2, n2;
      return function(t3, e3) {
        var r3, n3, i2, o2, s2 = { label: 0, sent: function() {
          if (1 & i2[0]) throw i2[1];
          return i2[1];
        }, trys: [], ops: [] };
        return o2 = { next: a2(0), throw: a2(1), return: a2(2) }, "function" == typeof Symbol && (o2[Symbol.iterator] = function() {
          return this;
        }), o2;
        function a2(a3) {
          return function(u2) {
            return function(a4) {
              if (r3) throw new TypeError("Generator is already executing.");
              for (; o2 && (o2 = 0, a4[0] && (s2 = 0)), s2; ) try {
                if (r3 = 1, n3 && (i2 = 2 & a4[0] ? n3.return : a4[0] ? n3.throw || ((i2 = n3.return) && i2.call(n3), 0) : n3.next) && !(i2 = i2.call(n3, a4[1])).done) return i2;
                switch (n3 = 0, i2 && (a4 = [2 & a4[0], i2.value]), a4[0]) {
                  case 0:
                  case 1:
                    i2 = a4;
                    break;
                  case 4:
                    return s2.label++, { value: a4[1], done: false };
                  case 5:
                    s2.label++, n3 = a4[1], a4 = [0];
                    continue;
                  case 7:
                    a4 = s2.ops.pop(), s2.trys.pop();
                    continue;
                  default:
                    if (!((i2 = (i2 = s2.trys).length > 0 && i2[i2.length - 1]) || 6 !== a4[0] && 2 !== a4[0])) {
                      s2 = 0;
                      continue;
                    }
                    if (3 === a4[0] && (!i2 || a4[1] > i2[0] && a4[1] < i2[3])) {
                      s2.label = a4[1];
                      break;
                    }
                    if (6 === a4[0] && s2.label < i2[1]) {
                      s2.label = i2[1], i2 = a4;
                      break;
                    }
                    if (i2 && s2.label < i2[2]) {
                      s2.label = i2[2], s2.ops.push(a4);
                      break;
                    }
                    i2[2] && s2.ops.pop(), s2.trys.pop();
                    continue;
                }
                a4 = e3.call(t3, s2);
              } catch (t4) {
                a4 = [6, t4], n3 = 0;
              } finally {
                r3 = i2 = 0;
              }
              if (5 & a4[0]) throw a4[1];
              return { value: a4[0] ? a4[1] : void 0, done: true };
            }([a3, u2]);
          };
        }
      }(this, function(i2) {
        for (this.video = t2, t2._runtime = new ft(), e2 = t2.firstCredit; e2; ) t2._runtime.addCredit(e2), e2 = e2.next;
        for (r2 = t2.firstPhrase; r2; ) t2._runtime.addPhrase(r2), r2 = r2.next;
        for (n2 = t2.firstGraphic; n2; ) t2._runtime.addGraphic(n2), n2 = n2.next;
        return [2, t2._runtime];
      });
    });
  }, t.prototype.reset = function() {
    var t2, e2;
    this.resetTextUnitsFrom(this.video.firstCredit), this.resetTextUnitsFrom(null === (t2 = this.video.firstCredit) || void 0 === t2 ? void 0 : t2.firstWord), this.resetTextUnitsFrom(null === (e2 = this.video.firstCredit) || void 0 === e2 ? void 0 : e2.firstChar), this.resetTextUnitsFrom(this.video.firstPhrase), this.resetTextUnitsFrom(this.video.firstWord), this.resetTextUnitsFrom(this.video.firstChar), this.video._runtime.rendering.reset();
  }, t.prototype.resetTextUnitsFrom = function(t2) {
    for (; t2; ) t2.rendering.reset(), t2.graphics.clear(), t2 = t2.next;
  }, t.prototype.update = function() {
    var t2, e2;
    this.updateCharsFrom(null === (t2 = this.video.firstCredit) || void 0 === t2 ? void 0 : t2.firstChar), this.updateCharsFrom(null === (e2 = this.video.firstPhrase) || void 0 === e2 ? void 0 : e2.firstChar);
  }, t.prototype.updateCharsFrom = function(t2) {
    for (; t2; ) t2._runtime.update(), t2 = t2.next;
  }, t.prototype.updateStageTx = function() {
  }, t;
}();
function gt(t) {
  if (void 0 !== t && "function" != typeof t) {
    if ("object" != typeof t) return t;
    if (null === t) return null;
    if (t instanceof X) return { type: "Color", value: { r: t.r, g: t.g, b: t.b, a: t.a } };
    throw new Error();
  }
}
function vt(t, e2) {
  if ("object" != typeof t || null === t) return t;
  if (t.type && (e2[t.type] || "Color" === t.type)) {
    var r2;
    if ("Color" === t.type) {
      var n2 = new X();
      n2.r = Number(t.value.r), n2.g = Number(t.value.g), n2.b = Number(t.value.b), n2.a = Number(t.value.a), r2 = n2;
    } else {
      for (var i2 = new e2[t.type](), o2 = 0, s2 = Object.keys(t.value); o2 < s2.length; o2++) {
        var a2 = s2[o2];
        i2[a2] = t.value[a2];
      }
      r2 = i2;
    }
    return r2;
  }
}
var mt;
var bt;
var _t;
var wt;
var Pt;
var Et;
var Ot;
var St;
var Tt;
var xt;
var At;
var Rt;
var Ct;
var Nt;
var kt;
var jt;
var It;
var Ut;
var Ft;
var Lt;
var Dt = function(t, e2) {
  return bt = String(t), _t = bt.length, function(t2) {
    for (var e3 in mt = t2 || {}, Mt) Object.prototype.hasOwnProperty.call(mt, e3) || (mt[e3] = Mt[e3]);
    wt = mt.sourceFile || null;
  }(e2), Ct = 1, Pt = Nt = 0, Rt = true, pr(), function(t2) {
    kt = jt = Pt, mt.locations && (It = new ar()), Ut = Lt = null, Ft = [], hr();
    var e3 = t2 || Or(), r2 = true;
    for (t2 || (e3.body = []); xt !== Jt; ) {
      var n2 = Fr();
      e3.body.push(n2), r2 && xr(n2) && wr(true), r2 = false;
    }
    return Tr(e3, "Program");
  }(mt.program);
};
var Mt = { ecmaVersion: 5, strictSemicolons: false, allowTrailingCommas: true, forbidReserved: false, locations: false, onComment: null, ranges: false, program: null, sourceFile: null, directSourceFile: null };
var Bt = function(t, e2) {
  for (var r2 = 1, n2 = 0; ; ) {
    ir.lastIndex = n2;
    var i2 = ir.exec(t);
    if (!(i2 && i2.index < e2)) break;
    ++r2, n2 = i2.index + i2[0].length;
  }
  return { line: r2, column: e2 - n2 };
};
function Vt(t, e2) {
  var r2 = Bt(bt, t);
  e2 += " (" + r2.line + ":" + r2.column + ")";
  var n2 = new SyntaxError(e2);
  throw n2.pos = t, n2.loc = r2, n2.raisedAt = Pt, n2;
}
var Gt = [];
var qt = { type: "num" };
var Wt = { type: "regexp" };
var Yt = { type: "string" };
var zt = { type: "name" };
var Jt = { type: "eof" };
var Ht = { keyword: "break" };
var Xt = { keyword: "case", beforeExpr: true };
var Zt = { keyword: "catch" };
var $t = { keyword: "continue" };
var Kt = { keyword: "debugger" };
var Qt = { keyword: "default" };
var te = { keyword: "do", isLoop: true };
var ee = { keyword: "else", beforeExpr: true };
var re = { keyword: "finally" };
var ne = { keyword: "for", isLoop: true };
var ie = { keyword: "function" };
var oe = { keyword: "if" };
var se = { keyword: "return", beforeExpr: true };
var ae = { keyword: "switch" };
var ue = { keyword: "throw", beforeExpr: true };
var ce = { keyword: "try" };
var le = { keyword: "var" };
var pe = { keyword: "while", isLoop: true };
var he = { keyword: "with" };
var de = { keyword: "new", beforeExpr: true };
var fe = { keyword: "this" };
var ye = { keyword: "null", atomValue: null };
var ge = { keyword: "true", atomValue: true };
var ve = { keyword: "false", atomValue: false };
var me = { keyword: "in", binop: 7, beforeExpr: true };
var be = { break: Ht, case: Xt, catch: Zt, continue: $t, debugger: Kt, default: Qt, do: te, else: ee, finally: re, for: ne, function: ie, if: oe, return: se, switch: ae, throw: ue, try: ce, var: le, while: pe, with: he, null: ye, true: ge, false: ve, new: de, in: me, instanceof: { keyword: "instanceof", binop: 7, beforeExpr: true }, this: fe, typeof: { keyword: "typeof", prefix: true, beforeExpr: true }, void: { keyword: "void", prefix: true, beforeExpr: true }, delete: { keyword: "delete", prefix: true, beforeExpr: true } };
var _e = { type: "[", beforeExpr: true };
var we = { type: "]" };
var Pe = { type: "{", beforeExpr: true };
var Ee = { type: "}" };
var Oe = { type: "(", beforeExpr: true };
var Se = { type: ")" };
var Te = { type: ",", beforeExpr: true };
var xe = { type: ";", beforeExpr: true };
var Ae = { type: ":", beforeExpr: true };
var Re = { type: "." };
var Ce = { type: "?", beforeExpr: true };
var Ne = { binop: 10, beforeExpr: true };
var ke = { isAssign: true, beforeExpr: true };
var je = { isAssign: true, beforeExpr: true };
var Ie = { postfix: true, prefix: true, isUpdate: true };
var Ue = { prefix: true, beforeExpr: true };
var Fe = { binop: 1, beforeExpr: true };
var Le = { binop: 2, beforeExpr: true };
var De = { binop: 3, beforeExpr: true };
var Me = { binop: 4, beforeExpr: true };
var Be = { binop: 5, beforeExpr: true };
var Ve = { binop: 6, beforeExpr: true };
var Ge = { binop: 7, beforeExpr: true };
var qe = { binop: 8, beforeExpr: true };
var We = { binop: 9, prefix: true, beforeExpr: true };
var Ye = { binop: 10, beforeExpr: true };
function ze(t) {
  t = t.split(" ");
  var e2 = "", r2 = [];
  t: for (var n2 = 0; n2 < t.length; ++n2) {
    for (var i2 = 0; i2 < r2.length; ++i2) if (r2[i2][0].length == t[n2].length) {
      r2[i2].push(t[n2]);
      continue t;
    }
    r2.push([t[n2]]);
  }
  function o2(t2) {
    if (1 == t2.length) return e2 += "return str === " + JSON.stringify(t2[0]) + ";";
    e2 += "switch(str){";
    for (var r3 = 0; r3 < t2.length; ++r3) e2 += "case " + JSON.stringify(t2[r3]) + ":";
    e2 += "return true}return false;";
  }
  if (r2.length > 3) {
    for (r2.sort(function(t2, e3) {
      return e3.length - t2.length;
    }), e2 += "switch(str.length){", n2 = 0; n2 < r2.length; ++n2) {
      var s2 = r2[n2];
      e2 += "case " + s2[0].length + ":", o2(s2);
    }
    e2 += "}";
  } else o2(t);
  return new Function("str", e2);
}
var Je;
var He = ze("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile");
var Xe = ze("class enum extends super const export import");
var Ze = ze("implements interface let package private protected public static yield");
var $e = ze("eval arguments");
var Ke = ze("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this");
var Qe = /[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;
var tr = "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
var er = new RegExp("[" + tr + "]");
var rr = new RegExp("[" + tr + "------------------------------------------------------------------------------------------------------------------------------------------]");
var nr = /[\n\r\u2028\u2029]/;
var ir = /\r\n|[\n\r\u2028\u2029]/g;
var or = function(t) {
  return t < 65 ? 36 === t : t < 91 || (t < 97 ? 95 === t : t < 123 || t >= 170 && er.test(String.fromCharCode(t)));
};
var sr = function(t) {
  return t < 48 ? 36 === t : t < 58 || !(t < 65) && (t < 91 || (t < 97 ? 95 === t : t < 123 || t >= 170 && rr.test(String.fromCharCode(t))));
};
function ar() {
  this.line = Ct, this.column = Pt - Nt;
}
function ur(t, e2) {
  Ot = Pt, mt.locations && (Tt = new ar()), xt = t, pr(), At = e2, Rt = t.beforeExpr;
}
function cr() {
  var t, e2 = mt.onComment && mt.locations && new ar(), r2 = Pt, n2 = bt.indexOf("*/", Pt += 2);
  if (-1 === n2 && Vt(Pt - 2, "Unterminated comment"), Pt = n2 + 2, mt.locations) for (ir.lastIndex = r2; (t = ir.exec(bt)) && t.index < Pt; ) ++Ct, Nt = t.index + t[0].length;
  mt.onComment && mt.onComment(true, bt.slice(r2 + 2, n2), r2, Pt, e2, mt.locations && new ar());
}
function lr() {
  for (var t = Pt, e2 = mt.onComment && mt.locations && new ar(), r2 = bt.charCodeAt(Pt += 2); Pt < _t && 10 !== r2 && 13 !== r2 && 8232 !== r2 && 8233 !== r2; ) ++Pt, r2 = bt.charCodeAt(Pt);
  mt.onComment && mt.onComment(false, bt.slice(t + 2, Pt), t, Pt, e2, mt.locations && new ar());
}
function pr() {
  for (; Pt < _t; ) {
    var t = bt.charCodeAt(Pt);
    if (32 === t) ++Pt;
    else if (13 === t) ++Pt, 10 === (e2 = bt.charCodeAt(Pt)) && ++Pt, mt.locations && (++Ct, Nt = Pt);
    else if (10 === t || 8232 === t || 8233 === t) ++Pt, mt.locations && (++Ct, Nt = Pt);
    else if (t > 8 && t < 14) ++Pt;
    else if (47 === t) {
      var e2;
      if (42 === (e2 = bt.charCodeAt(Pt + 1))) cr();
      else {
        if (47 !== e2) break;
        lr();
      }
    } else if (160 === t) ++Pt;
    else {
      if (!(t >= 5760 && Qe.test(String.fromCharCode(t)))) break;
      ++Pt;
    }
  }
}
function hr(t) {
  if (t ? Pt = Et + 1 : Et = Pt, mt.locations && (St = new ar()), t) return fr();
  if (Pt >= _t) return ur(Jt);
  var e2 = bt.charCodeAt(Pt);
  if (or(e2) || 92 === e2) return br();
  var r2 = function(t2) {
    switch (t2) {
      case 46:
        return function() {
          var t3 = bt.charCodeAt(Pt + 1);
          return t3 >= 48 && t3 <= 57 ? gr(true) : (++Pt, ur(Re));
        }();
      case 40:
        return ++Pt, ur(Oe);
      case 41:
        return ++Pt, ur(Se);
      case 59:
        return ++Pt, ur(xe);
      case 44:
        return ++Pt, ur(Te);
      case 91:
        return ++Pt, ur(_e);
      case 93:
        return ++Pt, ur(we);
      case 123:
        return ++Pt, ur(Pe);
      case 125:
        return ++Pt, ur(Ee);
      case 58:
        return ++Pt, ur(Ae);
      case 63:
        return ++Pt, ur(Ce);
      case 48:
        var e3 = bt.charCodeAt(Pt + 1);
        if (120 === e3 || 88 === e3) return function() {
          Pt += 2;
          var t3 = yr(16);
          return null == t3 && Vt(Et + 2, "Expected hexadecimal number"), or(bt.charCodeAt(Pt)) && Vt(Pt, "Identifier directly after number"), ur(qt, t3);
        }();
      case 49:
      case 50:
      case 51:
      case 52:
      case 53:
      case 54:
      case 55:
      case 56:
      case 57:
        return gr(false);
      case 34:
      case 39:
        return function(t3) {
          Pt++;
          for (var e4 = ""; ; ) {
            Pt >= _t && Vt(Et, "Unterminated string constant");
            var r3 = bt.charCodeAt(Pt);
            if (r3 === t3) return ++Pt, ur(Yt, e4);
            if (92 === r3) {
              r3 = bt.charCodeAt(++Pt);
              var n3 = /^[0-7]+/.exec(bt.slice(Pt, Pt + 3));
              for (n3 && (n3 = n3[0]); n3 && parseInt(n3, 8) > 255; ) n3 = n3.slice(0, -1);
              if ("0" === n3 && (n3 = null), ++Pt, n3) Lt && Vt(Pt - 2, "Octal literal in strict mode"), e4 += String.fromCharCode(parseInt(n3, 8)), Pt += n3.length - 1;
              else switch (r3) {
                case 110:
                  e4 += "\n";
                  break;
                case 114:
                  e4 += "\r";
                  break;
                case 120:
                  e4 += String.fromCharCode(vr(2));
                  break;
                case 117:
                  e4 += String.fromCharCode(vr(4));
                  break;
                case 85:
                  e4 += String.fromCharCode(vr(8));
                  break;
                case 116:
                  e4 += "	";
                  break;
                case 98:
                  e4 += "\b";
                  break;
                case 118:
                  e4 += "\v";
                  break;
                case 102:
                  e4 += "\f";
                  break;
                case 48:
                  e4 += "\0";
                  break;
                case 13:
                  10 === bt.charCodeAt(Pt) && ++Pt;
                case 10:
                  mt.locations && (Nt = Pt, ++Ct);
                  break;
                default:
                  e4 += String.fromCharCode(r3);
              }
            } else 13 !== r3 && 10 !== r3 && 8232 !== r3 && 8233 !== r3 || Vt(Et, "Unterminated string constant"), e4 += String.fromCharCode(r3), ++Pt;
          }
        }(t2);
      case 47:
        return function(t3) {
          var e4 = bt.charCodeAt(Pt + 1);
          return Rt ? (++Pt, fr()) : 61 === e4 ? dr(je, 2) : dr(Ne, 1);
        }();
      case 37:
      case 42:
        return 61 === bt.charCodeAt(Pt + 1) ? dr(je, 2) : dr(Ye, 1);
      case 124:
      case 38:
        return function(t3) {
          var e4 = bt.charCodeAt(Pt + 1);
          return e4 === t3 ? dr(124 === t3 ? Fe : Le, 2) : 61 === e4 ? dr(je, 2) : dr(124 === t3 ? De : Be, 1);
        }(t2);
      case 94:
        return 61 === bt.charCodeAt(Pt + 1) ? dr(je, 2) : dr(Me, 1);
      case 43:
      case 45:
        return function(t3) {
          var e4 = bt.charCodeAt(Pt + 1);
          return e4 === t3 ? 45 == e4 && 62 == bt.charCodeAt(Pt + 2) && nr.test(bt.slice(jt, Pt)) ? (Pt += 3, lr(), pr(), hr()) : dr(Ie, 2) : 61 === e4 ? dr(je, 2) : dr(We, 1);
        }(t2);
      case 60:
      case 62:
        return function(t3) {
          var e4 = bt.charCodeAt(Pt + 1), r3 = 1;
          return e4 === t3 ? (r3 = 62 === t3 && 62 === bt.charCodeAt(Pt + 2) ? 3 : 2, 61 === bt.charCodeAt(Pt + r3) ? dr(je, r3 + 1) : dr(qe, r3)) : 33 == e4 && 60 == t3 && 45 == bt.charCodeAt(Pt + 2) && 45 == bt.charCodeAt(Pt + 3) ? (Pt += 4, lr(), pr(), hr()) : (61 === e4 && (r3 = 61 === bt.charCodeAt(Pt + 2) ? 3 : 2), dr(Ge, r3));
        }(t2);
      case 61:
      case 33:
        return function(t3) {
          return 61 === bt.charCodeAt(Pt + 1) ? dr(Ve, 61 === bt.charCodeAt(Pt + 2) ? 3 : 2) : dr(61 === t3 ? ke : Ue, 1);
        }(t2);
      case 126:
        return dr(Ue, 1);
    }
    return false;
  }(e2);
  if (false === r2) {
    var n2 = String.fromCharCode(e2);
    if ("\\" === n2 || er.test(n2)) return br();
    Vt(Pt, "Unexpected character '" + n2 + "'");
  }
  return r2;
}
function dr(t, e2) {
  var r2 = bt.slice(Pt, Pt + e2);
  Pt += e2, ur(t, r2);
}
function fr() {
  for (var t, e2, r2 = Pt; ; ) {
    Pt >= _t && Vt(r2, "Unterminated regular expression");
    var n2 = bt.charAt(Pt);
    if (nr.test(n2) && Vt(r2, "Unterminated regular expression"), t) t = false;
    else {
      if ("[" === n2) e2 = true;
      else if ("]" === n2 && e2) e2 = false;
      else if ("/" === n2 && !e2) break;
      t = "\\" === n2;
    }
    ++Pt;
  }
  var i2 = bt.slice(r2, Pt);
  ++Pt;
  var o2 = mr();
  return o2 && !/^[gmsiy]*$/.test(o2) && Vt(r2, "Invalid regexp flag"), ur(Wt, new RegExp(i2, o2));
}
function yr(t, e2) {
  for (var r2 = Pt, n2 = 0, i2 = 0, o2 = null == e2 ? 1 / 0 : e2; i2 < o2; ++i2) {
    var s2, a2 = bt.charCodeAt(Pt);
    if ((s2 = a2 >= 97 ? a2 - 97 + 10 : a2 >= 65 ? a2 - 65 + 10 : a2 >= 48 && a2 <= 57 ? a2 - 48 : 1 / 0) >= t) break;
    ++Pt, n2 = n2 * t + s2;
  }
  return Pt === r2 || null != e2 && Pt - r2 !== e2 ? null : n2;
}
function gr(t) {
  var e2 = Pt, r2 = false, n2 = 48 === bt.charCodeAt(Pt);
  t || null !== yr(10) || Vt(e2, "Invalid number"), 46 === bt.charCodeAt(Pt) && (++Pt, yr(10), r2 = true);
  var i2 = bt.charCodeAt(Pt);
  69 !== i2 && 101 !== i2 || (43 !== (i2 = bt.charCodeAt(++Pt)) && 45 !== i2 || ++Pt, null === yr(10) && Vt(e2, "Invalid number"), r2 = true), or(bt.charCodeAt(Pt)) && Vt(Pt, "Identifier directly after number");
  var o2, s2 = bt.slice(e2, Pt);
  return r2 ? o2 = parseFloat(s2) : n2 && 1 !== s2.length ? /[89]/.test(s2) || Lt ? Vt(e2, "Invalid number") : o2 = parseInt(s2, 8) : o2 = parseInt(s2, 10), ur(qt, o2);
}
function vr(t) {
  var e2 = yr(16, t);
  return null === e2 && Vt(Et, "Bad character escape sequence"), e2;
}
function mr() {
  Je = false;
  for (var t, e2 = true, r2 = Pt; ; ) {
    var n2 = bt.charCodeAt(Pt);
    if (sr(n2)) Je && (t += bt.charAt(Pt)), ++Pt;
    else {
      if (92 !== n2) break;
      Je || (t = bt.slice(r2, Pt)), Je = true, 117 != bt.charCodeAt(++Pt) && Vt(Pt, "Expecting Unicode escape sequence \\uXXXX"), ++Pt;
      var i2 = vr(4), o2 = String.fromCharCode(i2);
      o2 || Vt(Pt - 1, "Invalid Unicode escape"), (e2 ? or(i2) : sr(i2)) || Vt(Pt - 4, "Invalid Unicode escape"), t += o2;
    }
    e2 = false;
  }
  return Je ? t : bt.slice(r2, Pt);
}
function br() {
  var t = mr(), e2 = zt;
  return Je || (Ke(t) ? e2 = be[t] : (mt.forbidReserved && (3 === mt.ecmaVersion ? He : Xe)(t) || Lt && Ze(t)) && Vt(Et, "The keyword '" + t + "' is reserved")), ur(e2, t);
}
function _r() {
  kt = Et, jt = Ot, It = Tt, hr();
}
function wr(t) {
  if (Lt = t, Pt = jt, mt.locations) for (; Pt < Nt; ) Nt = bt.lastIndexOf("\n", Nt - 2) + 1, --Ct;
  pr(), hr();
}
function Pr() {
  this.type = null, this.start = Et, this.end = null;
}
function Er() {
  this.start = St, this.end = null, null !== wt && (this.source = wt);
}
function Or() {
  var t = new Pr();
  return mt.locations && (t.loc = new Er()), mt.directSourceFile && (t.sourceFile = mt.directSourceFile), mt.ranges && (t.range = [Et, 0]), t;
}
function Sr(t) {
  var e2 = new Pr();
  return e2.start = t.start, mt.locations && (e2.loc = new Er(), e2.loc.start = t.loc.start), mt.ranges && (e2.range = [t.range[0], 0]), e2;
}
function Tr(t, e2) {
  return t.type = e2, t.end = jt, mt.locations && (t.loc.end = It), mt.ranges && (t.range[1] = jt), t;
}
function xr(t) {
  return mt.ecmaVersion >= 5 && "ExpressionStatement" === t.type && "Literal" === t.expression.type && "use strict" === t.expression.value;
}
function Ar(t) {
  if (xt === t) return _r(), true;
}
function Rr() {
  return !mt.strictSemicolons && (xt === Jt || xt === Ee || nr.test(bt.slice(jt, Et)));
}
function Cr() {
  Ar(xe) || Rr() || kr();
}
function Nr(t) {
  xt === t ? _r() : kr();
}
function kr() {
  Vt(Et, "Unexpected token");
}
function jr(t) {
  "Identifier" !== t.type && "MemberExpression" !== t.type && Vt(t.start, "Assigning to rvalue"), Lt && "Identifier" === t.type && $e(t.name) && Vt(t.start, "Assigning to " + t.name + " in strict mode");
}
var Ir = { kind: "loop" };
var Ur = { kind: "switch" };
function Fr() {
  (xt === Ne || xt === je && "/=" == At) && hr(true);
  var t = xt, e2 = Or();
  switch (t) {
    case Ht:
    case $t:
      _r();
      var r2 = t === Ht;
      Ar(xe) || Rr() ? e2.label = null : xt !== zt ? kr() : (e2.label = $r(), Cr());
      for (var n2 = 0; n2 < Ft.length; ++n2) {
        var i2 = Ft[n2];
        if (null == e2.label || i2.name === e2.label.name) {
          if (null != i2.kind && (r2 || "loop" === i2.kind)) break;
          if (e2.label && r2) break;
        }
      }
      return n2 === Ft.length && Vt(e2.start, "Unsyntactic " + t.keyword), Tr(e2, r2 ? "BreakStatement" : "ContinueStatement");
    case Kt:
      return _r(), Cr(), Tr(e2, "DebuggerStatement");
    case te:
      return _r(), Ft.push(Ir), e2.body = Fr(), Ft.pop(), Nr(pe), e2.test = Lr(), Cr(), Tr(e2, "DoWhileStatement");
    case ne:
      if (_r(), Ft.push(Ir), Nr(Oe), xt === xe) return Mr(e2, null);
      if (xt === le) {
        var o2 = Or();
        return _r(), Vr(o2, true), Tr(o2, "VariableDeclaration"), 1 === o2.declarations.length && Ar(me) ? Br(e2, o2) : Mr(e2, o2);
      }
      return o2 = Gr(false, true), Ar(me) ? (jr(o2), Br(e2, o2)) : Mr(e2, o2);
    case ie:
      return _r(), Xr(e2, true);
    case oe:
      return _r(), e2.test = Lr(), e2.consequent = Fr(), e2.alternate = Ar(ee) ? Fr() : null, Tr(e2, "IfStatement");
    case se:
      return Ut || Vt(Et, "'return' outside of function"), _r(), Ar(xe) || Rr() ? e2.argument = null : (e2.argument = Gr(), Cr()), Tr(e2, "ReturnStatement");
    case ae:
      _r(), e2.discriminant = Lr(), e2.cases = [], Nr(Pe), Ft.push(Ur);
      for (var s2, a2; xt != Ee; ) if (xt === Xt || xt === Qt) {
        var u2 = xt === Xt;
        s2 && Tr(s2, "SwitchCase"), e2.cases.push(s2 = Or()), s2.consequent = [], _r(), u2 ? s2.test = Gr() : (a2 && Vt(kt, "Multiple default clauses"), a2 = true, s2.test = null), Nr(Ae);
      } else s2 || kr(), s2.consequent.push(Fr());
      return s2 && Tr(s2, "SwitchCase"), _r(), Ft.pop(), Tr(e2, "SwitchStatement");
    case ue:
      return _r(), nr.test(bt.slice(jt, Et)) && Vt(jt, "Illegal newline after throw"), e2.argument = Gr(), Cr(), Tr(e2, "ThrowStatement");
    case ce:
      if (_r(), e2.block = Dr(), e2.handler = null, xt === Zt) {
        var c2 = Or();
        _r(), Nr(Oe), c2.param = $r(), Lt && $e(c2.param.name) && Vt(c2.param.start, "Binding " + c2.param.name + " in strict mode"), Nr(Se), c2.guard = null, c2.body = Dr(), e2.handler = Tr(c2, "CatchClause");
      }
      return e2.guardedHandlers = Gt, e2.finalizer = Ar(re) ? Dr() : null, e2.handler || e2.finalizer || Vt(e2.start, "Missing catch or finally clause"), Tr(e2, "TryStatement");
    case le:
      return _r(), Vr(e2), Cr(), Tr(e2, "VariableDeclaration");
    case pe:
      return _r(), e2.test = Lr(), Ft.push(Ir), e2.body = Fr(), Ft.pop(), Tr(e2, "WhileStatement");
    case he:
      return Lt && Vt(Et, "'with' in strict mode"), _r(), e2.object = Lr(), e2.body = Fr(), Tr(e2, "WithStatement");
    case Pe:
      return Dr();
    case xe:
      return _r(), Tr(e2, "EmptyStatement");
    default:
      var l2 = At, p2 = Gr();
      if (t === zt && "Identifier" === p2.type && Ar(Ae)) {
        for (n2 = 0; n2 < Ft.length; ++n2) Ft[n2].name === l2 && Vt(p2.start, "Label '" + l2 + "' is already declared");
        var h2 = xt.isLoop ? "loop" : xt === ae ? "switch" : null;
        return Ft.push({ name: l2, kind: h2 }), e2.body = Fr(), Ft.pop(), e2.label = p2, Tr(e2, "LabeledStatement");
      }
      return e2.expression = p2, Cr(), Tr(e2, "ExpressionStatement");
  }
}
function Lr() {
  Nr(Oe);
  var t = Gr();
  return Nr(Se), t;
}
function Dr(t) {
  var e2, r2 = Or(), n2 = true, i2 = false;
  for (r2.body = [], Nr(Pe); !Ar(Ee); ) {
    var o2 = Fr();
    r2.body.push(o2), n2 && t && xr(o2) && (e2 = i2, wr(i2 = true)), n2 = false;
  }
  return i2 && !e2 && wr(false), Tr(r2, "BlockStatement");
}
function Mr(t, e2) {
  return t.init = e2, Nr(xe), t.test = xt === xe ? null : Gr(), Nr(xe), t.update = xt === Se ? null : Gr(), Nr(Se), t.body = Fr(), Ft.pop(), Tr(t, "ForStatement");
}
function Br(t, e2) {
  return t.left = e2, t.right = Gr(), Nr(Se), t.body = Fr(), Ft.pop(), Tr(t, "ForInStatement");
}
function Vr(t, e2) {
  for (t.declarations = [], t.kind = "var"; ; ) {
    var r2 = Or();
    if (r2.id = $r(), Lt && $e(r2.id.name) && Vt(r2.id.start, "Binding " + r2.id.name + " in strict mode"), r2.init = Ar(ke) ? Gr(true, e2) : null, t.declarations.push(Tr(r2, "VariableDeclarator")), !Ar(Te)) break;
  }
  return t;
}
function Gr(t, e2) {
  var r2 = qr(e2);
  if (!t && xt === Te) {
    var n2 = Sr(r2);
    for (n2.expressions = [r2]; Ar(Te); ) n2.expressions.push(qr(e2));
    return Tr(n2, "SequenceExpression");
  }
  return r2;
}
function qr(t) {
  var e2 = function(t2) {
    var e3 = function(t3) {
      return Wr(Yr(), -1, t3);
    }(t2);
    if (Ar(Ce)) {
      var r3 = Sr(e3);
      return r3.test = e3, r3.consequent = Gr(true), Nr(Ae), r3.alternate = Gr(true, t2), Tr(r3, "ConditionalExpression");
    }
    return e3;
  }(t);
  if (xt.isAssign) {
    var r2 = Sr(e2);
    return r2.operator = At, r2.left = e2, _r(), r2.right = qr(t), jr(e2), Tr(r2, "AssignmentExpression");
  }
  return e2;
}
function Wr(t, e2, r2) {
  var n2 = xt.binop;
  if (null != n2 && (!r2 || xt !== me) && n2 > e2) {
    var i2 = Sr(t);
    i2.left = t, i2.operator = At;
    var o2 = xt;
    return _r(), i2.right = Wr(Yr(), n2, r2), Wr(Tr(i2, o2 === Fe || o2 === Le ? "LogicalExpression" : "BinaryExpression"), e2, r2);
  }
  return t;
}
function Yr() {
  if (xt.prefix) {
    var t = Or(), e2 = xt.isUpdate;
    return t.operator = At, t.prefix = true, Rt = true, _r(), t.argument = Yr(), e2 ? jr(t.argument) : Lt && "delete" === t.operator && "Identifier" === t.argument.type && Vt(t.start, "Deleting local variable in strict mode"), Tr(t, e2 ? "UpdateExpression" : "UnaryExpression");
  }
  for (var r2 = zr(Jr()); xt.postfix && !Rr(); ) (t = Sr(r2)).operator = At, t.prefix = false, t.argument = r2, jr(r2), _r(), r2 = Tr(t, "UpdateExpression");
  return r2;
}
function zr(t, e2) {
  var r2;
  return Ar(Re) ? ((r2 = Sr(t)).object = t, r2.property = $r(true), r2.computed = false, zr(Tr(r2, "MemberExpression"), e2)) : Ar(_e) ? ((r2 = Sr(t)).object = t, r2.property = Gr(), r2.computed = true, Nr(we), zr(Tr(r2, "MemberExpression"), e2)) : !e2 && Ar(Oe) ? ((r2 = Sr(t)).callee = t, r2.arguments = Zr(Se, false), zr(Tr(r2, "CallExpression"), e2)) : t;
}
function Jr() {
  switch (xt) {
    case fe:
      var t = Or();
      return _r(), Tr(t, "ThisExpression");
    case zt:
      return $r();
    case qt:
    case Yt:
    case Wt:
      return (t = Or()).value = At, t.raw = bt.slice(Et, Ot), _r(), Tr(t, "Literal");
    case ye:
    case ge:
    case ve:
      return (t = Or()).value = xt.atomValue, t.raw = xt.keyword, _r(), Tr(t, "Literal");
    case Oe:
      var e2 = St, r2 = Et;
      _r();
      var n2 = Gr();
      return n2.start = r2, n2.end = Ot, mt.locations && (n2.loc.start = e2, n2.loc.end = Tt), mt.ranges && (n2.range = [r2, Ot]), Nr(Se), n2;
    case _e:
      return t = Or(), _r(), t.elements = Zr(we, true, true), Tr(t, "ArrayExpression");
    case Pe:
      return function() {
        var t2 = Or(), e3 = true, r3 = false;
        for (t2.properties = [], _r(); !Ar(Ee); ) {
          if (e3) e3 = false;
          else if (Nr(Te), mt.allowTrailingCommas && Ar(Ee)) break;
          var n3, i2 = { key: Hr() }, o2 = false;
          if (Ar(Ae) ? (i2.value = Gr(true), n3 = i2.kind = "init") : mt.ecmaVersion >= 5 && "Identifier" === i2.key.type && ("get" === i2.key.name || "set" === i2.key.name) ? (o2 = r3 = true, n3 = i2.kind = i2.key.name, i2.key = Hr(), xt !== Oe && kr(), i2.value = Xr(Or(), false)) : kr(), "Identifier" === i2.key.type && (Lt || r3)) for (var s2 = 0; s2 < t2.properties.length; ++s2) {
            var a2 = t2.properties[s2];
            if (a2.key.name === i2.key.name) {
              var u2 = n3 == a2.kind || o2 && "init" === a2.kind || "init" === n3 && ("get" === a2.kind || "set" === a2.kind);
              u2 && !Lt && "init" === n3 && "init" === a2.kind && (u2 = false), u2 && Vt(i2.key.start, "Redefinition of property");
            }
          }
          t2.properties.push(i2);
        }
        return Tr(t2, "ObjectExpression");
      }();
    case ie:
      return t = Or(), _r(), Xr(t, false);
    case de:
      return function() {
        var t2 = Or();
        return _r(), t2.callee = zr(Jr(), true), Ar(Oe) ? t2.arguments = Zr(Se, false) : t2.arguments = Gt, Tr(t2, "NewExpression");
      }();
    default:
      kr();
  }
}
function Hr() {
  return xt === qt || xt === Yt ? Jr() : $r(true);
}
function Xr(t, e2) {
  xt === zt ? t.id = $r() : e2 ? kr() : t.id = null, t.params = [];
  var r2 = true;
  for (Nr(Oe); !Ar(Se); ) r2 ? r2 = false : Nr(Te), t.params.push($r());
  var n2 = Ut, i2 = Ft;
  if (Ut = true, Ft = [], t.body = Dr(true), Ut = n2, Ft = i2, Lt || t.body.body.length && xr(t.body.body[0])) for (var o2 = t.id ? -1 : 0; o2 < t.params.length; ++o2) {
    var s2 = o2 < 0 ? t.id : t.params[o2];
    if ((Ze(s2.name) || $e(s2.name)) && Vt(s2.start, "Defining '" + s2.name + "' in strict mode"), o2 >= 0) for (var a2 = 0; a2 < o2; ++a2) s2.name === t.params[a2].name && Vt(s2.start, "Argument name clash in strict mode");
  }
  return Tr(t, e2 ? "FunctionDeclaration" : "FunctionExpression");
}
function Zr(t, e2, r2) {
  for (var n2 = [], i2 = true; !Ar(t); ) {
    if (i2) i2 = false;
    else if (Nr(Te), e2 && mt.allowTrailingCommas && Ar(t)) break;
    r2 && xt === Te ? n2.push(null) : n2.push(Gr(true));
  }
  return n2;
}
function $r(t) {
  var e2 = Or();
  return e2.name = xt === zt ? At : t && !mt.forbidReserved && xt.keyword || kr(), Rt = false, _r(), Tr(e2, "Identifier");
}
var Kr = function() {
  function t(e2, r2) {
    var n2, i2 = "string" == typeof e2 ? Dt(e2, t.PARSE_OPTIONS) : e2;
    this.ast = i2, this.initFunc_ = r2, this.paused_ = false, this.polyfills_ = [], this.functionCounter_ = 0, this.stepFunctions_ = /* @__PURE__ */ Object.create(null);
    for (var o2, s2 = /^step([A-Z]\w*)$/, a2 = Object.getOwnPropertyNames(t.prototype), u2 = 0; u2 < a2.length; u2++) {
      var c2 = a2[u2];
      "function" == typeof t.prototype[c2] && (o2 = c2.match(s2)) && (this.stepFunctions_[o2[1]] = t.prototype[c2].bind(this));
    }
    this.global = this.createScope(this.ast, null), this.ast = Dt(this.polyfills_.join("\n"), t.PARSE_OPTIONS), this.polyfills_ = void 0, this.stripLocations_(this.ast, void 0, void 0), (n2 = new tn(this.ast, this.global)).done = false, this.stateStack = [n2], this.run(), this.value = void 0, this.ast = i2, (n2 = new tn(this.ast, this.global)).done = false, this.stateStack.length = 0, this.stateStack[0] = n2, this.nodeConstructor = n2.node.constructor, this.stateStack = this.stateStack, this.OBJECT = this.OBJECT, this.OBJECT_PROTO = this.OBJECT_PROTO, this.FUNCTION = this.FUNCTION, this.FUNCTION_PROTO = this.FUNCTION_PROTO, this.ARRAY = this.ARRAY, this.ARRAY_PROTO = this.ARRAY_PROTO, this.REGEXP = this.REGEXP, this.REGEXP_PROTO = this.REGEXP_PROTO, this.UNDEFINED = void 0, this.NULL = null, this.NAN = NaN, this.TRUE = true, this.FALSE = false, this.STRING_EMPTY = "", this.NUMBER_ZERO = 0, this.NUMBER_ONE = 1;
  }
  return t.prototype.wrap = function(t2) {
    return t2;
  }, t.prototype.unwrap = function(t2, e2) {
    return t2;
  }, t.prototype.appendCode = function(e2) {
    var r2 = this.stateStack[0];
    if (!r2 || "Program" !== r2.node.type) throw Error("Expecting original AST to start with a Program node.");
    var n2 = "string" == typeof e2 ? Dt(e2, t.PARSE_OPTIONS) : e2;
    if (!n2 || "Program" !== n2.type) throw Error("Expecting new AST to start with a Program node.");
    this.populateScope_(n2, r2.scope);
    for (var i2, o2 = 0; i2 = n2.body[o2]; o2++) r2.node.body.push(i2);
    r2.done = false;
  }, t.prototype.step = function() {
    var e2 = this.stateStack, r2 = e2[e2.length - 1];
    if (!r2) return false;
    var n2 = r2.node, i2 = n2.type;
    if ("Program" === i2 && r2.done) return false;
    if (this.paused_) return true;
    try {
      var o2 = this.stepFunctions_[i2](e2, r2, n2);
    } catch (e3) {
      if (e3 !== t.STEP_ERROR) throw e3;
    }
    return o2 && e2.push(o2), !!n2.end || this.step();
  }, t.prototype.run = function() {
    for (; !this.paused_ && this.step(); ) ;
    return this.paused_;
  }, t.prototype.initGlobalScope = function(e2) {
    this.setProperty(e2, "NaN", NaN, t.READONLY_DESCRIPTOR), this.setProperty(e2, "Infinity", 1 / 0, t.READONLY_DESCRIPTOR), this.setProperty(e2, "undefined", void 0, t.READONLY_DESCRIPTOR), this.setProperty(e2, "window", e2, t.READONLY_DESCRIPTOR), this.setProperty(e2, "this", e2, t.READONLY_DESCRIPTOR), this.setProperty(e2, "self", e2), this.OBJECT_PROTO = new Qr(null), this.FUNCTION_PROTO = new Qr(this.OBJECT_PROTO), this.initFunction(e2), this.initObject(e2), e2.proto = this.OBJECT_PROTO, this.setProperty(e2, "constructor", this.OBJECT), this.initArray(e2), this.initString(e2), this.initBoolean(e2), this.initNumber(e2), this.initDate(e2), this.initRegExp(e2), this.initError(e2), this.initMath(e2), this.initJSON(e2);
    var r2 = this, n2 = this.createNativeFunction(function(t2) {
      throw EvalError("Can't happen");
    }, false);
    n2.eval = true, this.setProperty(e2, "eval", n2), this.setProperty(e2, "parseInt", this.createNativeFunction(parseInt, false)), this.setProperty(e2, "parseFloat", this.createNativeFunction(parseFloat, false)), this.setProperty(e2, "isNaN", this.createNativeFunction(isNaN, false)), this.setProperty(e2, "isFinite", this.createNativeFunction(isFinite, false));
    for (var i2 = [[escape, "escape"], [unescape, "unescape"], [decodeURI, "decodeURI"], [decodeURIComponent, "decodeURIComponent"], [encodeURI, "encodeURI"], [encodeURIComponent, "encodeURIComponent"]], o2 = 0; o2 < i2.length; o2++) {
      var s2 = /* @__PURE__ */ function(t2) {
        return function(e3) {
          try {
            return t2(e3);
          } catch (t3) {
            r2.throwException(r2.URI_ERROR, t3.message);
          }
        };
      }(i2[o2][0]);
      this.setProperty(e2, i2[o2][1], this.createNativeFunction(s2, false), t.NONENUMERABLE_DESCRIPTOR);
    }
    this.initFunc_ && this.initFunc_(this, e2);
  }, t.prototype.initFunction = function(e2) {
    var r2, n2 = this, i2 = /^[A-Za-z_$][\w$]*$/;
    r2 = function(e3) {
      if (n2.calledWithNew()) var r3 = this;
      else r3 = n2.createObjectProto(n2.FUNCTION_PROTO);
      if (arguments.length) var o3 = String(arguments[arguments.length - 1]);
      else o3 = "";
      for (var s2 = [], a2 = 0; a2 < arguments.length - 1; a2++) {
        var u2 = String(arguments[a2]);
        u2.match(i2) || n2.throwException(n2.SYNTAX_ERROR, "Invalid function argument: " + u2), s2.push(u2);
      }
      s2 = s2.join(", "), r3.parentScope = n2.global;
      try {
        var c2 = Dt("$ = function(" + s2 + ") {" + o3 + "};", t.PARSE_OPTIONS);
      } catch (t2) {
        n2.throwException(n2.SYNTAX_ERROR, "Invalid code: " + t2.message);
      }
      return 1 !== c2.body.length && n2.throwException(n2.SYNTAX_ERROR, "Invalid code in function body."), r3.node = c2.body[0].expression.right, n2.setProperty(r3, "length", r3.node.length, t.READONLY_DESCRIPTOR), r3;
    }, r2.id = this.functionCounter_++, this.FUNCTION = this.createObjectProto(this.FUNCTION_PROTO), this.setProperty(e2, "Function", this.FUNCTION), this.setProperty(this.FUNCTION, "prototype", this.FUNCTION_PROTO), this.FUNCTION.nativeFunc = r2, this.setProperty(this.FUNCTION_PROTO, "constructor", this.FUNCTION, t.NONENUMERABLE_DESCRIPTOR), this.FUNCTION_PROTO.nativeFunc = function() {
    }, this.FUNCTION_PROTO.nativeFunc.id = this.functionCounter_++, this.setProperty(this.FUNCTION_PROTO, "length", 0, t.READONLY_DESCRIPTOR);
    var o2 = function(t2) {
      if (!(t2 && t2.isObject || n2.getScope().strict)) if (null == t2) t2 = n2.global;
      else {
        var e3 = n2.createObjectProto(n2.getPrototype(t2));
        e3.data = t2, t2 = e3;
      }
      return t2;
    };
    r2 = function(t2, e3) {
      var r3 = n2.stateStack[n2.stateStack.length - 1];
      r3.func_ = this, r3.funcThis_ = o2(t2), r3.arguments_ = [], null != e3 && (e3.isObject ? r3.arguments_ = n2.pseudoToNative(e3) : n2.throwException(n2.TYPE_ERROR, "CreateListFromArrayLike called on non-object")), r3.doneExec_ = false;
    }, this.setNativeFunctionPrototype(this.FUNCTION, "apply", r2), r2 = function(t2, e3) {
      var r3 = n2.stateStack[n2.stateStack.length - 1];
      r3.func_ = this, r3.funcThis_ = o2(t2), r3.arguments_ = [];
      for (var i3 = 1; i3 < arguments.length; i3++) r3.arguments_.push(arguments[i3]);
      r3.doneExec_ = false;
    }, this.setNativeFunctionPrototype(this.FUNCTION, "call", r2), this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',", "{configurable: true, writable: true, value:", "function(oThis) {", "if (typeof this !== 'function') {", "throw TypeError('What is trying to be bound is not callable');", "}", "var aArgs   = Array.prototype.slice.call(arguments, 1),", "fToBind = this,", "fNOP    = function() {},", "fBound  = function() {", "return fToBind.apply(this instanceof fNOP", "? this", ": oThis,", "aArgs.concat(Array.prototype.slice.call(arguments)));", "};", "if (this.prototype) {", "fNOP.prototype = this.prototype;", "}", "fBound.prototype = new fNOP();", "return fBound;", "}", "});", ""), r2 = function() {
      return this.toString();
    }, this.setNativeFunctionPrototype(this.FUNCTION, "toString", r2), this.setProperty(this.FUNCTION, "toString", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function() {
      return this.valueOf();
    }, this.setNativeFunctionPrototype(this.FUNCTION, "valueOf", r2), this.setProperty(this.FUNCTION, "valueOf", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR);
  }, t.prototype.initObject = function(e2) {
    var r2, n2 = this;
    r2 = function(t2) {
      if (null == t2) return n2.calledWithNew() ? this : n2.createObjectProto(n2.OBJECT_PROTO);
      if (!t2.isObject) {
        var e3 = n2.createObjectProto(n2.getPrototype(t2));
        return e3.data = t2, e3;
      }
      return t2;
    }, this.OBJECT = this.createNativeFunction(r2, true), this.setProperty(this.OBJECT, "prototype", this.OBJECT_PROTO), this.setProperty(this.OBJECT_PROTO, "constructor", this.OBJECT), this.setProperty(e2, "Object", this.OBJECT);
    var i2 = function(t2) {
      null == t2 && n2.throwException(n2.TYPE_ERROR, "Cannot convert '" + t2 + "' to object");
    };
    r2 = function(t2) {
      i2(t2);
      var e3 = t2.isObject ? t2.properties : t2;
      return n2.nativeToPseudo(Object.getOwnPropertyNames(e3));
    }, this.setProperty(this.OBJECT, "getOwnPropertyNames", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function(t2) {
      return i2(t2), t2.isObject ? n2.nativeToPseudo(Object.keys(t2.properties)) : n2.nativeToPseudo(Object.keys(t2));
    }, this.setProperty(this.OBJECT, "keys", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function(t2) {
      return null === t2 ? n2.createObjectProto(null) : (void 0 !== t2 && t2.isObject || n2.throwException(n2.TYPE_ERROR, "Object prototype may only be an Object or null"), n2.createObjectProto(t2));
    }, this.setProperty(this.OBJECT, "create", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), this.polyfills_.push("(function() {", "var create_ = Object.create;", "Object.create = function(proto, props) {", "var obj = create_(proto);", "props && Object.defineProperties(obj, props);", "return obj;", "};", "})();", ""), r2 = function(t2, e3, r3) {
      return e3 = String(e3), t2 && t2.isObject || n2.throwException(n2.TYPE_ERROR, "Object.defineProperty called on non-object"), r3 && r3.isObject || n2.throwException(n2.TYPE_ERROR, "Property description must be an object"), !t2.properties[e3] && t2.preventExtensions && n2.throwException(n2.TYPE_ERROR, "Can't define property '" + e3 + "', object is not extensible"), n2.setProperty(t2, e3, ReferenceError, r3.properties), t2;
    }, this.setProperty(this.OBJECT, "defineProperty", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), this.polyfills_.push("(function() {", "var defineProperty_ = Object.defineProperty;", "Object.defineProperty = function(obj, prop, d1) {", "var d2 = {};", "if ('configurable' in d1) d2.configurable = d1.configurable;", "if ('enumerable' in d1) d2.enumerable = d1.enumerable;", "if ('writable' in d1) d2.writable = d1.writable;", "if ('value' in d1) d2.value = d1.value;", "if ('get' in d1) d2.get = d1.get;", "if ('set' in d1) d2.set = d1.set;", "return defineProperty_(obj, prop, d2);", "};", "})();", "Object.defineProperty(Object, 'defineProperties',", "{configurable: true, writable: true, value:", "function(obj, props) {", "var keys = Object.keys(props);", "for (var i = 0; i < keys.length; i++) {", "Object.defineProperty(obj, keys[i], props[keys[i]]);", "}", "return obj;", "}", "});", ""), r2 = function(t2, e3) {
      if (t2 && t2.isObject || n2.throwException(n2.TYPE_ERROR, "Object.getOwnPropertyDescriptor called on non-object"), (e3 = String(e3)) in t2.properties) {
        var r3 = Object.getOwnPropertyDescriptor(t2.properties, e3), i3 = t2.getter[e3], o2 = t2.setter[e3];
        (i3 || o2) && (r3.get = i3, r3.set = o2, delete r3.value, delete r3.writable);
        var s2 = n2.nativeToPseudo(r3);
        return "value" in r3 && n2.setProperty(s2, "value", r3.value), s2;
      }
    }, this.setProperty(this.OBJECT, "getOwnPropertyDescriptor", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function(t2) {
      return i2(t2), n2.getPrototype(t2);
    }, this.setProperty(this.OBJECT, "getPrototypeOf", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function(t2) {
      return Boolean(t2) && !t2.preventExtensions;
    }, this.setProperty(this.OBJECT, "isExtensible", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function(t2) {
      return t2 && t2.isObject && (t2.preventExtensions = true), t2;
    }, this.setProperty(this.OBJECT, "preventExtensions", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), this.setNativeFunctionPrototype(this.OBJECT, "toString", Qr.prototype.toString), this.setNativeFunctionPrototype(this.OBJECT, "toLocaleString", Qr.prototype.toString), this.setNativeFunctionPrototype(this.OBJECT, "valueOf", Qr.prototype.valueOf), r2 = function(t2) {
      return i2(this), this.isObject ? String(t2) in this.properties : this.hasOwnProperty(t2);
    }, this.setNativeFunctionPrototype(this.OBJECT, "hasOwnProperty", r2), r2 = function(t2) {
      return i2(this), Object.prototype.propertyIsEnumerable.call(this.properties, t2);
    }, this.setNativeFunctionPrototype(this.OBJECT, "propertyIsEnumerable", r2), r2 = function(t2) {
      for (; ; ) {
        if (!(t2 = n2.getPrototype(t2))) return false;
        if (t2 === this) return true;
      }
    }, this.setNativeFunctionPrototype(this.OBJECT, "isPrototypeOf", r2);
  }, t.prototype.initArray = function(e2) {
    var r2, n2 = this;
    r2 = function(e3) {
      if (n2.calledWithNew()) var r3 = this;
      else r3 = n2.createObjectProto(n2.ARRAY_PROTO);
      var i2 = arguments[0];
      if (1 === arguments.length && "number" == typeof i2) isNaN(t.legalArrayLength(i2)) && n2.throwException(n2.RANGE_ERROR, "Invalid array length"), r3.properties.length = i2;
      else {
        for (var o2 = 0; o2 < arguments.length; o2++) r3.properties[o2] = arguments[o2];
        r3.properties.length = o2;
      }
      return r3;
    }, this.ARRAY = this.createNativeFunction(r2, true), this.ARRAY_PROTO = this.ARRAY.properties.prototype, this.setProperty(e2, "Array", this.ARRAY), r2 = function(t2) {
      return t2 && "Array" === t2.class;
    }, this.setProperty(this.ARRAY, "isArray", this.createNativeFunction(r2, false), t.NONENUMERABLE_DESCRIPTOR), r2 = function() {
      return Array.prototype.pop.call(this.properties);
    }, this.setNativeFunctionPrototype(this.ARRAY, "pop", r2), r2 = function(t2) {
      return Array.prototype.push.apply(this.properties, arguments);
    }, this.setNativeFunctionPrototype(this.ARRAY, "push", r2), r2 = function() {
      return Array.prototype.shift.call(this.properties);
    }, this.setNativeFunctionPrototype(this.ARRAY, "shift", r2), r2 = function(t2) {
      return Array.prototype.unshift.apply(this.properties, arguments);
    }, this.setNativeFunctionPrototype(this.ARRAY, "unshift", r2), r2 = function() {
      return Array.prototype.reverse.call(this.properties), this;
    }, this.setNativeFunctionPrototype(this.ARRAY, "reverse", r2), r2 = function(t2, e3) {
      var r3 = Array.prototype.splice.apply(this.properties, arguments);
      return n2.unwrap && (r3 = r3.map(n2.unwrap)), n2.nativeToPseudo(r3);
    }, this.setNativeFunctionPrototype(this.ARRAY, "splice", r2), r2 = function(t2, e3) {
      var r3 = Array.prototype.slice.call(this.properties, t2, e3);
      return n2.unwrap && (r3 = r3.map(n2.unwrap)), n2.nativeToPseudo(r3);
    }, this.setNativeFunctionPrototype(this.ARRAY, "slice", r2), r2 = function(t2) {
      return Array.prototype.join.call(this.properties, t2);
    }, this.setNativeFunctionPrototype(this.ARRAY, "join", r2), r2 = function(t2) {
      for (var e3 = [], r3 = 0, i2 = n2.getProperty(this, "length"), o2 = 0; o2 < i2; o2++) {
        if (n2.hasProperty(this, o2)) {
          var s2 = n2.getProperty(this, o2);
          e3[r3] = s2;
        }
        r3++;
      }
      for (o2 = 0; o2 < arguments.length; o2++) {
        var a2 = arguments[o2];
        if (n2.isa(a2, n2.ARRAY)) for (var u2 = n2.getProperty(a2, "length"), c2 = 0; c2 < u2; c2++) n2.hasProperty(a2, c2) && (e3[r3] = n2.getProperty(a2, c2)), r3++;
        else e3[r3] = a2;
      }
      return n2.unwrap && (e3 = e3.map(n2.unwrap)), n2.nativeToPseudo(e3);
    }, this.setNativeFunctionPrototype(this.ARRAY, "concat", r2), r2 = function(t2, e3) {
      return Array.prototype.indexOf.apply(this.properties, arguments);
    }, this.setNativeFunctionPrototype(this.ARRAY, "indexOf", r2), r2 = function(t2, e3) {
      return Array.prototype.lastIndexOf.apply(this.properties, arguments);
    }, this.setNativeFunctionPrototype(this.ARRAY, "lastIndexOf", r2), r2 = function() {
      return Array.prototype.sort.call(this.properties), this;
    }, this.setNativeFunctionPrototype(this.ARRAY, "sort", r2), this.polyfills_.push("Object.defineProperty(Array.prototype, 'every',", "{configurable: true, writable: true, value:", "function(callbackfn, thisArg) {", "if (!this || typeof callbackfn !== 'function') throw TypeError();", "var T, k;", "var O = Object(this);", "var len = O.length >>> 0;", "if (arguments.length > 1) T = thisArg;", "k = 0;", "while (k < len) {", "if (k in O && !callbackfn.call(T, O[k], k, O)) return false;", "k++;", "}", "return true;", "}", "});", "Object.defineProperty(Array.prototype, 'filter',", "{configurable: true, writable: true, value:", "function(fun/*, thisArg*/) {", "if (this === void 0 || this === null || typeof fun !== 'function') throw TypeError();", "var t = Object(this);", "var len = t.length >>> 0;", "var res = [];", "var thisArg = arguments.length >= 2 ? arguments[1] : void 0;", "for (var i = 0; i < len; i++) {", "if (i in t) {", "var val = t[i];", "if (fun.call(thisArg, val, i, t)) res.push(val);", "}", "}", "return res;", "}", "});", "Object.defineProperty(Array.prototype, 'forEach',", "{configurable: true, writable: true, value:", "function(callback, thisArg) {", "if (!this || typeof callback !== 'function') throw TypeError();", "var T, k;", "var O = Object(this);", "var len = O.length >>> 0;", "if (arguments.length > 1) T = thisArg;", "k = 0;", "while (k < len) {", "if (k in O) callback.call(T, O[k], k, O);", "k++;", "}", "}", "});", "Object.defineProperty(Array.prototype, 'map',", "{configurable: true, writable: true, value:", "function(callback, thisArg) {", "if (!this || typeof callback !== 'function') new TypeError;", "var T, A, k;", "var O = Object(this);", "var len = O.length >>> 0;", "if (arguments.length > 1) T = thisArg;", "A = new Array(len);", "k = 0;", "while (k < len) {", "if (k in O) A[k] = callback.call(T, O[k], k, O);", "k++;", "}", "return A;", "}", "});", "Object.defineProperty(Array.prototype, 'reduce',", "{configurable: true, writable: true, value:", "function(callback /*, initialValue*/) {", "if (!this || typeof callback !== 'function') throw TypeError();", "var t = Object(this), len = t.length >>> 0, k = 0, value;", "if (arguments.length === 2) {", "value = arguments[1];", "} else {", "while (k < len && !(k in t)) k++;", "if (k >= len) {", "throw TypeError('Reduce of empty array with no initial value');", "}", "value = t[k++];", "}", "for (; k < len; k++) {", "if (k in t) value = callback(value, t[k], k, t);", "}", "return value;", "}", "});", "Object.defineProperty(Array.prototype, 'reduceRight',", "{configurable: true, writable: true, value:", "function(callback /*, initialValue*/) {", "if (null === this || 'undefined' === typeof this || 'function' !== typeof callback) throw TypeError();", "var t = Object(this), len = t.length >>> 0, k = len - 1, value;", "if (arguments.length >= 2) {", "value = arguments[1];", "} else {", "while (k >= 0 && !(k in t)) k--;", "if (k < 0) {", "throw TypeError('Reduce of empty array with no initial value');", "}", "value = t[k--];", "}", "for (; k >= 0; k--) {", "if (k in t) value = callback(value, t[k], k, t);", "}", "return value;", "}", "});", "Object.defineProperty(Array.prototype, 'some',", "{configurable: true, writable: true, value:", "function(fun/*, thisArg*/) {", "if (!this || typeof fun !== 'function') throw TypeError();", "var t = Object(this);", "var len = t.length >>> 0;", "var thisArg = arguments.length >= 2 ? arguments[1] : void 0;", "for (var i = 0; i < len; i++) {", "if (i in t && fun.call(thisArg, t[i], i, t)) {", "return true;", "}", "}", "return false;", "}", "});", "(function() {", "var sort_ = Array.prototype.sort;", "Array.prototype.sort = function(opt_comp) {", "if (typeof opt_comp !== 'function') {", "return sort_.call(this);", "}", "for (var i = 0; i < this.length; i++) {", "var changes = 0;", "for (var j = 0; j < this.length - i - 1; j++) {", "if (opt_comp(this[j], this[j + 1]) > 0) {", "var swap = this[j];", "this[j] = this[j + 1];", "this[j + 1] = swap;", "changes++;", "}", "}", "if (!changes) break;", "}", "return this;", "};", "})();", "Object.defineProperty(Array.prototype, 'toLocaleString',", "{configurable: true, writable: true, value:", "function() {", "var out = [];", "for (var i = 0; i < this.length; i++) {", "out[i] = (this[i] === null || this[i] === undefined) ? '' : this[i].toLocaleString();", "}", "return out.join(',');", "}", "});", "");
  }, t.prototype.initString = function(e2) {
    var r2, n2 = this;
    r2 = function(t2) {
      return t2 = String(t2), n2.calledWithNew() ? (this.data = t2, this) : t2;
    }, this.STRING = this.createNativeFunction(r2, true), this.setProperty(e2, "String", this.STRING), this.setProperty(this.STRING, "fromCharCode", this.createNativeFunction(String.fromCharCode, false), t.NONENUMERABLE_DESCRIPTOR);
    for (var i2 = ["trim", "toLowerCase", "toUpperCase", "toLocaleLowerCase", "toLocaleUpperCase", "charAt", "charCodeAt", "substring", "slice", "substr", "indexOf", "lastIndexOf", "concat"], o2 = 0; o2 < i2.length; o2++) this.setNativeFunctionPrototype(this.STRING, i2[o2], String.prototype[i2[o2]]);
    r2 = function(t2, e3, r3) {
      return e3 = e3 ? n2.pseudoToNative(e3) : void 0, r3 = r3 ? n2.pseudoToNative(r3) : void 0, String(this).localeCompare(t2, e3, r3);
    }, this.setNativeFunctionPrototype(this.STRING, "localeCompare", r2), r2 = function(t2, e3) {
      n2.isa(t2, n2.REGEXP) && (t2 = t2.data);
      var r3 = String(this).split(t2, e3);
      return n2.nativeToPseudo(r3);
    }, this.setNativeFunctionPrototype(this.STRING, "split", r2), r2 = function(t2) {
      t2 = t2 ? t2.data : void 0;
      var e3 = String(this).match(t2);
      return e3 ? n2.nativeToPseudo(e3) : null;
    }, this.setNativeFunctionPrototype(this.STRING, "match", r2), r2 = function(t2) {
      return n2.isa(t2, n2.REGEXP) && (t2 = t2.data), String(this).search(t2);
    }, this.setNativeFunctionPrototype(this.STRING, "search", r2), r2 = function(t2, e3) {
      return String(this).replace(t2.data || t2, e3);
    }, this.setNativeFunctionPrototype(this.STRING, "replace", r2), this.polyfills_.push("(function() {", "var replace_ = String.prototype.replace;", "String.prototype.replace = function(substr, newSubstr) {", "if (typeof newSubstr !== 'function') {", "return replace_.call(this, substr, newSubstr);", "}", "var str = this;", "if (substr instanceof RegExp) {", "var subs = [];", "var m = substr.exec(str);", "while (m) {", "m.push(m.index, str);", "var inject = newSubstr.apply(null, m);", "subs.push([m.index, m[0].length, inject]);", "m = substr.global ? substr.exec(str) : null;", "}", "for (var i = subs.length - 1; i >= 0; i--) {", "str = str.substring(0, subs[i][0]) + subs[i][2] + str.substring(subs[i][0] + subs[i][1]);", "}", "} else {", "var i = str.indexOf(substr);", "if (i !== -1) {", "var inject = newSubstr(str.substr(i, substr.length), i, str);", "str = str.substring(0, i) + inject + str.substring(i + substr.length);", "}", "}", "return str;", "};", "})();", "");
  }, t.prototype.initBoolean = function(t2) {
    var e2, r2 = this;
    e2 = function(t3) {
      return t3 = Boolean(t3), r2.calledWithNew() ? (this.data = t3, this) : t3;
    }, this.BOOLEAN = this.createNativeFunction(e2, true), this.setProperty(t2, "Boolean", this.BOOLEAN);
  }, t.prototype.initNumber = function(e2) {
    var r2, n2 = this;
    r2 = function(t2) {
      return t2 = Number(t2), n2.calledWithNew() ? (this.data = t2, this) : t2;
    }, this.NUMBER = this.createNativeFunction(r2, true), this.setProperty(e2, "Number", this.NUMBER);
    for (var i2 = ["MAX_VALUE", "MIN_VALUE", "NaN", "NEGATIVE_INFINITY", "POSITIVE_INFINITY"], o2 = 0; o2 < i2.length; o2++) this.setProperty(this.NUMBER, i2[o2], Number[i2[o2]], t.READONLY_NONENUMERABLE_DESCRIPTOR);
    r2 = function(t2) {
      try {
        return Number(this).toExponential(t2);
      } catch (t3) {
        n2.throwException(n2.ERROR, t3.message);
      }
    }, this.setNativeFunctionPrototype(this.NUMBER, "toExponential", r2), r2 = function(t2) {
      try {
        return Number(this).toFixed(t2);
      } catch (t3) {
        n2.throwException(n2.ERROR, t3.message);
      }
    }, this.setNativeFunctionPrototype(this.NUMBER, "toFixed", r2), r2 = function(t2) {
      try {
        return Number(this).toPrecision(t2);
      } catch (t3) {
        n2.throwException(n2.ERROR, t3.message);
      }
    }, this.setNativeFunctionPrototype(this.NUMBER, "toPrecision", r2), r2 = function(t2) {
      try {
        return Number(this).toString(t2);
      } catch (t3) {
        n2.throwException(n2.ERROR, t3.message);
      }
    }, this.setNativeFunctionPrototype(this.NUMBER, "toString", r2), r2 = function(t2, e3) {
      return t2 = t2 ? n2.pseudoToNative(t2) : void 0, e3 = e3 ? n2.pseudoToNative(e3) : void 0, Number(this).toLocaleString(t2, e3);
    }, this.setNativeFunctionPrototype(this.NUMBER, "toLocaleString", r2);
  }, t.prototype.initDate = function(e2) {
    var r2, n2 = this;
    r2 = function(t2, e3) {
      if (!n2.calledWithNew()) return Date();
      var r3 = [null].concat([].slice.call(arguments));
      return this.data = new (Function.prototype.bind.apply(Date, r3))(), this;
    }, this.DATE = this.createNativeFunction(r2, true), this.setProperty(e2, "Date", this.DATE), this.setProperty(this.DATE, "now", this.createNativeFunction(Date.now, false), t.NONENUMERABLE_DESCRIPTOR), this.setProperty(this.DATE, "parse", this.createNativeFunction(Date.parse, false), t.NONENUMERABLE_DESCRIPTOR), this.setProperty(this.DATE, "UTC", this.createNativeFunction(Date.UTC, false), t.NONENUMERABLE_DESCRIPTOR);
    for (var i2 = ["getDate", "getDay", "getFullYear", "getHours", "getMilliseconds", "getMinutes", "getMonth", "getSeconds", "getTime", "getTimezoneOffset", "getUTCDate", "getUTCDay", "getUTCFullYear", "getUTCHours", "getUTCMilliseconds", "getUTCMinutes", "getUTCMonth", "getUTCSeconds", "getYear", "setDate", "setFullYear", "setHours", "setMilliseconds", "setMinutes", "setMonth", "setSeconds", "setTime", "setUTCDate", "setUTCFullYear", "setUTCHours", "setUTCMilliseconds", "setUTCMinutes", "setUTCMonth", "setUTCSeconds", "setYear", "toDateString", "toISOString", "toJSON", "toGMTString", "toLocaleDateString", "toLocaleString", "toLocaleTimeString", "toTimeString", "toUTCString"], o2 = 0; o2 < i2.length; o2++) r2 = /* @__PURE__ */ function(t2) {
      return function(e3) {
        for (var r3 = [], i3 = 0; i3 < arguments.length; i3++) r3[i3] = n2.pseudoToNative(arguments[i3]);
        return this.data[t2].apply(this.data, r3);
      };
    }(i2[o2]), this.setNativeFunctionPrototype(this.DATE, i2[o2], r2);
  }, t.prototype.initRegExp = function(e2) {
    var r2, n2 = this;
    r2 = function(t2, e3) {
      if (n2.calledWithNew()) var r3 = this;
      else r3 = n2.createObjectProto(n2.REGEXP_PROTO);
      return t2 = t2 ? t2.toString() : "", e3 = e3 ? e3.toString() : "", n2.populateRegExp(r3, new RegExp(t2, e3)), r3;
    }, this.REGEXP = this.createNativeFunction(r2, true), this.REGEXP_PROTO = this.REGEXP.properties.prototype, this.setProperty(e2, "RegExp", this.REGEXP), this.setProperty(this.REGEXP.properties.prototype, "global", void 0, t.READONLY_NONENUMERABLE_DESCRIPTOR), this.setProperty(this.REGEXP.properties.prototype, "ignoreCase", void 0, t.READONLY_NONENUMERABLE_DESCRIPTOR), this.setProperty(this.REGEXP.properties.prototype, "multiline", void 0, t.READONLY_NONENUMERABLE_DESCRIPTOR), this.setProperty(this.REGEXP.properties.prototype, "source", "(?:)", t.READONLY_NONENUMERABLE_DESCRIPTOR), r2 = function(t2) {
      return this.data.test(t2);
    }, this.setNativeFunctionPrototype(this.REGEXP, "test", r2), r2 = function(t2) {
      t2 = t2.toString(), this.data.lastIndex = Number(n2.getProperty(this, "lastIndex"));
      var e3 = this.data.exec(t2);
      if (n2.setProperty(this, "lastIndex", this.data.lastIndex), e3) {
        for (var r3 = n2.createObjectProto(n2.ARRAY_PROTO), i2 = 0; i2 < e3.length; i2++) n2.setProperty(r3, i2, e3[i2]);
        return n2.setProperty(r3, "index", e3.index), n2.setProperty(r3, "input", e3.input), r3;
      }
      return null;
    }, this.setNativeFunctionPrototype(this.REGEXP, "exec", r2);
  }, t.prototype.initError = function(e2) {
    var r2 = this;
    this.ERROR = this.createNativeFunction(function(e3) {
      if (r2.calledWithNew()) var n3 = this;
      else n3 = r2.createObject(r2.ERROR);
      return e3 && r2.setProperty(n3, "message", String(e3), t.NONENUMERABLE_DESCRIPTOR), n3;
    }, true), this.setProperty(e2, "Error", this.ERROR), this.setProperty(this.ERROR.properties.prototype, "message", "", t.NONENUMERABLE_DESCRIPTOR), this.setProperty(this.ERROR.properties.prototype, "name", "Error", t.NONENUMERABLE_DESCRIPTOR);
    var n2 = function(n3) {
      var i2 = r2.createNativeFunction(function(e3) {
        if (r2.calledWithNew()) var n4 = this;
        else n4 = r2.createObject(i2);
        return e3 && r2.setProperty(n4, "message", String(e3), t.NONENUMERABLE_DESCRIPTOR), n4;
      }, true);
      return r2.setProperty(i2, "prototype", r2.createObject(r2.ERROR)), r2.setProperty(i2.properties.prototype, "name", n3, t.NONENUMERABLE_DESCRIPTOR), r2.setProperty(e2, n3, i2), i2;
    };
    this.EVAL_ERROR = n2("EvalError"), this.RANGE_ERROR = n2("RangeError"), this.REFERENCE_ERROR = n2("ReferenceError"), this.SYNTAX_ERROR = n2("SyntaxError"), this.TYPE_ERROR = n2("TypeError"), this.URI_ERROR = n2("URIError");
  }, t.prototype.initMath = function(e2) {
    var r2 = this.createObjectProto(this.OBJECT_PROTO);
    this.setProperty(e2, "Math", r2);
    for (var n2 = ["E", "LN2", "LN10", "LOG2E", "LOG10E", "PI", "SQRT1_2", "SQRT2"], i2 = 0; i2 < n2.length; i2++) this.setProperty(r2, n2[i2], Math[n2[i2]], t.READONLY_NONENUMERABLE_DESCRIPTOR);
    var o2 = ["abs", "acos", "asin", "atan", "atan2", "ceil", "cos", "exp", "floor", "log", "max", "min", "pow", "random", "round", "sin", "sqrt", "tan"];
    for (i2 = 0; i2 < o2.length; i2++) this.setProperty(r2, o2[i2], this.createNativeFunction(Math[o2[i2]], false), t.NONENUMERABLE_DESCRIPTOR);
  }, t.prototype.initJSON = function(t2) {
    var e2 = this, r2 = e2.createObjectProto(this.OBJECT_PROTO);
    this.setProperty(t2, "JSON", r2);
    var n2 = function(t3) {
      try {
        var r3 = JSON.parse(t3.toString());
      } catch (t4) {
        e2.throwException(e2.SYNTAX_ERROR, t4.message);
      }
      return e2.nativeToPseudo(r3);
    };
    this.setProperty(r2, "parse", this.createNativeFunction(n2, false)), n2 = function(t3) {
      var r3 = e2.pseudoToNative(t3);
      try {
        var n3 = JSON.stringify(r3);
      } catch (t4) {
        e2.throwException(e2.TYPE_ERROR, t4.message);
      }
      return n3;
    }, this.setProperty(r2, "stringify", this.createNativeFunction(n2, false));
  }, t.prototype.isa = function(t2, e2) {
    if (null == t2 || !e2) return false;
    var r2 = e2.properties.prototype;
    if (t2 === r2) return true;
    for (var n2 = this.getPrototype(t2); n2; ) {
      if (n2 === r2) return true;
      n2 = n2.proto;
    }
    return false;
  }, t.legalArrayLength = function(t2) {
    var e2 = t2 >>> 0;
    return e2 === Number(t2) ? e2 : NaN;
  }, t.legalArrayIndex = function(t2) {
    var e2 = t2 >>> 0;
    return String(e2) === String(t2) && 4294967295 !== e2 ? e2 : NaN;
  }, t.prototype.createObject = function(t2) {
    return this.createObjectProto(t2 && t2.properties.prototype);
  }, t.prototype.createObjectProto = function(t2) {
    var e2 = new Qr(t2);
    return this.isa(e2, this.FUNCTION) && (this.setProperty(e2, "prototype", this.createObjectProto(this.OBJECT_PROTO || null)), e2.class = "Function"), this.isa(e2, this.ARRAY) && (this.setProperty(e2, "length", 0, { configurable: false, enumerable: false, writable: true }), e2.class = "Array"), this.isa(e2, this.ERROR) && (e2.class = "Error"), e2;
  }, t.prototype.populateRegExp = function(e2, r2) {
    e2.data = r2, this.setProperty(e2, "lastIndex", r2.lastIndex, t.NONENUMERABLE_DESCRIPTOR), this.setProperty(e2, "source", r2.source, t.READONLY_NONENUMERABLE_DESCRIPTOR), this.setProperty(e2, "global", r2.global, t.READONLY_NONENUMERABLE_DESCRIPTOR), this.setProperty(e2, "ignoreCase", r2.ignoreCase, t.READONLY_NONENUMERABLE_DESCRIPTOR), this.setProperty(e2, "multiline", r2.multiline, t.READONLY_NONENUMERABLE_DESCRIPTOR);
  }, t.prototype.createFunction = function(e2, r2) {
    var n2 = this.createObjectProto(this.FUNCTION_PROTO);
    return n2.parentScope = r2, n2.node = e2, this.setProperty(n2, "length", n2.node.params.length, t.READONLY_DESCRIPTOR), n2;
  }, t.prototype.createNativeFunction = function(e2, r2) {
    var n2 = this.createObjectProto(this.FUNCTION_PROTO);
    return n2.nativeFunc = e2, e2.id = this.functionCounter_++, this.setProperty(n2, "length", e2.length, t.READONLY_DESCRIPTOR), r2 ? this.setProperty(n2.properties.prototype, "constructor", n2, t.NONENUMERABLE_DESCRIPTOR) : false === r2 && (n2.illegalConstructor = true, this.setProperty(n2, "prototype", void 0)), n2;
  }, t.prototype.createAsyncFunction = function(e2) {
    var r2 = this.createObjectProto(this.FUNCTION_PROTO);
    return r2.asyncFunc = e2, e2.id = this.functionCounter_++, this.setProperty(r2, "length", e2.length, t.READONLY_DESCRIPTOR), r2;
  }, t.prototype.nativeToPseudo = function(t2) {
    if ("boolean" == typeof t2 || "number" == typeof t2 || "string" == typeof t2 || null == t2) return t2;
    if (t2 instanceof RegExp) {
      var e2 = this.createObjectProto(this.REGEXP_PROTO);
      return this.populateRegExp(e2, t2), e2;
    }
    if (t2 instanceof Function) {
      var r2 = this;
      return this.createNativeFunction(function() {
        return r2.nativeToPseudo(t2.apply(r2, Array.prototype.slice.call(arguments).map(function(t3) {
          return r2.pseudoToNative(t3);
        })));
      }, void 0);
    }
    var n2;
    if (Array.isArray(t2)) {
      n2 = this.createObjectProto(this.ARRAY_PROTO);
      for (var i2 = 0; i2 < t2.length; i2++) i2 in t2 && this.setProperty(n2, i2, this.wrap ? this.wrap(t2[i2]) : this.nativeToPseudo(t2[i2]));
    } else for (var o2 in n2 = this.createObjectProto(this.OBJECT_PROTO), t2) this.setProperty(n2, o2, this.wrap ? this.wrap(t2[i2]) : this.nativeToPseudo(t2[i2]));
    return n2;
  }, t.prototype.pseudoToNative = function(t2, e2) {
    if ("boolean" == typeof t2 || "number" == typeof t2 || "string" == typeof t2 || null == t2) return t2;
    if (this.isa(t2, this.REGEXP)) return t2.data;
    var r2, n2 = e2 || { pseudo: [], native: [] };
    if (-1 !== (o2 = n2.pseudo.indexOf(t2))) return n2.native[o2];
    if (n2.pseudo.push(t2), this.isa(t2, this.ARRAY)) {
      r2 = [], n2.native.push(r2);
      for (var i2 = this.getProperty(t2, "length"), o2 = 0; o2 < i2; o2++) this.hasProperty(t2, o2) && (r2[o2] = this.unwrap ? this.unwrap(this.getProperty(t2, o2), n2) : this.pseudoToNative(this.getProperty(t2, o2), n2));
    } else {
      if (t2._native) return t2._native;
      r2 = {}, n2.native.push(r2);
      var s2 = void 0;
      for (var a2 in t2.properties) s2 = t2.properties[a2], r2[a2] = this.unwrap ? this.unwrap(s2, n2) : this.pseudoToNative(s2, n2);
    }
    return n2.pseudo.pop(), n2.native.pop(), r2;
  }, t.prototype.getPrototype = function(t2) {
    switch (typeof t2) {
      case "number":
        return this.NUMBER.properties.prototype;
      case "boolean":
        return this.BOOLEAN.properties.prototype;
      case "string":
        return this.STRING.properties.prototype;
    }
    return t2 ? t2.proto : null;
  }, t.prototype.getProperty = function(e2, r2) {
    if (r2 = String(r2), null == e2 && this.throwException(this.TYPE_ERROR, "Cannot read property '" + r2 + "' of " + e2), "length" === r2) {
      if (this.isa(e2, this.STRING)) return String(e2).length;
    } else if (r2.charCodeAt(0) < 64 && this.isa(e2, this.STRING)) {
      var n2 = t.legalArrayIndex(r2);
      if (!isNaN(n2) && n2 < String(e2).length) return String(e2)[n2];
    }
    do {
      var i2 = e2;
      if (i2.properties && r2 in i2.properties) {
        var o2 = i2.getter[r2];
        return o2 ? (o2.isGetter = true, o2) : i2.properties[r2];
      }
      if (void 0 !== i2._native && "_" !== r2.charAt(0) && "function" != typeof i2._native[r2]) return this.wrap ? this.wrap(i2._native[r2]) : i2._native[r2];
    } while (e2 = this.getPrototype(e2));
  }, t.prototype.hasProperty = function(e2, r2) {
    if (!e2.isObject) throw TypeError("Primitive data type has no properties");
    if ("length" === (r2 = String(r2)) && this.isa(e2, this.STRING)) return true;
    if (this.isa(e2, this.STRING)) {
      var n2 = t.legalArrayIndex(r2);
      if (!isNaN(n2) && n2 < String(e2).length) return true;
    }
    do {
      var i2 = e2;
      if (i2.properties && r2 in i2.properties) return true;
      if (void 0 !== i2._native && "_" != r2.charAt(0)) {
        var o2 = typeof i2._native[r2];
        return "function" !== o2 && ("undefined" !== o2 || en(i2._native.constructor, r2));
      }
    } while (e2 = this.getPrototype(e2));
    return false;
  }, t.prototype.setProperty = function(e2, r2, n2, i2) {
    r2 = String(r2), null == e2 && this.throwException(this.TYPE_ERROR, "Cannot set property '" + r2 + "' of " + e2), i2 && ("get" in i2 || "set" in i2) && ("value" in i2 || "writable" in i2) && this.throwException(this.TYPE_ERROR, "Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");
    var o2 = !this.stateStack || this.getScope().strict;
    if (e2.isObject) {
      if (this.isa(e2, this.STRING)) {
        var s2 = t.legalArrayIndex(r2);
        if ("length" === r2 || !isNaN(s2) && s2 < String(e2).length) return void (o2 && this.throwException(this.TYPE_ERROR, "Cannot assign to read only property '" + r2 + "' of String '" + e2.data + "'"));
      }
      if ("Array" === e2.class) {
        var a2 = e2.properties.length, u2 = void 0;
        if ("length" === r2) {
          if (n2 = t.legalArrayLength(n2), isNaN(n2) && this.throwException(this.RANGE_ERROR, "Invalid array length"), n2 < a2) for (u2 in e2.properties) u2 = t.legalArrayIndex(u2), !isNaN(u2) && n2 <= u2 && delete e2.properties[u2];
        } else isNaN(u2 = t.legalArrayIndex(r2)) || (e2.properties.length = Math.max(a2, u2 + 1));
      }
      if (!e2.preventExtensions || r2 in e2.properties) if (i2) {
        "get" in i2 && (i2.get ? e2.getter[r2] = i2.get : delete e2.getter[r2]), "set" in i2 && (i2.set ? e2.setter[r2] = i2.set : delete e2.setter[r2]);
        var c2 = {};
        "configurable" in i2 && (c2.configurable = i2.configurable), "enumerable" in i2 && (c2.enumerable = i2.enumerable), "writable" in i2 && (c2.writable = i2.writable, delete e2.getter[r2], delete e2.setter[r2]), "value" in i2 ? (c2.value = i2.value, delete e2.getter[r2], delete e2.setter[r2]) : n2 !== ReferenceError && (c2.value = n2, delete e2.getter[r2], delete e2.setter[r2]);
        try {
          Object.defineProperty(e2.properties, r2, c2);
        } catch (t2) {
          this.throwException(this.TYPE_ERROR, "Cannot redefine property: " + r2);
        }
      } else {
        if (n2 === ReferenceError) throw ReferenceError("Value not specified.");
        if (void 0 !== e2._native && "_" != r2.charAt(0)) {
          var l2 = typeof e2._native[r2];
          if ("function" !== l2 && ("undefined" !== l2 || en(e2._native.constructor, r2))) {
            var p2 = this.unwrap ? this.unwrap(n2) : n2;
            return void (e2._native[r2] = p2);
          }
        }
        for (var h2 = e2; !(r2 in h2.properties); ) if (!(h2 = this.getPrototype(h2))) {
          h2 = e2;
          break;
        }
        if (h2.setter && h2.setter[r2]) return h2.setter[r2];
        if (h2.getter && h2.getter[r2]) o2 && this.throwException(this.TYPE_ERROR, "Cannot set property '" + r2 + "' of object '" + e2 + "' which only has a getter");
        else try {
          e2.properties[r2] = n2;
        } catch (t2) {
          o2 && this.throwException(this.TYPE_ERROR, "Cannot assign to read only property '" + r2 + "' of object '" + e2 + "'");
        }
      }
      else o2 && this.throwException(this.TYPE_ERROR, "Can't add property '" + r2 + "', object is not extensible");
    } else o2 && this.throwException(this.TYPE_ERROR, "Can't create property '" + r2 + "' on '" + e2 + "'");
  }, t.prototype.setNativeFunctionPrototype = function(e2, r2, n2) {
    this.setProperty(e2.properties.prototype, r2, this.createNativeFunction(n2, false), t.NONENUMERABLE_DESCRIPTOR);
  }, t.prototype.getScope = function() {
    var t2 = this.stateStack[this.stateStack.length - 1].scope;
    if (!t2) throw Error("No scope found.");
    return t2;
  }, t.prototype.createScope = function(t2, e2) {
    var r2 = this.createObjectProto(null);
    if (r2.parentScope = e2, e2 || this.initGlobalScope(r2), this.populateScope_(t2, r2), r2.strict = false, e2 && e2.strict) r2.strict = true;
    else {
      var n2 = t2.body && t2.body[0];
      n2 && n2.expression && "Literal" === n2.expression.type && "use strict" === n2.expression.value && (r2.strict = true);
    }
    return r2;
  }, t.prototype.createSpecialScope = function(t2, e2) {
    if (!t2) throw Error("parentScope required");
    var r2 = e2 || this.createObjectProto(null);
    return r2.parentScope = t2, r2.strict = t2.strict, r2;
  }, t.prototype.getValueFromScope = function(t2) {
    for (var e2 = this.getScope(); e2 && e2 !== this.global; ) {
      if (t2 in e2.properties) return e2.properties[t2];
      e2 = e2.parentScope;
    }
    if (e2 === this.global && this.hasProperty(e2, t2)) return this.getProperty(e2, t2);
    var r2 = this.stateStack[this.stateStack.length - 1].node;
    "UnaryExpression" === r2.type && "typeof" === r2.operator || this.throwException(this.REFERENCE_ERROR, t2 + " is not defined");
  }, t.prototype.setValueToScope = function(t2, e2) {
    for (var r2 = this.getScope(), n2 = r2.strict; r2 && r2 !== this.global; ) {
      if (t2 in r2.properties) return void (r2.properties[t2] = e2);
      r2 = r2.parentScope;
    }
    if (r2 === this.global && (!n2 || this.hasProperty(r2, t2))) return this.setProperty(r2, t2, e2);
    this.throwException(this.REFERENCE_ERROR, t2 + " is not defined");
  }, t.prototype.populateScope_ = function(e2, r2) {
    if ("VariableDeclaration" === e2.type) for (var n2 = 0; n2 < e2.declarations.length; n2++) this.setProperty(r2, e2.declarations[n2].id.name, void 0, t.VARIABLE_DESCRIPTOR);
    else {
      if ("FunctionDeclaration" === e2.type) return void this.setProperty(r2, e2.id.name, this.createFunction(e2, r2), t.VARIABLE_DESCRIPTOR);
      if ("FunctionExpression" === e2.type) return;
      if ("ExpressionStatement" === e2.type) return;
    }
    var i2 = e2.constructor;
    for (var o2 in e2) {
      var s2 = e2[o2];
      if (s2 && "object" == typeof s2) if (Array.isArray(s2)) for (n2 = 0; n2 < s2.length; n2++) s2[n2] && s2[n2].constructor === i2 && this.populateScope_(s2[n2], r2);
      else s2.constructor === i2 && this.populateScope_(s2, r2);
    }
  }, t.prototype.stripLocations_ = function(t2, e2, r2) {
    for (var n2 in e2 ? t2.start = e2 : delete t2.start, r2 ? t2.end = r2 : delete t2.end, t2) if (t2.hasOwnProperty(n2)) {
      var i2 = t2[n2];
      i2 && "object" == typeof i2 && this.stripLocations_(i2, e2, r2);
    }
  }, t.prototype.calledWithNew = function() {
    return this.stateStack[this.stateStack.length - 1].isConstructor;
  }, t.prototype.getValue = function(e2) {
    return e2[0] === t.SCOPE_REFERENCE ? this.getValueFromScope(e2[1]) : this.getProperty(e2[0], e2[1]);
  }, t.prototype.setValue = function(e2, r2) {
    return e2[0] === t.SCOPE_REFERENCE ? this.setValueToScope(e2[1], r2) : this.setProperty(e2[0], e2[1], r2);
  }, t.prototype.throwException = function(e2, r2) {
    if (void 0 === r2) var n2 = e2;
    else n2 = this.createObject(e2), this.setProperty(n2, "message", r2, t.NONENUMERABLE_DESCRIPTOR);
    throw this.executeException(n2), t.STEP_ERROR;
  }, t.prototype.executeException = function(t2) {
    var e2, r2 = this.stateStack.slice();
    do {
      this.stateStack.pop();
      var n2 = this.stateStack[this.stateStack.length - 1];
      if ("TryStatement" === n2.node.type) return void (n2.throwValue = t2);
    } while (n2 && "Program" !== n2.node.type);
    if (this.isa(t2, this.ERROR)) {
      var i2 = { EvalError, RangeError, ReferenceError, SyntaxError, TypeError, URIError }, o2 = this.getProperty(t2, "name").toString(), s2 = this.getProperty(t2, "message").valueOf();
      e2 = (i2[o2] || Error)(s2);
    } else e2 = t2.toString();
    throw this.stateStack = r2, e2;
  }, t.prototype.createGetter_ = function(t2, e2) {
    var r2 = Array.isArray(e2) ? e2[0] : e2, n2 = new this.nodeConstructor();
    n2.type = "CallExpression";
    var i2 = new tn(n2, this.stateStack[this.stateStack.length - 1].scope);
    return i2.doneCallee_ = true, i2.funcThis_ = r2, i2.func_ = t2, i2.doneArgs_ = true, i2.arguments_ = [], i2;
  }, t.prototype.createSetter_ = function(t2, e2, r2) {
    var n2 = Array.isArray(e2) ? e2[0] : this.global, i2 = new this.nodeConstructor();
    i2.type = "CallExpression";
    var o2 = new tn(i2, this.stateStack[this.stateStack.length - 1].scope);
    return o2.doneCallee_ = true, o2.funcThis_ = n2, o2.func_ = t2, o2.doneArgs_ = true, o2.arguments_ = [r2], o2;
  }, t.prototype.stepArrayExpression = function(t2, e2, r2) {
    var n2 = r2.elements, i2 = e2.n_ || 0;
    for (e2.array_ ? (this.setProperty(e2.array_, i2, e2.value), i2++) : (e2.array_ = this.createObjectProto(this.ARRAY_PROTO), e2.array_.properties.length = n2.length); i2 < n2.length; ) {
      if (n2[i2]) return e2.n_ = i2, new tn(n2[i2], e2.scope);
      i2++;
    }
    t2.pop(), t2[t2.length - 1].value = e2.array_;
  }, t.prototype.stepAssignmentExpression = function(t2, e2, r2) {
    if (!e2.doneLeft_) {
      e2.doneLeft_ = true;
      var n2 = new tn(r2.left, e2.scope);
      return n2.components = true, n2;
    }
    if (!e2.doneRight_) {
      if (e2.leftReference_ || (e2.leftReference_ = e2.value), e2.doneGetter_ && (e2.leftValue_ = e2.value), !e2.doneGetter_ && "=" !== r2.operator) {
        var i2 = this.getValue(e2.leftReference_);
        if (e2.leftValue_ = i2, i2 && "object" == typeof i2 && i2.isGetter) {
          i2.isGetter = false, e2.doneGetter_ = true;
          var o2 = i2;
          return this.createGetter_(o2, e2.leftReference_);
        }
      }
      return e2.doneRight_ = true, new tn(r2.right, e2.scope);
    }
    if (e2.doneSetter_) return t2.pop(), void (t2[t2.length - 1].value = e2.doneSetter_);
    var s2 = e2.leftValue_, a2 = e2.value;
    switch (r2.operator) {
      case "=":
        s2 = a2;
        break;
      case "+=":
        s2 += a2;
        break;
      case "-=":
        s2 -= a2;
        break;
      case "*=":
        s2 *= a2;
        break;
      case "/=":
        s2 /= a2;
        break;
      case "%=":
        s2 %= a2;
        break;
      case "<<=":
        s2 <<= a2;
        break;
      case ">>=":
        s2 >>= a2;
        break;
      case ">>>=":
        s2 >>>= a2;
        break;
      case "&=":
        s2 &= a2;
        break;
      case "^=":
        s2 ^= a2;
        break;
      case "|=":
        s2 |= a2;
        break;
      default:
        throw SyntaxError("Unknown assignment expression: " + r2.operator);
    }
    var u2 = this.setValue(e2.leftReference_, s2);
    if (u2) return e2.doneSetter_ = s2, this.createSetter_(u2, e2.leftReference_, s2);
    t2.pop(), t2[t2.length - 1].value = s2;
  }, t.prototype.stepBinaryExpression = function(t2, e2, r2) {
    if (!e2.doneLeft_) return e2.doneLeft_ = true, new tn(r2.left, e2.scope);
    if (!e2.doneRight_) return e2.doneRight_ = true, e2.leftValue_ = e2.value, new tn(r2.right, e2.scope);
    t2.pop();
    var n2, i2 = e2.leftValue_, o2 = e2.value;
    switch (r2.operator) {
      case "==":
        n2 = i2 == o2;
        break;
      case "!=":
        n2 = i2 != o2;
        break;
      case "===":
        n2 = i2 === o2;
        break;
      case "!==":
        n2 = i2 !== o2;
        break;
      case ">":
        n2 = i2 > o2;
        break;
      case ">=":
        n2 = i2 >= o2;
        break;
      case "<":
        n2 = i2 < o2;
        break;
      case "<=":
        n2 = i2 <= o2;
        break;
      case "+":
        n2 = i2 + o2;
        break;
      case "-":
        n2 = i2 - o2;
        break;
      case "*":
        n2 = i2 * o2;
        break;
      case "/":
        n2 = i2 / o2;
        break;
      case "%":
        n2 = i2 % o2;
        break;
      case "&":
        n2 = i2 & o2;
        break;
      case "|":
        n2 = i2 | o2;
        break;
      case "^":
        n2 = i2 ^ o2;
        break;
      case "<<":
        n2 = i2 << o2;
        break;
      case ">>":
        n2 = i2 >> o2;
        break;
      case ">>>":
        n2 = i2 >>> o2;
        break;
      case "in":
        o2 && o2.isObject || this.throwException(this.TYPE_ERROR, "'in' expects an object, not '" + o2 + "'"), n2 = this.hasProperty(o2, i2);
        break;
      case "instanceof":
        this.isa(o2, this.FUNCTION) || this.throwException(this.TYPE_ERROR, "Right-hand side of instanceof is not an object"), n2 = !!i2.isObject && this.isa(i2, o2);
        break;
      default:
        throw SyntaxError("Unknown binary operator: " + r2.operator);
    }
    t2[t2.length - 1].value = n2;
  }, t.prototype.stepBlockStatement = function(t2, e2, r2) {
    var n2 = e2.n_ || 0, i2 = r2.body[n2];
    if (i2) return e2.n_ = n2 + 1, new tn(i2, e2.scope);
    t2.pop();
  }, t.prototype.stepBreakStatement = function(t2, e2, r2) {
    t2.pop();
    var n2 = null;
    for (r2.label && (n2 = r2.label.name); e2 && "CallExpression" !== e2.node.type && "NewExpression" !== e2.node.type; ) {
      if (n2) {
        if (e2.labels && -1 !== e2.labels.indexOf(n2)) return;
      } else if (e2.isLoop || e2.isSwitch) return;
      e2 = t2.pop();
    }
    throw SyntaxError("Illegal break statement");
  }, t.prototype.stepCallExpression = function(e2, r2, n2) {
    if (!r2.doneCallee_) {
      r2.doneCallee_ = 1;
      var i2 = new tn(n2.callee, r2.scope);
      return i2.components = true, i2;
    }
    if (1 === r2.doneCallee_) {
      r2.doneCallee_ = 2;
      var o2 = r2.value;
      if (Array.isArray(o2)) {
        if (r2.func_ = this.getValue(o2), o2[0] !== t.SCOPE_REFERENCE && (r2.funcThis_ = o2[0]), (o2 = r2.func_) && "object" == typeof o2 && o2.isGetter) return o2.isGetter = false, r2.doneCallee_ = 1, this.createGetter_(o2, r2.value);
      } else r2.func_ = o2;
      r2.arguments_ = [], r2.n_ = 0;
    }
    if (o2 = r2.func_, !r2.doneArgs_) {
      if (0 !== r2.n_ && r2.arguments_.push(r2.value), n2.arguments[r2.n_]) return new tn(n2.arguments[r2.n_++], r2.scope);
      "NewExpression" === n2.type ? (o2.illegalConstructor && this.throwException(this.TYPE_ERROR, o2 + " is not a constructor"), r2.funcThis_ = this.createObject(o2), r2.isConstructor = true) : void 0 === r2.funcThis_ && (r2.funcThis_ = r2.scope.strict ? void 0 : this.global), r2.doneArgs_ = true;
    }
    if (r2.doneExec_) e2.pop(), r2.isConstructor && "object" != typeof r2.value ? e2[e2.length - 1].value = r2.funcThis_ : e2[e2.length - 1].value = r2.value;
    else {
      r2.doneExec_ = true, o2 && o2.isObject || (console.log("non-function called", o2, r2), this.throwException(this.TYPE_ERROR, o2 + " is not a function"));
      var s2 = o2.node;
      if (s2) {
        for (var a2 = this.createScope(s2.body, o2.parentScope), u2 = 0; u2 < s2.params.length; u2++) {
          var c2 = s2.params[u2].name, l2 = r2.arguments_.length > u2 ? r2.arguments_[u2] : void 0;
          this.setProperty(a2, c2, l2);
        }
        var p2 = this.createObjectProto(this.ARRAY_PROTO);
        for (u2 = 0; u2 < r2.arguments_.length; u2++) this.setProperty(p2, u2, r2.arguments_[u2]);
        this.setProperty(a2, "arguments", p2);
        var h2 = s2.id && s2.id.name;
        return h2 && this.setProperty(a2, h2, o2), this.setProperty(a2, "this", r2.funcThis_, t.READONLY_DESCRIPTOR), r2.value = void 0, new tn(s2.body, a2);
      }
      if (o2.eval) {
        var d2 = r2.arguments_[0];
        if ("string" == typeof d2) {
          try {
            var f2 = Dt(d2.toString(), t.PARSE_OPTIONS);
          } catch (t2) {
            this.throwException(this.SYNTAX_ERROR, "Invalid code: " + t2.message);
          }
          var y2 = new this.nodeConstructor();
          return y2.type = "EvalProgram_", y2.body = f2.body, this.stripLocations_(y2, n2.start, n2.end), (a2 = r2.scope).strict ? a2 = this.createScope(f2, a2) : this.populateScope_(f2, a2), this.value = void 0, new tn(y2, a2);
        }
        r2.value = d2;
      } else if (o2.nativeFunc) void 0 !== r2.funcThis_ && void 0 !== r2.funcThis_._native ? r2.value = o2.nativeFunc.call(r2.funcThis_, r2.arguments_) : r2.value = o2.nativeFunc.apply(r2.funcThis_, r2.arguments_);
      else {
        if (o2.asyncFunc) {
          var g2 = this, v2 = r2.arguments_.concat(function(t2) {
            r2.value = t2, g2.paused_ = false;
          });
          return this.paused_ = true, void o2.asyncFunc.apply(r2.funcThis_, v2);
        }
        this.throwException(this.TYPE_ERROR, o2.class + " is not a function");
      }
    }
  }, t.prototype.stepCatchClause = function(t2, e2, r2) {
    if (!e2.done_) {
      e2.done_ = true;
      var n2 = this.createSpecialScope(e2.scope);
      return this.setProperty(n2, r2.param.name, e2.throwValue), new tn(r2.body, n2);
    }
    t2.pop();
  }, t.prototype.stepConditionalExpression = function(t2, e2, r2) {
    var n2 = e2.mode_ || 0;
    if (0 === n2) return e2.mode_ = 1, new tn(r2.test, e2.scope);
    if (1 === n2) {
      e2.mode_ = 2;
      var i2 = Boolean(e2.value);
      if (i2 && r2.consequent) return new tn(r2.consequent, e2.scope);
      if (!i2 && r2.alternate) return new tn(r2.alternate, e2.scope);
      this.value = void 0;
    }
    t2.pop(), "ConditionalExpression" === r2.type && (t2[t2.length - 1].value = e2.value);
  }, t.prototype.stepContinueStatement = function(t2, e2, r2) {
    t2.pop();
    var n2 = null;
    for (r2.label && (n2 = r2.label.name), e2 = t2[t2.length - 1]; e2 && "CallExpression" !== e2.node.type && "NewExpression" !== e2.node.type; ) {
      if (e2.isLoop && (!n2 || e2.labels && -1 !== e2.labels.indexOf(n2))) return;
      t2.pop(), e2 = t2[t2.length - 1];
    }
    throw SyntaxError("Illegal continue statement");
  }, t.prototype.stepDebuggerStatement = function(t2, e2, r2) {
    t2.pop();
  }, t.prototype.stepDoWhileStatement = function(t2, e2, r2) {
    if ("DoWhileStatement" === r2.type && void 0 === e2.test_ && (e2.value = true, e2.test_ = true), !e2.test_) return e2.test_ = true, new tn(r2.test, e2.scope);
    if (e2.value) {
      if (r2.body) return e2.test_ = false, e2.isLoop = true, new tn(r2.body, e2.scope);
    } else t2.pop();
  }, t.prototype.stepEmptyStatement = function(t2, e2, r2) {
    t2.pop();
  }, t.prototype.stepEvalProgram_ = function(t2, e2, r2) {
    var n2 = e2.n_ || 0, i2 = r2.body[n2];
    if (i2) return e2.n_ = n2 + 1, new tn(i2, e2.scope);
    t2.pop(), t2[t2.length - 1].value = this.value;
  }, t.prototype.stepExpressionStatement = function(t2, e2, r2) {
    if (!e2.done_) return e2.done_ = true, new tn(r2.expression, e2.scope);
    t2.pop(), this.value = e2.value;
  }, t.prototype.stepForInStatement = function(e2, r2, n2) {
    if (!r2.doneInit_ && (r2.doneInit_ = true, n2.left.declarations && n2.left.declarations[0].init)) return r2.scope.strict && this.throwException(this.SYNTAX_ERROR, "for-in loop variable declaration may not have an initializer."), new tn(n2.left, r2.scope);
    if (!r2.doneObject_) return r2.doneObject_ = true, r2.variable_ || (r2.variable_ = r2.value), new tn(n2.right, r2.scope);
    if (r2.isLoop || (r2.isLoop = true, r2.object_ = r2.value, r2.visited_ = /* @__PURE__ */ Object.create(null)), void 0 === r2.name_) {
      t: do {
        if (r2.object_ && r2.object_.isObject) {
          r2.props_ || (r2.props_ = Object.getOwnPropertyNames(r2.object_.properties));
          do {
            var i2 = r2.props_.shift();
          } while (i2 && (r2.visited_[i2] || !Object.prototype.hasOwnProperty.call(r2.object_.properties, i2)));
          if (i2 && (r2.visited_[i2] = true, Object.prototype.propertyIsEnumerable.call(r2.object_.properties, i2))) {
            r2.name_ = i2;
            break t;
          }
        } else if (null !== r2.object_) {
          r2.props_ || (r2.props_ = Object.getOwnPropertyNames(r2.object_));
          do {
            i2 = r2.props_.shift();
          } while (i2 && r2.visited_[i2]);
          if (i2) {
            r2.visited_[i2] = true, r2.name_ = i2;
            break t;
          }
        }
        r2.object_ = this.getPrototype(r2.object_), r2.props_ = null;
      } while (null !== r2.object_);
      if (null === r2.object_) return void e2.pop();
    }
    if (!r2.doneVariable_) {
      r2.doneVariable_ = true;
      var o2 = n2.left;
      if ("VariableDeclaration" !== o2.type) {
        r2.variable_ = null;
        var s2 = new tn(o2, r2.scope);
        return s2.components = true, s2;
      }
      r2.variable_ = [t.SCOPE_REFERENCE, o2.declarations[0].id.name];
    }
    if (r2.variable_ || (r2.variable_ = r2.value), !r2.doneSetter_) {
      r2.doneSetter_ = true;
      var a2 = r2.name_, u2 = this.setValue(r2.variable_, a2);
      if (u2) return this.createSetter_(u2, r2.variable_, a2);
    }
    return r2.name_ = void 0, r2.doneVariable_ = false, r2.doneSetter_ = false, n2.body ? new tn(n2.body, r2.scope) : void 0;
  }, t.prototype.stepForStatement = function(t2, e2, r2) {
    var n2 = e2.mode_ || 0;
    if (0 === n2) {
      if (e2.mode_ = 1, r2.init) return new tn(r2.init, e2.scope);
    } else if (1 === n2) {
      if (e2.mode_ = 2, r2.test) return new tn(r2.test, e2.scope);
    } else if (2 === n2) {
      if (e2.mode_ = 3, !r2.test || e2.value) return e2.isLoop = true, new tn(r2.body, e2.scope);
      t2.pop();
    } else if (3 === n2 && (e2.mode_ = 1, r2.update)) return new tn(r2.update, e2.scope);
  }, t.prototype.stepFunctionDeclaration = function(t2, e2, r2) {
    t2.pop();
  }, t.prototype.stepFunctionExpression = function(t2, e2, r2) {
    t2.pop(), t2[t2.length - 1].value = this.createFunction(r2, e2.scope);
  }, t.prototype.stepIdentifier = function(e2, r2, n2) {
    if (e2.pop(), r2.components) e2[e2.length - 1].value = [t.SCOPE_REFERENCE, n2.name];
    else {
      var i2 = this.getValueFromScope(n2.name);
      if (i2 && "object" == typeof i2 && i2.isGetter) {
        i2.isGetter = false;
        for (var o2 = r2.scope; !this.hasProperty(o2, n2.name); ) o2 = o2.parentScope;
        var s2 = i2;
        return this.createGetter_(s2, this.global);
      }
      e2[e2.length - 1].value = i2;
    }
  }, t.prototype.stepIfStatement = function(t2, e2, r2) {
    return this.stepConditionalExpression(t2, e2, r2);
  }, t.prototype.stepLabeledStatement = function(t2, e2, r2) {
    t2.pop();
    var n2 = e2.labels || [];
    n2.push(r2.label.name);
    var i2 = new tn(r2.body, e2.scope);
    return i2.labels = n2, i2;
  }, t.prototype.stepLiteral = function(t2, e2, r2) {
    t2.pop();
    var n2 = r2.value;
    if (n2 instanceof RegExp) {
      var i2 = this.createObjectProto(this.REGEXP_PROTO);
      this.populateRegExp(i2, n2), n2 = i2;
    }
    t2[t2.length - 1].value = n2;
  }, t.prototype.stepLogicalExpression = function(t2, e2, r2) {
    if ("&&" !== r2.operator && "||" !== r2.operator) throw SyntaxError("Unknown logical operator: " + r2.operator);
    if (!e2.doneLeft_) return e2.doneLeft_ = true, new tn(r2.left, e2.scope);
    if (e2.doneRight_) t2.pop(), t2[t2.length - 1].value = e2.value;
    else {
      if (!("&&" === r2.operator && !e2.value || "||" === r2.operator && e2.value)) return e2.doneRight_ = true, new tn(r2.right, e2.scope);
      t2.pop(), t2[t2.length - 1].value = e2.value;
    }
  }, t.prototype.stepMemberExpression = function(t2, e2, r2) {
    if (!e2.doneObject_) return e2.doneObject_ = true, new tn(r2.object, e2.scope);
    var n2;
    if (r2.computed) {
      if (!e2.doneProperty_) return e2.object_ = e2.value, e2.doneProperty_ = true, new tn(r2.property, e2.scope);
      n2 = e2.value;
    } else e2.object_ = e2.value, n2 = r2.property.name;
    if (t2.pop(), e2.components) t2[t2.length - 1].value = [e2.object_, n2];
    else {
      var i2 = this.getProperty(e2.object_, n2);
      if (i2 && "object" == typeof i2 && i2.isGetter) {
        i2.isGetter = false;
        var o2 = i2;
        return this.createGetter_(o2, e2.object_);
      }
      t2[t2.length - 1].value = i2;
    }
  }, t.prototype.stepNewExpression = function(t2, e2, r2) {
    return this.stepCallExpression(t2, e2, r2);
  }, t.prototype.stepObjectExpression = function(t2, e2, r2) {
    var n2 = e2.n_ || 0, i2 = r2.properties[n2];
    if (e2.object_) {
      var o2 = i2.key;
      if ("Identifier" === o2.type) var s2 = o2.name;
      else {
        if ("Literal" !== o2.type) throw SyntaxError("Unknown object structure: " + o2.type);
        s2 = o2.value;
      }
      e2.properties_[s2] || (e2.properties_[s2] = {}), e2.properties_[s2][i2.kind] = e2.value, e2.n_ = ++n2, i2 = r2.properties[n2];
    } else e2.object_ = this.createObjectProto(this.OBJECT_PROTO), e2.properties_ = /* @__PURE__ */ Object.create(null);
    if (i2) return new tn(i2.value, e2.scope);
    for (var a2 in e2.properties_) {
      var u2 = e2.properties_[a2];
      if ("get" in u2 || "set" in u2) {
        var c2 = { configurable: true, enumerable: true, get: u2.get, set: u2.set };
        this.setProperty(e2.object_, a2, null, c2);
      } else this.setProperty(e2.object_, a2, u2.init);
    }
    t2.pop(), t2[t2.length - 1].value = e2.object_;
  }, t.prototype.stepProgram = function(t2, e2, r2) {
    var n2 = e2.n_ || 0, i2 = r2.body[n2];
    if (i2) return e2.done = false, e2.n_ = n2 + 1, new tn(i2, e2.scope);
    e2.done = true;
  }, t.prototype.stepReturnStatement = function(t2, e2, r2) {
    if (r2.argument && !e2.done_) return e2.done_ = true, new tn(r2.argument, e2.scope);
    var n2 = e2.value, i2 = t2.length - 1;
    for (e2 = t2[i2]; "CallExpression" !== e2.node.type && "NewExpression" !== e2.node.type; ) {
      if ("TryStatement" !== e2.node.type && t2.splice(i2, 1), --i2 < 0) throw SyntaxError("Illegal return statement");
      e2 = t2[i2];
    }
    e2.value = n2;
  }, t.prototype.stepSequenceExpression = function(t2, e2, r2) {
    var n2 = e2.n_ || 0, i2 = r2.expressions[n2];
    if (i2) return e2.n_ = n2 + 1, new tn(i2, e2.scope);
    t2.pop(), t2[t2.length - 1].value = e2.value;
  }, t.prototype.stepSwitchStatement = function(t2, e2, r2) {
    if (!e2.test_) return e2.test_ = 1, new tn(r2.discriminant, e2.scope);
    for (1 === e2.test_ && (e2.test_ = 2, e2.switchValue_ = e2.value); ; ) {
      var n2 = e2.index_ || 0, i2 = r2.cases[n2];
      if (e2.matched_ || !i2 || i2.test) if (i2 || e2.matched_ || !e2.defaultCase_) {
        if (!i2) return void t2.pop();
        if (!e2.matched_ && !e2.tested_ && i2.test) return e2.tested_ = true, new tn(i2.test, e2.scope);
        if (e2.matched_ || e2.value === e2.switchValue_) {
          e2.matched_ = true;
          var o2 = e2.n_ || 0;
          if (i2.consequent[o2]) return e2.isSwitch = true, e2.n_ = o2 + 1, new tn(i2.consequent[o2], e2.scope);
        }
        e2.tested_ = false, e2.n_ = 0, e2.index_ = n2 + 1;
      } else e2.matched_ = true, e2.index_ = e2.defaultCase_;
      else e2.defaultCase_ = n2, e2.index_ = n2 + 1;
    }
  }, t.prototype.stepThisExpression = function(t2, e2, r2) {
    t2.pop(), t2[t2.length - 1].value = this.getValueFromScope("this");
  }, t.prototype.stepThrowStatement = function(t2, e2, r2) {
    if (!e2.done_) return e2.done_ = true, new tn(r2.argument, e2.scope);
    this.throwException(e2.value);
  }, t.prototype.stepTryStatement = function(t2, e2, r2) {
    if (!e2.doneBlock_) return e2.doneBlock_ = true, new tn(r2.block, e2.scope);
    if (e2.throwValue && !e2.doneHandler_ && r2.handler) {
      e2.doneHandler_ = true;
      var n2 = new tn(r2.handler, e2.scope);
      return n2.throwValue = e2.throwValue, e2.throwValue = null, n2;
    }
    if (!e2.doneFinalizer_ && r2.finalizer) return e2.doneFinalizer_ = true, new tn(r2.finalizer, e2.scope);
    e2.throwValue ? this.executeException(e2.throwValue) : t2.pop();
  }, t.prototype.stepUnaryExpression = function(e2, r2, n2) {
    if (!r2.done_) {
      r2.done_ = true;
      var i2 = new tn(n2.argument, r2.scope);
      return i2.components = "delete" === n2.operator, i2;
    }
    e2.pop();
    var o2 = r2.value;
    if ("-" === n2.operator) o2 = -o2;
    else if ("+" === n2.operator) o2 = +o2;
    else if ("!" === n2.operator) o2 = !o2;
    else if ("~" === n2.operator) o2 = ~o2;
    else if ("delete" === n2.operator) {
      var s2 = true;
      if (Array.isArray(o2)) {
        var a2 = o2[0];
        a2 === t.SCOPE_REFERENCE && (a2 = r2.scope);
        var u2 = String(o2[1]);
        try {
          delete a2.properties[u2];
        } catch (t2) {
          r2.scope.strict ? this.throwException(this.TYPE_ERROR, "Cannot delete property '" + u2 + "' of '" + a2 + "'") : s2 = false;
        }
      }
      o2 = s2;
    } else if ("typeof" === n2.operator) o2 = o2 && "Function" === o2.class ? "function" : typeof o2;
    else {
      if ("void" !== n2.operator) throw SyntaxError("Unknown unary operator: " + n2.operator);
      o2 = void 0;
    }
    e2[e2.length - 1].value = o2;
  }, t.prototype.stepUpdateExpression = function(t2, e2, r2) {
    if (!e2.doneLeft_) {
      e2.doneLeft_ = true;
      var n2 = new tn(r2.argument, e2.scope);
      return n2.components = true, n2;
    }
    if (e2.leftSide_ || (e2.leftSide_ = e2.value), e2.doneGetter_ && (e2.leftValue_ = e2.value), !e2.doneGetter_) {
      var i2 = this.getValue(e2.leftSide_);
      if (e2.leftValue_ = i2, i2 && "object" == typeof i2 && i2.isGetter) {
        i2.isGetter = false, e2.doneGetter_ = true;
        var o2 = i2;
        return this.createGetter_(o2, e2.leftSide_);
      }
    }
    if (e2.doneSetter_) return t2.pop(), void (t2[t2.length - 1].value = e2.doneSetter_);
    var s2;
    if (i2 = Number(e2.leftValue_), "++" === r2.operator) s2 = i2 + 1;
    else {
      if ("--" !== r2.operator) throw SyntaxError("Unknown update expression: " + r2.operator);
      s2 = i2 - 1;
    }
    var a2 = r2.prefix ? s2 : i2, u2 = this.setValue(e2.leftSide_, s2);
    if (u2) return e2.doneSetter_ = a2, this.createSetter_(u2, e2.leftSide_, s2);
    t2.pop(), t2[t2.length - 1].value = a2;
  }, t.prototype.stepVariableDeclaration = function(t2, e2, r2) {
    var n2 = r2.declarations, i2 = e2.n_ || 0, o2 = n2[i2];
    for (e2.init_ && o2 && (this.setValueToScope(o2.id.name, e2.value), e2.init_ = false, o2 = n2[++i2]); o2; ) {
      if (o2.init) return e2.n_ = i2, e2.init_ = true, new tn(o2.init, e2.scope);
      o2 = n2[++i2];
    }
    t2.pop();
  }, t.prototype.stepWithStatement = function(t2, e2, r2) {
    if (!e2.doneObject_) return e2.doneObject_ = true, new tn(r2.object, e2.scope);
    if (!e2.doneBody_) {
      e2.doneBody_ = true;
      var n2 = this.createSpecialScope(e2.scope, e2.value);
      return new tn(r2.body, n2);
    }
    t2.pop();
  }, t.prototype.stepWhileStatement = function(t2, e2, r2) {
    return this.stepDoWhileStatement(t2, e2, r2);
  }, t.PARSE_OPTIONS = { ecmaVersion: 5 }, t.READONLY_DESCRIPTOR = { configurable: true, enumerable: true, writable: false }, t.NONENUMERABLE_DESCRIPTOR = { configurable: true, enumerable: false, writable: true }, t.READONLY_NONENUMERABLE_DESCRIPTOR = { configurable: true, enumerable: false, writable: false }, t.VARIABLE_DESCRIPTOR = { configurable: false, enumerable: true, writable: true }, t.STEP_ERROR = {}, t.SCOPE_REFERENCE = {}, t.toStringCycles_ = [], t;
}();
var Qr = function() {
  function t(t2) {
    this.proto = null, this.isObject = true, this.class = "Object", this.data = null, this._native = void 0, this.getter = /* @__PURE__ */ Object.create(null), this.setter = /* @__PURE__ */ Object.create(null), this.properties = /* @__PURE__ */ Object.create(null), this.proto = t2;
  }
  return t.prototype.toString = function() {
    if ("Array" === this.class) {
      (n2 = Kr.toStringCycles_).push(this);
      try {
        for (var t2 = [], e2 = 0; e2 < this.properties.length; e2++) {
          var r2 = this.properties[e2];
          t2[e2] = r2 && r2.isObject && -1 !== n2.indexOf(r2) ? "..." : r2;
        }
      } finally {
        n2.pop();
      }
      return t2.join(",");
    }
    if ("Error" === this.class) {
      var n2;
      if (-1 !== (n2 = Kr.toStringCycles_).indexOf(this)) return "[object Error]";
      var i2, o2 = void 0, s2 = this;
      do {
        if ("name" in s2.properties) {
          i2 = s2.properties.name;
          break;
        }
      } while (s2 = s2.proto);
      s2 = this;
      do {
        if ("message" in s2.properties) {
          o2 = s2.properties.message;
          break;
        }
      } while (s2 = s2.proto);
      n2.push(this);
      try {
        i2 = i2 && i2.toString(), o2 = o2 && o2.toString();
      } finally {
        n2.pop();
      }
      return o2 ? i2 + ": " + o2 : String(i2);
    }
    return null !== this.data ? String(this.data) : "[object " + this.class + "]";
  }, t.prototype.valueOf = function() {
    return void 0 === this.data || null === this.data || this.data instanceof RegExp ? this : this.data instanceof Date ? this.data.valueOf() : this.data;
  }, t;
}();
var tn = function(t, e2) {
  this.node = t, this.scope = e2;
};
var en = function(t, e2) {
  for (var r2 = t; r2 && r2.prototype; ) {
    if (Object.getOwnPropertyNames(r2.prototype).indexOf(e2) >= 0) return true;
    r2 = Object.getPrototypeOf(r2);
  }
  return false;
};
function rn(t, e2) {
  var r2 = {}, n2 = Dt(t, { locations: true, onComment: function(t2, e3, n3, i3, o3, s3) {
    r2[s3.line] = e3;
  } });
  if ("Program" !== n2.type || 1 !== n2.body.length || "FunctionDeclaration" !== n2.body[0].type) throw new Error("JavaScript program should only have one function definition");
  var i2 = n2.body[0].body.body, o2 = [], s2 = [];
  return i2.forEach(function(t2) {
    if ("ExpressionStatement" === t2.type) {
      var n3 = t2.expression;
      if ("AssignmentExpression" === n3.type && "=" === n3.operator && "MemberExpression" === n3.left.type && "ThisExpression" === n3.left.object.type && "Identifier" === n3.left.property.type) {
        for (var i3 = [], a2 = n3.loc.start.line - 1; a2 >= 0 && void 0 !== r2[a2]; a2--) i3.push(r2[a2]);
        if (!(i3.length <= 0)) {
          var u2 = n3.left.property.name;
          if (!(Array.isArray(e2) && e2.indexOf(u2) >= 0) && "FunctionExpression" !== n3.right.type) {
            var c2 = function(t3, e3, r3) {
              var n4 = { name: t3, title: {}, className: null, proposed: false, initialValue: null };
              if (e3.forEach(function(t4) {
                var e4 = t4.indexOf("@ui ");
                if (e4 >= 0) n4.description = t4.substring(e4 + 4).trim();
                else {
                  var r4 = t4.indexOf("@title ");
                  if (r4 >= 0) {
                    var i5 = t4.substring(r4 + 7).trim();
                    0 === i5.indexOf("@ja ") ? n4.title.ja = i5.substring(4).trim() : n4.title.default = i5;
                  } else if (t4.indexOf("@proposed") >= 0) n4.proposed = true;
                  else {
                    var o4 = t4.indexOf("@comment ");
                    if (o4 >= 0) {
                      var s4 = t4.substring(o4 + 9).trim();
                      return n4.comment || (n4.comment = {}), void (0 === s4.indexOf("@ja ") ? n4.comment.ja = s4.substring(4).trim() : n4.comment.default = s4);
                    }
                  }
                }
              }), !n4.description && !n4.comment) return null;
              if (n4.proposed || n4.comment) return n4;
              var i4 = n4.description.indexOf("("), o3 = n4.description.indexOf(")", i4);
              if (!(i4 < 0 || o3 < 0)) {
                n4.className = n4.description.substr(0, i4);
                try {
                  var s3 = new Kr("[".concat(n4.description.substr(i4 + 1, o3 - i4 - 1), "]")), a3 = Date.now();
                  for (s3.unwrap = null, s3.wrap = null; s3.step() && !(Date.now() - a3 > 100); ) ;
                  n4.params = s3.pseudoToNative(s3.value);
                } catch (t4) {
                }
                return n4.params || (n4.params = []), n4;
              }
            }(u2, i3);
            s2.push(n3), c2 && o2.push(c2);
          }
        }
      }
    }
  }), { widgets: o2, fields: s2, ast: n2 };
}
function nn(t, e2) {
  if (void 0 === e2 && (e2 = -1), !t) return { dependencyAtCursor: null, dependencies: [] };
  for (var r2 = [], n2 = null, i2 = ("string" == typeof t ? Dt(t, Kr.PARSE_OPTIONS) : t).body[0].body.body.slice(0); i2.length > 0; ) {
    var o2 = i2.shift();
    if (null != o2) {
      if ("CallExpression" !== o2.type) o2.expression && i2.push(o2.expression), o2.object && i2.push(o2.object), o2.property && i2.push(o2.property), o2.name && "string" != typeof name && i2.push(o2.name), o2.left && i2.push(o2.left), o2.right && i2.push(o2.right), o2.id && i2.push(o2.id), o2.init && i2.push(o2.init), o2.callee && i2.push(o2.callee), o2.body && Array.isArray(o2.body) && i2.push.apply(i2, o2.body), o2.declarations && Array.isArray(o2.declarations) && i2.push.apply(i2, o2.declarations), o2.arguments && Array.isArray(o2.arguments) && i2.push.apply(i2, o2.arguments), o2.params && Array.isArray(o2.params) && i2.push.apply(i2, o2.params);
      else if (o2.callee.name && "require" === o2.callee.name) {
        var s2 = o2.arguments;
        if (s2 && Array.isArray(s2) && 1 === s2.length) {
          var a2 = s2[0];
          if ("Literal" === a2.type) {
            var u2 = a2.value;
            r2.push(u2), o2.start && o2.end && o2.start <= e2 && o2.end >= e2 && (n2 = u2);
          }
        }
      }
    }
  }
  return { dependencyAtCursor: n2, dependencies: r2 };
}
Kr.Object = Qr, Kr.State = tn;
var on = function() {
  return on = Object.assign || function(t) {
    for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++) for (var i2 in e2 = arguments[r2]) Object.prototype.hasOwnProperty.call(e2, i2) && (t[i2] = e2[i2]);
    return t;
  }, on.apply(this, arguments);
};
function sn(t, e2, r2) {
  for (var n2, i2 = 0, o2 = e2.length; i2 < o2; i2++) !n2 && i2 in e2 || (n2 || (n2 = Array.prototype.slice.call(e2, 0, i2)), n2[i2] = e2[i2]);
  return t.concat(n2 || Array.prototype.slice.call(e2));
}
function an(t) {
  return "boolean" == typeof t || "number" == typeof t || "string" == typeof t || null == t;
}
var un = { type: "ExpressionStatement", start: null, end: null, expression: { type: "CallExpression", start: null, end: null, expression: null, arguments: null }, arguments: null };
var cn = function() {
  function t(t2, e2, r2) {
    void 0 === r2 && (r2 = null), this.wrapperTable = t2, this.ignoredPropNames = e2, this.wrapMethodParameter = r2, this.verbose = false, this.initialize();
  }
  return t.prototype.initialize = function() {
    var t2 = this, e2 = new Kr("", function(e3, r2) {
      t2.globalScope = r2;
    });
    this.interpreter = e2, this.interpreter.wrap = function(e3) {
      return t2.wrap(e3);
    }, this.interpreter.unwrap = function(e3, r2) {
      return t2.unwrap(e3, r2);
    }, this.wrappers = {}, Object.keys(this.wrapperTable).forEach(function(e3) {
      return t2.wrapClass(t2.wrapperTable[e3], e3);
    });
  }, t.prototype.createGlobalFunction = function(t2, e2) {
    var r2, n2 = this, i2 = e2.func, o2 = e2.raw, s2 = e2.isConstructor, a2 = e2.async, u2 = function() {
      for (var t3 = [], e3 = 0; e3 < arguments.length; e3++) t3[e3] = arguments[e3];
      var r3 = i2(o2 ? t3 : t3.map(function(e4, r4) {
        return r4 < t3.length - 1 || !a2 ? n2.unwrap(e4) : e4;
      }));
      return o2 ? r3 : n2.wrap(r3);
    };
    r2 = a2 ? this.interpreter.createAsyncFunction(u2) : this.interpreter.createNativeFunction(u2, s2), this.interpreter.setProperty(this.globalScope, t2, r2);
  }, t.prototype.createFunction = function(t2, e2) {
    return void 0 === e2 && (e2 = false), this.interpreter.createNativeFunction(t2, e2);
  }, t.prototype.setProperty = function(t2, e2, r2) {
    this.interpreter.setProperty(t2, e2, this.wrap(r2));
  }, t.prototype.setRawProperty = function(t2, e2, r2) {
    this.interpreter.setProperty(t2, e2, r2);
  }, t.prototype.getProperty = function(t2, e2) {
    return this.unwrap(this.interpreter.getProperty(t2, e2));
  }, t.prototype.getRawProperty = function(t2, e2) {
    return this.interpreter.getProperty(t2, e2);
  }, t.prototype.prepareRun = function(t2) {
    var e2;
    e2 = "string" == typeof t2 ? Dt(t2, Kr.PARSE_OPTIONS) : t2;
    var r2 = this.interpreter.createScope(e2, this.globalScope);
    return this.interpreter.stateStack = [{ node: e2, scope: r2, done: false }], r2;
  }, t.prototype.newStatementFor = function(t2) {
    return Dt("new " + t2 + "();", Kr.PARSE_OPTIONS);
  }, t.prototype.prepareNewInstance = function(t2, e2) {
    var r2 = this.interpreter.createScope(Dt("", Kr.PARSE_OPTIONS), e2);
    return this.interpreter.stateStack = [{ node: t2, scope: r2, thisExpression: r2 }], r2;
  }, t.prototype.exec = function(t2, e2, r2, n2) {
    var i2 = this, o2 = this.interpreter;
    un.expression.arguments = [];
    var s2 = [];
    return r2.forEach(function(t3) {
      un.expression.arguments.push(null), s2.push(i2.wrap(t3));
    }), o2.stateStack = [{ node: { type: "Program", body: [un] }, scope: this.globalScope, done: true, n_: 1 }, { node: un, scope: this.globalScope, done_: true }, { node: un.expression, doneCallee_: 2, doneArgs_: true, arguments_: s2, funcThis_: t2, func_: o2.getProperty(t2, e2), scope: t2, n_: s2.length, value: [t2, e2] }], this.run(700, "call a method (" + t2.className + "." + e2 + (n2 || "") + ")");
  }, t.prototype.run = function(t2, e2) {
    var r2 = this.interpreter, n2 = Date.now(), i2 = false;
    try {
      for (; r2.step(); ) if (Date.now() - n2 > t2) {
        i2 = true;
        break;
      }
    } catch (o3) {
      throw this.verbose && console.log(r2.stateStack), "string" == typeof o3 && (o3 = new Error(o3)), r2.stateStack.length > 0 && (o3.node = r2.stateStack[r2.stateStack.length - 1].node), o3;
    }
    if (i2) {
      var o2 = new Error("timeout: spent too long time (> " + t2 + "ms) to " + e2);
      throw r2.stateStack.length > 0 && (o2.node = r2.stateStack[0].node), o2;
    }
    return this.interpreter.value;
  }, t.prototype.cleanupProperties = function(t2) {
    if (!t2) return null;
    for (var e2 in this.ignoredPropNames.forEach(function(e3) {
      void 0 !== t2.properties[e3] && delete t2.properties[e3];
    }), t2.properties) this.cleanupProperty(t2.properties[e2]) || delete t2.properties[e2];
    return t2.properties;
  }, t.prototype.cleanupProperty = function(t2) {
    if (an(t2)) return true;
    var e2 = t2;
    if (e2._native) return true;
    var r2 = this.globalScope.properties;
    if (e2.parent === r2.Array) {
      for (var n2 = e2.length, i2 = 0; i2 < e2.length; i2++) this.cleanupProperty(e2.properties[i2]) || (delete e2.properties[i2], n2--);
      return e2.length = n2, n2 > 0;
    }
    if (e2.parent === r2.Object) {
      var o2 = true;
      for (var s2 in e2.properties) this.cleanupProperty(e2.properties[s2]) ? o2 = false : delete e2.properties[s2];
      return !o2;
    }
    return false;
  }, t.prototype.restoreProperties = function(t2, e2) {
    e2 && (t2.properties = on(on({}, t2.properties), e2));
  }, t.prototype.wrap = function(t2) {
    if ("object" == typeof t2 && null !== t2 && void 0 !== t2.constructor && "string" == typeof t2.constructor.className) {
      var e2 = t2.constructor.className, r2 = this.wrappers[e2];
      if (void 0 === r2) return;
      var n2 = this.interpreter.createObject(r2);
      return n2._native = t2, n2;
    }
    return this.verbose && (an(t2) || Array.isArray(t2) || console.log("wrap complex obj:", String(t2))), this.interpreter.nativeToPseudo(t2);
  }, t.prototype.unwrap = function(t2, e2) {
    return "object" == typeof t2 && null !== t2 && t2._native ? t2._native : this.interpreter.pseudoToNative(t2, e2);
  }, t.prototype.wrapClass = function(t2, e2) {
    this.verbose && console.log("--- wrapping " + e2 + " ---"), t2.className = e2;
    var r2 = this, n2 = this.interpreter.createNativeFunction(function(e3) {
      var i2, o2;
      if (i2 = r2.interpreter.calledWithNew() ? this : r2.interpreter.createObjectProto(n2.properties.prototype), void 0 !== e3) if (Array.isArray(e3)) for (var s2 = 0; s2 < e3.length; s2++) o2[s2] = r2.unwrap(e3[s2]);
      else o2 = r2.unwrap(e3);
      if (t2) {
        var a2 = Object.create(t2.prototype), u2 = t2.apply(a2, [null].concat(o2).splice(1));
        i2._native = null !== u2 && "object" == typeof u2 ? u2 : a2;
      }
      return i2;
    });
    return this.interpreter.setProperty(this.globalScope, e2, n2), this.wrapStaticMembers(n2, t2), this.wrapInstanceMembers(n2, t2), this.wrappers[e2] = n2, n2;
  }, t.prototype.wrapStaticMembers = function(t2, e2) {
    var r2 = this, n2 = function(n3) {
      var o3 = n3;
      if (i2.interpreter.setProperty(t2, n3, ReferenceError, { get: function() {
        return r2.wrap(e2[o3]);
      }, set: function(t3) {
        return e2[o3] = r2.unwrap(t3);
      } }), i2.verbose) {
        var s2 = void 0;
        try {
          s2 = typeof e2[o3];
        } catch (t3) {
          s2 = "not accessible";
        }
        console.log("static " + o3 + " (" + s2 + ")");
      }
    }, i2 = this;
    for (var o2 in e2) n2(o2);
  }, t.prototype.wrapInstanceMembers = function(t2, e2) {
    for (var r2, n2 = new e2(), i2 = 0, o2 = sn(sn([], Object.keys(n2)), function(t3) {
      for (var e3 = t3, r3 = []; e3 && e3.prototype; ) r3 = sn(sn([], r3), Object.getOwnPropertyNames(e3.prototype)), e3 = Object.getPrototypeOf(e3);
      return r3;
    }(e2)).filter(function(t3, e3, r3) {
      return r3.indexOf(t3) === e3;
    }); i2 < o2.length; i2++) {
      var s2 = o2[i2];
      if ("constructor" !== s2 && !this.interpreter.hasProperty(t2, s2) && !this.interpreter.hasProperty(t2.properties.prototype, s2) && "_" !== s2.charAt(0)) {
        if (this.verbose) {
          var a2 = void 0;
          try {
            a2 = typeof n2[s2];
          } catch (t3) {
            a2 = "not accessible";
          }
          r2 = s2 + " (" + a2 + ")";
        }
        try {
          if ("function" == typeof n2[s2]) {
            var u2 = /* @__PURE__ */ function(e3, r3) {
              return function(n3) {
                var i3;
                return r3.wrap((i3 = this._native)[e3].apply(i3, n3.map(function(e4) {
                  var n4 = r3.unwrap(e4);
                  return r3.wrapMethodParameter ? r3.wrapMethodParameter(t2, n4) : n4;
                })));
              };
            }(s2, this);
            this.interpreter.setProperty(t2.properties.prototype, s2, this.interpreter.createNativeFunction(u2)), this.verbose && (r2 += " native method");
          }
        } catch (t3) {
        }
        this.verbose && console.log(r2);
      }
    }
  }, t;
}();
function ln(t) {
  var e2 = parseFloat(t);
  return isNaN(e2) ? 0 : e2;
}
function pn(t) {
  var e2;
  if ("undefined" == typeof window || !(null === (e2 = null === window || void 0 === window ? void 0 : window.location) || void 0 === e2 ? void 0 : e2.search)) return null;
  for (var r2 = 0, n2 = window.location.search.substring(1).split("&"); r2 < n2.length; r2++) {
    var i2 = n2[r2].split("=");
    if (decodeURIComponent(i2[0]) === t) return decodeURIComponent(i2[1]);
  }
  return null;
}
var hn = function(t, e2) {
  return hn = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t2, e3) {
    t2.__proto__ = e3;
  } || function(t2, e3) {
    for (var r2 in e3) Object.prototype.hasOwnProperty.call(e3, r2) && (t2[r2] = e3[r2]);
  }, hn(t, e2);
};
function dn(t, e2) {
  if ("function" != typeof e2 && null !== e2) throw new TypeError("Class extends value " + String(e2) + " is not a constructor or null");
  function r2() {
    this.constructor = t;
  }
  hn(t, e2), t.prototype = null === e2 ? Object.create(e2) : (r2.prototype = e2.prototype, new r2());
}
var fn = function() {
  return fn = Object.assign || function(t) {
    for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++) for (var i2 in e2 = arguments[r2]) Object.prototype.hasOwnProperty.call(e2, i2) && (t[i2] = e2[i2]);
    return t;
  }, fn.apply(this, arguments);
};
function yn(t, e2, r2, n2) {
  return new (r2 || (r2 = Promise))(function(e3, i2) {
    function o2(t2) {
      try {
        a2(n2.next(t2));
      } catch (t3) {
        i2(t3);
      }
    }
    function s2(t2) {
      try {
        a2(n2.throw(t2));
      } catch (t3) {
        i2(t3);
      }
    }
    function a2(t2) {
      var n3;
      t2.done ? e3(t2.value) : (n3 = t2.value, n3 instanceof r2 ? n3 : new r2(function(t3) {
        t3(n3);
      })).then(o2, s2);
    }
    a2((n2 = n2.apply(t, [])).next());
  });
}
function gn(t, e2) {
  var r2, n2, i2, o2, s2 = { label: 0, sent: function() {
    if (1 & i2[0]) throw i2[1];
    return i2[1];
  }, trys: [], ops: [] };
  return o2 = { next: a2(0), throw: a2(1), return: a2(2) }, "function" == typeof Symbol && (o2[Symbol.iterator] = function() {
    return this;
  }), o2;
  function a2(a3) {
    return function(u2) {
      return function(a4) {
        if (r2) throw new TypeError("Generator is already executing.");
        for (; o2 && (o2 = 0, a4[0] && (s2 = 0)), s2; ) try {
          if (r2 = 1, n2 && (i2 = 2 & a4[0] ? n2.return : a4[0] ? n2.throw || ((i2 = n2.return) && i2.call(n2), 0) : n2.next) && !(i2 = i2.call(n2, a4[1])).done) return i2;
          switch (n2 = 0, i2 && (a4 = [2 & a4[0], i2.value]), a4[0]) {
            case 0:
            case 1:
              i2 = a4;
              break;
            case 4:
              return s2.label++, { value: a4[1], done: false };
            case 5:
              s2.label++, n2 = a4[1], a4 = [0];
              continue;
            case 7:
              a4 = s2.ops.pop(), s2.trys.pop();
              continue;
            default:
              if (!((i2 = (i2 = s2.trys).length > 0 && i2[i2.length - 1]) || 6 !== a4[0] && 2 !== a4[0])) {
                s2 = 0;
                continue;
              }
              if (3 === a4[0] && (!i2 || a4[1] > i2[0] && a4[1] < i2[3])) {
                s2.label = a4[1];
                break;
              }
              if (6 === a4[0] && s2.label < i2[1]) {
                s2.label = i2[1], i2 = a4;
                break;
              }
              if (i2 && s2.label < i2[2]) {
                s2.label = i2[2], s2.ops.push(a4);
                break;
              }
              i2[2] && s2.ops.pop(), s2.trys.pop();
              continue;
          }
          a4 = e2.call(t, s2);
        } catch (t2) {
          a4 = [6, t2], n2 = 0;
        } finally {
          r2 = i2 = 0;
        }
        if (5 & a4[0]) throw a4[1];
        return { value: a4[0] ? a4[1] : void 0, done: true };
      }([a3, u2]);
    };
  }
}
function vn(t, e2, r2) {
  if (2 === arguments.length) for (var n2, i2 = 0, o2 = e2.length; i2 < o2; i2++) !n2 && i2 in e2 || (n2 || (n2 = Array.prototype.slice.call(e2, 0, i2)), n2[i2] = e2[i2]);
  return t.concat(n2 || Array.prototype.slice.call(e2));
}
var mn;
var bn;
var _n = [0, 0, 0, 0];
var wn = function() {
  function t() {
    this._position = 0, this._wait = 50, this.update = this.update.bind(this);
  }
  return Object.defineProperty(t.prototype, "wait", { get: function() {
    return this._wait;
  }, set: function(t2) {
    this._wait = t2, this._isPlaying && this.start();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "isPlaying", { get: function() {
    return this._isPlaying;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "position", { get: function() {
    if (!this.isPlaying) return this._position;
    var t2 = this.basePosition.position + (Date.now() - this.basePosition.time);
    return Math.min(t2, this.player.video.duration);
  }, enumerable: false, configurable: true }), t.prototype.initialize = function(t2) {
    var e2 = t2.player, r2 = t2.updater, n2 = t2.emitter;
    return yn(this, 0, void 0, function() {
      return gn(this, function(t3) {
        return this.player = e2, this.updateMediaPosition = r2, this.emitter = n2, [2];
      });
    });
  }, t.prototype.play = function() {
    this.start(), this.emitter.onPlay();
  }, t.prototype.stop = function() {
    this.clearInterval(), this._isPlaying = false, this.seek(0), this.pause(), this.emitter.onStop();
  }, t.prototype.pause = function() {
    this.clearInterval(), this._isPlaying = false, this.emitter.onPause();
  }, t.prototype.seek = function(t2) {
    var e2 = this;
    this._position = t2, this.updateMediaPosition(t2).then(function() {
      e2.emitter.onSeek(t2), e2.emitter.onSeekComplete(t2);
    }), this.isPlaying && this.start();
  }, t.prototype.dispose = function() {
    this.clearInterval();
  }, t.prototype.clearInterval = function() {
    window.clearInterval(this.intervalId);
  }, t.prototype.start = function() {
    this.clearInterval(), this._isPlaying = true, this.basePosition = { time: Date.now(), position: this._position }, this.intervalId = window.setInterval(this.update, this.wait);
  }, t.prototype.update = function() {
    this.player.video || this.stop();
    var t2 = this.basePosition.position + (Date.now() - this.basePosition.time);
    this._position = Math.min(t2, this.player.video.duration), this.updateMediaPosition(this.position), this._position >= this.player.video.duration && this.stop();
  }, t;
}();
function Pn() {
  return yn(this, 0, void 0, function() {
    return gn(this, function(t) {
      return bn && bn.Player ? [2, bn] : "undefined" == typeof window ? [2, import("./main-2OU35ICR.js")] : window.Songle && window.Songle.Player ? [2, window.Songle] : (mn || (mn = new Promise(function(t2) {
        var e2 = false;
        window.onSongleAPIReady = function(r2) {
          e2 = true, t2(bn = r2);
        }, setTimeout(function() {
          if (!e2) {
            var t3 = [];
            document.querySelectorAll("script").forEach(function(e3) {
              var r3 = e3.getAttribute("src");
              r3 && r3.indexOf("songle.jp/v2/api.js") >= 0 && t3.push(e3);
            }), t3.forEach(function(t4) {
              return t4.parentElement.removeChild(t4);
            });
            var r2 = document.createElement("script");
            r2.src = "https://api.songle.jp/v2/api.js", document.head.appendChild(r2);
          }
        }, 1e3);
      })), [2, mn]);
    });
  });
}
var En = function() {
  function t(t2) {
    void 0 === t2 && (t2 = {}), this.options = t2, this.wait = 50, this.volumeListener = { onVolumeUpdate: this.onVolumeUpdate.bind(this) }, this.resetProps();
  }
  return Object.defineProperty(t.prototype, "songlePlayer", { get: function() {
    return this._songlePlayer;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "isPlaying", { get: function() {
    return !!this._songlePlayer && this._songlePlayer.isPlaying;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "withSync", { get: function() {
    var t2, e2;
    return !(!(null === (t2 = this.options) || void 0 === t2 ? void 0 : t2.accessToken) && !(null === (e2 = this.options) || void 0 === e2 ? void 0 : e2.secretToken));
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "position", { get: function() {
    var t2;
    if (!this._songlePlayer) return 0;
    if (this.lastPosition > 0 && this.lastTime > 0) return Date.now() + this.lastPosition - this.lastTime;
    var e2 = this._songlePlayer.positionTime;
    if ("songle-api-html-media-element-media" === (null === (t2 = this._songlePlayer.media) || void 0 === t2 ? void 0 : t2.dispatcherName)) {
      var r2 = this.lastTime, n2 = this.lastPosition, i2 = void 0;
      if (r2 > 0) {
        var o2 = Date.now() - r2;
        i2 = Math.max(0, this.wait - o2);
      } else i2 = this.wait;
      0 === n2 && e2 >= 500 ? e2 = 0 : 0 === r2 && e2 - n2 >= 800 && (e2 = n2 + i2);
    }
    return e2;
  }, enumerable: false, configurable: true }), t.prototype.initialize = function(t2) {
    var e2, r2, n2, i2, o2 = t2.player, s2 = t2.updater, a2 = t2.emitter, u2 = t2.altSourceUrl;
    return yn(this, 0, void 0, function() {
      var t3, l2, p2;
      return gn(this, function(h2) {
        switch (h2.label) {
          case 0:
            return this.player && this.player.removeListener(this.volumeListener), this.player = o2, this.player.addListener(this.volumeListener), this.updateMediaPosition = s2, this.emitter = a2, this._songlePlayer ? [3, 2] : [4, this.initializeSonglePlayer()];
          case 1:
            h2.sent(), h2.label = 2;
          case 2:
            return t3 = this.options.headless, l2 = u2 || this.options.altSourceUrls && (null === (e2 = this.player.data.song) || void 0 === e2 ? void 0 : e2.permalink) && this.options.altSourceUrls[null === (r2 = this.player.data.song) || void 0 === r2 ? void 0 : r2.permalink] || (null === (n2 = this.player.data.song) || void 0 === n2 ? void 0 : n2.permalink) || void 0, c.isUploaderUrl(l2) && (l2 = c.getAltSongUrlFromUploaderGuid(c.getUploaderGuid(c.getSongPathFromUrl(l2)))), (p2 = (null === (i2 = this.player.data.song) || void 0 === i2 ? void 0 : i2.permalink) || l2) === l2 && (l2 = void 0), [4, this._songlePlayer.useMedia(p2, { headless: t3, altSourceUrl: l2 })];
          case 3:
            return h2.sent(), this.ignoreSonglePlayerEvents = true, this._songlePlayer.volume = 0 * (1 - this.player.volume / 100) + 100 * this.player.volume / 100, this._songlePlayer.play(), this._songlePlayer.stop(), this.ignoreSonglePlayerEvents = false, this.resetProps(), [2];
        }
      });
    });
  }, t.prototype.resetProps = function() {
    this.lastPosition = 0, this.lastTime = 0, this.elapsedTimes = [];
  }, t.prototype.initializeSonglePlayer = function() {
    var t2;
    return yn(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2, u2 = this;
      return gn(this, function(c2) {
        switch (c2.label) {
          case 0:
            return e2 = this.options, r2 = e2.accessToken, n2 = e2.secretToken, (o2 = this.options.songle) ? [3, 2] : [4, Pn()];
          case 1:
            o2 = c2.sent(), c2.label = 2;
          case 2:
            return (i2 = o2).System && (i2.System.showLicense = false), s2 = null === (t2 = this.options) || void 0 === t2 ? void 0 : t2.autoUseMedia, this._songlePlayer = this.withSync ? new i2.SyncPlayer({ mediaElement: this.player.mediaSourceElement, accessToken: r2, secretToken: n2, autoUseMedia: s2 }) : new i2.Player({ mediaElement: this.player.mediaSourceElement }), a2 = false, this._songlePlayer.on("play", function() {
              u2.ignoreSonglePlayerEvents || (a2 = false, u2.handler || (u2.startPolling(), u2.emitter.onPlay()));
            }), this._songlePlayer.on("pause", function() {
              return yn(u2, 0, void 0, function() {
                return gn(this, function(t3) {
                  switch (t3.label) {
                    case 0:
                      return this.ignoreSonglePlayerEvents ? [2] : (a2 = false, this.stopPolling(), this.emitter.onPause(), this.stopping ? (this.stopping = false, [4, this.updateMediaPosition(0)]) : [3, 2]);
                    case 1:
                      t3.sent(), this.resetProps(), this.emitter.onStop(), t3.label = 2;
                    case 2:
                      return [2];
                  }
                });
              });
            }), this._songlePlayer.on("finish", function() {
              return yn(u2, 0, void 0, function() {
                return gn(this, function(t3) {
                  switch (t3.label) {
                    case 0:
                      return a2 = false, this.handler ? (this.stopPolling(), [4, this.updateMediaPosition(0)]) : [3, 2];
                    case 1:
                      t3.sent(), this.emitter.onStop(), t3.label = 2;
                    case 2:
                      return [2];
                  }
                });
              });
            }), this._songlePlayer.on("seek", function(t3) {
              var e3 = t3.data;
              return yn(u2, 0, void 0, function() {
                return gn(this, function(t4) {
                  switch (t4.label) {
                    case 0:
                      return this._songlePlayer.isPlaying ? [3, 2] : (a2 = false, [4, this.updateMediaPosition(e3.positionTime)]);
                    case 1:
                      return t4.sent(), this.emitter.onSeekComplete(e3.positionTime), [3, 4];
                    case 2:
                      return a2 = true, [4, this.updateMediaPosition(this._songlePlayer.positionTime)];
                    case 3:
                      t4.sent(), t4.label = 4;
                    case 4:
                      return [2];
                  }
                });
              });
            }), this._songlePlayer.on("mediaSeek", function() {
              a2 && (u2.emitter.onSeekComplete(u2.position), a2 = false);
            }), this.withSync && (this._songlePlayer.on("mediaPlay", function() {
              u2.handler || (u2.startPolling(), u2.emitter.onPlay());
            }), this._songlePlayer.on("mediaFinish", function() {
              u2.handler && (u2.stopPolling(), u2.emitter.onStop());
            })), [2];
        }
      });
    });
  }, t.prototype.play = function() {
    if (this._songlePlayer) return this._songlePlayer.play();
    this.emitter.onPlay();
  }, t.prototype.stop = function() {
    if (this._songlePlayer) return this.stopping = this._songlePlayer.isPlaying, this._songlePlayer.stop();
    this.emitter.onStop();
  }, t.prototype.pause = function() {
    if (this._songlePlayer) return this.stopping = false, this._songlePlayer.pause();
    this.emitter.onPause();
  }, t.prototype.seek = function(t2) {
    var e2 = this;
    this._songlePlayer ? (this._songlePlayer.seekTo(t2), this.emitter.onSeek(t2)) : this.updateMediaPosition(t2).then(function() {
      e2.emitter.onSeek(t2);
    });
  }, t.prototype.startPolling = function() {
    var t2, e2 = this;
    if (this.lastTime > 0) {
      var r2 = Date.now() - this.lastTime;
      t2 = Math.max(0, this.wait - r2);
    } else t2 = this.wait;
    this.handler = setTimeout(function() {
      return yn(e2, 0, void 0, function() {
        var e3, r3, n2, i2, o2, s2, a2, u2, c2;
        return gn(this, function(l2) {
          switch (l2.label) {
            case 0:
              return this._songlePlayer ? (r3 = (e3 = this).lastTime, n2 = e3.lastPosition, i2 = this._songlePlayer.positionTime, o2 = false, "songle-api-html-media-element-media" === (null === (c2 = this._songlePlayer.media) || void 0 === c2 ? void 0 : c2.dispatcherName) && (0 === n2 && i2 >= 500 ? (i2 = 0, o2 = true) : 0 === r3 && i2 - n2 >= 800 && (i2 = n2 + t2, o2 = true)), s2 = r3 > 0 ? Date.now() - r3 : t2, this.updateElapsedTimes(s2), a2 = n2 > 0 ? n2 + s2 : i2, u2 = Math.abs(i2 - a2), (a2 = u2 > 2 * this.wait ? i2 : a2 <= i2 ? 0.5 * (a2 + i2) : Math.max(n2, i2)) < this.lastPosition && (this.lastPosition - a2 > 5 * this.wait || (a2 = this.lastPosition)), o2 || (this.lastTime = Date.now()), this.lastPosition = a2, [4, this.updateMediaPosition(a2)]) : [2];
            case 1:
              return l2.sent(), this.handler && this.startPolling(), [2];
          }
        });
      });
    }, t2);
  }, t.prototype.updateElapsedTimes = function(t2) {
    if (this.elapsedTimes.unshift(t2), this.elapsedTimes = this.elapsedTimes.slice(0, 10), this.elapsedTimes.length >= 10) {
      var e2 = this.elapsedTimes.reduce(function(t3, e3) {
        return t3 + e3;
      }) / 10;
      e2 > 5 * this.wait && (this.player.stageScale = Math.max(0.25, 0.9 * this.player.stageScale), this.elapsedTimes = []), e2 < 1.2 * this.wait && this.player.stageScale < 1 && (this.player.stageScale = Math.min(1, this.player.stageScale / 0.9), this.elapsedTimes = []);
    }
  }, t.prototype.stopPolling = function() {
    var t2;
    if (this.handler) {
      if (clearTimeout(this.handler), this._songlePlayer) if ("songle-api-html-media-element-media" === (null === (t2 = this._songlePlayer.media) || void 0 === t2 ? void 0 : t2.dispatcherName)) {
        var e2 = this.lastTime, r2 = this.lastPosition, n2 = Date.now() - e2;
        this.lastPosition = r2 + n2;
      } else this.lastPosition = this._songlePlayer.positionTime;
      this.lastTime = 0;
    }
    this.handler = null;
  }, t.prototype.dispose = function() {
    if (this.player && this.player.removeListener(this.volumeListener), this._songlePlayer) {
      try {
        this._songlePlayer.stop();
      } catch (t2) {
      }
      this._songlePlayer = null;
    }
  }, t.prototype.onVolumeUpdate = function(t2) {
    this._songlePlayer && (this._songlePlayer.volume = t2);
  }, t;
}();
var On = function() {
  function t(t2) {
    this.listeners = [], this.throttleInterval = t2 && t2.throttleInterval ? Number(t2.throttleInterval) : 100;
  }
  return t.prototype.onVideoLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onVideoLoad && r2.onVideoLoad(t2, e2);
    });
  }, t.prototype.onSongLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onSongLoad && r2.onSongLoad(t2, e2);
    });
  }, t.prototype.onSongMapLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onSongMapLoad && r2.onSongMapLoad(t2, e2);
    });
  }, t.prototype.onSongInfoLoad = function(t2, e2) {
    var r2 = false;
    this.listeners.forEach(function(n2) {
      n2.onSongInfoLoad && (n2.onSongInfoLoad(t2, e2), r2 = true);
    }), r2 && console.warn('[TextAlive API] "onSongInfoLoad" event is deprecated; use "onSongMapLoad" event instead');
  }, t.prototype.onVocalAmplitudeLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onVocalAmplitudeLoad && r2.onVocalAmplitudeLoad(t2, e2);
    });
  }, t.prototype.onValenceArousalLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onValenceArousalLoad && r2.onValenceArousalLoad(t2, e2);
    });
  }, t.prototype.onLyricsLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onLyricsLoad && r2.onLyricsLoad(t2, e2);
    });
  }, t.prototype.onTextLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onTextLoad && r2.onTextLoad(t2, e2);
    });
  }, t.prototype.onAppLoad = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onAppLoad && e2.onAppLoad(t2);
    });
  }, t.prototype.onAppReady = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onAppReady && e2.onAppReady(t2);
    });
  }, t.prototype.onAppParameterUpdate = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onAppParameterUpdate && r2.onAppParameterUpdate(t2, e2);
    });
  }, t.prototype.onAppMediaChange = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onAppMediaChange && r2.onAppMediaChange(t2, e2);
    });
  }, t.prototype.onTemplateUpdate = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onTemplateUpdate && e2.onTemplateUpdate(t2);
    });
  }, t.prototype.onTemplateCommit = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onTemplateCommit && e2.onTemplateCommit(t2);
    });
  }, t.prototype.onTemplatesLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onTemplatesLoad && r2.onTemplatesLoad(t2, e2);
    });
  }, t.prototype.onFontsLoad = function(t2, e2) {
    this.listeners.forEach(function(r2) {
      return r2.onFontsLoad && r2.onFontsLoad(t2, e2);
    });
  }, t.prototype.onVideoReady = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onVideoReady && e2.onVideoReady(t2);
    });
  }, t.prototype.onTimerReady = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onTimerReady && e2.onTimerReady(t2);
    });
  }, t.prototype.onStageElementSet = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onStageElementSet && e2.onStageElementSet(t2);
    });
  }, t.prototype.onMediaElementSet = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onMediaElementSet && e2.onMediaElementSet(t2);
    });
  }, t.prototype.onTimeUpdate = function(t2) {
    var e2 = this;
    this.listeners.forEach(function(e3) {
      return e3.onTimeUpdate && e3.onTimeUpdate(t2);
    }), this.position = t2, this.throttledTimeUpdate || (this.throttledTimeUpdate = new Promise(function(t3, r2) {
      setTimeout(function() {
        e2.onThrottledTimeUpdate(e2.position), e2.throttledTimeUpdate = null, t3();
      }, e2.throttleInterval);
    }));
  }, t.prototype.onThrottledTimeUpdate = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onThrottledTimeUpdate && e2.onThrottledTimeUpdate(t2);
    });
  }, t.prototype.onBackgroundGraphicsUpdate = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onBackgroundGraphicsUpdate && e2.onBackgroundGraphicsUpdate(t2);
    });
  }, t.prototype.onMediaSeek = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onMediaSeek && e2.onMediaSeek(t2);
    });
  }, t.prototype.onVideoSeekStart = function() {
    this.listeners.forEach(function(t2) {
      return t2.onVideoSeekStart && t2.onVideoSeekStart();
    });
  }, t.prototype.onVideoSeekEnd = function() {
    this.listeners.forEach(function(t2) {
      return t2.onVideoSeekEnd && t2.onVideoSeekEnd();
    });
  }, t.prototype.onVideoSeek = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onVideoSeek && e2.onVideoSeek(t2);
    });
  }, t.prototype.onPlay = function() {
    this.listeners.forEach(function(t2) {
      return t2.onPlay && t2.onPlay();
    });
  }, t.prototype.onPause = function() {
    this.listeners.forEach(function(t2) {
      return t2.onPause && t2.onPause();
    });
  }, t.prototype.onSeek = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onSeek && e2.onSeek(t2);
    });
  }, t.prototype.onSeekComplete = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onSeekComplete && e2.onSeekComplete(t2);
    });
  }, t.prototype.onStop = function() {
    this.listeners.forEach(function(t2) {
      return t2.onStop && t2.onStop();
    });
  }, t.prototype.onDispose = function() {
    this.listeners.forEach(function(t2) {
      return t2.onDispose && t2.onDispose();
    });
  }, t.prototype.onResize = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onResize && e2.onResize(t2);
    });
  }, t.prototype.onVolumeUpdate = function(t2) {
    this.listeners.forEach(function(e2) {
      return e2.onVolumeUpdate && e2.onVolumeUpdate(t2);
    });
  }, t.prototype.addListener = function(t2) {
    !t2 || this.listeners.indexOf(t2) >= 0 || this.listeners.push(t2);
  }, t.prototype.removeListener = function(t2) {
    var e2 = false;
    return this.listeners = this.listeners.filter(function(r2) {
      var n2 = r2 === t2;
      return e2 = e2 || n2, !n2;
    }), e2;
  }, t;
}();
var Sn = function() {
  function t(t2, e2, r2) {
    var n2 = this;
    this.player = t2, this.manager = e2, this.emitter = r2, this._defaultBackgroundCss = null, this._background = null, t2.addListener({ onStageElementSet: function(t3) {
      return n2.doUpdateBackground(n2.background);
    } });
  }
  return Object.defineProperty(t.prototype, "background", { get: function() {
    return this._background;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "defaultBackgroundCss", { get: function() {
    return this._defaultBackgroundCss ? this._defaultBackgroundCss : "";
  }, set: function(t2) {
    this._defaultBackgroundCss = t2, this.updateBackground(this._background);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "ready", { get: function() {
    return null !== this._background;
  }, enumerable: false, configurable: true }), t.prototype.settingBackground = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        switch (e2.label) {
          case 0:
            return [4, this.doSetBackground(t2)];
          case 1:
            return [2, e2.sent() && this.doUpdateBackground(t2)];
        }
      });
    });
  }, t.prototype.setBackground = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2;
      return gn(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, this.doSetBackground(t2)];
          case 1:
            return [2, (e2 = r2.sent()) && this.updateBackground(e2)];
        }
      });
    });
  }, t.prototype.doSetBackground = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2;
      return gn(this, function(i2) {
        switch (i2.label) {
          case 0:
            return e2 = t2 && t2.originalUrl ? t2.originalUrl : "", this.manager.isBackgroundColorAsset(t2) ? [2, { css: e2, originalUrl: e2 }] : this.manager.isBackgroundPiaproImageAsset(t2) ? [4, this.manager.read(e2)] : [3, 2];
          case 1:
            return (r2 = i2.sent()) && r2.url && this.manager.checkBackgroundImageLicense(r2.license) ? (r2.originalUrl = e2, t2 && (r2.x = t2.x, r2.y = t2.y), [2, r2]) : [2, { css: "", originalUrl: e2, x: t2 ? t2.x : void 0, y: t2 ? t2.y : void 0, license: r2 ? r2.license : void 0 }];
          case 2:
            return this.manager.isBackgroundSpecialImageAsset(t2) ? [2, { css: 'url("https://api.textalive.jp/images/backgrounds/snowmiku2016/' + (n2 = /^snowmiku2016-([0-9]{2})$/.exec(e2))[1] + '.jpg")', contentUrl: "https://api.textalive.jp/images/backgrounds/snowmiku2016/" + n2[1] + ".jpg", url: "https://snowmiku.com/2016/info_chara.html", name: "SNOW MIKU 2016", authorName: "", originalUrl: e2, x: t2 ? t2.x : void 0, y: t2 ? t2.y : void 0, defaultY: 0 }] : [2, { originalUrl: null, css: "", x: t2 ? t2.x : void 0, y: t2 ? t2.y : void 0 }];
        }
      });
    });
  }, t.prototype.updateBackground = function(t2) {
    return !!this.doUpdateBackground(t2) && (this.emitter && this.emitter.onBackgroundGraphicsUpdate && this.emitter.onBackgroundGraphicsUpdate(t2), true);
  }, t.prototype.doUpdateBackground = function(t2) {
    if (!t2) return false;
    if (!this.player.stageElement) return this._background = t2, true;
    var e2 = this.player.stageElement.style;
    return t2.css.length <= 0 ? e2.background = this.defaultBackgroundCss : e2.background = t2.css, "number" == typeof t2.x || this._background && "number" == typeof this._background.x ? ("number" != typeof t2.x && (t2.x = this._background.x), e2.backgroundPositionX = e2.backgroundPositionX + "%") : e2.backgroundPositionX = "number" == typeof t2.defaultX ? t2.defaultX + "%" : "center", "number" == typeof t2.y || this._background && "number" == typeof this._background.y ? ("number" != typeof t2.y && (t2.y = this._background.y), e2.backgroundPositionY = e2.backgroundPositionY + "%") : e2.backgroundPositionY = "number" == typeof t2.defaultY ? t2.defaultY + "%" : "center", e2.backgroundSize = "cover", this._background = t2, true;
  }, t.prototype.export = function() {
    if (!this.background || !this.background.originalUrl) return null;
    var t2 = { originalUrl: this.background.originalUrl };
    return void 0 !== this.background.x && (t2.x = this.background.x), void 0 !== this.background.y && (t2.y = this.background.y), t2;
  }, t.prototype.exportPartialVideoEntry = function(t2) {
    return { background: this.export() };
  }, t;
}();
function Tn(t, e2, r2) {
  return yn(this, 0, void 0, function() {
    var n2, i2, o2, s2, a2, u2, c2, l2, p2, h2, d2, f2, y2, g2;
    return gn(this, function(v2) {
      switch (v2.label) {
        case 0:
          if (n2 = { loaded: [], failed: [] }, "undefined" == typeof window || !window.document || !window.document.head) return n2.failed = t.slice(), [2, n2];
          for (i2 = r2.split("").filter(function(t2, e3, r3) {
            return r3.indexOf(t2) === e3;
          }).sort(), o2 = true, s2 = 0, i2.forEach(function(t2) {
            var r3 = e2.indexOf(t2, s2);
            o2 = o2 && r3 >= 0, s2 = r3;
          }), a2 = window.document.head, u2 = [], c2 = 0; c2 < a2.children.length; c2++) "link" === (l2 = a2.children.item(c2)).tagName.toLowerCase() && "stylesheet" === l2.getAttribute("rel") && u2.push(l2.getAttribute("href"));
          if (p2 = [], h2 = [], d2 = [], t.forEach(function(t2) {
            if (t2.google) d2.push(t2.key);
            else {
              var e3 = o2 && t2.compactUrl || t2.url;
              u2.includes(e3) ? n2.loaded.push(t2) : (h2.push(t2.en), p2.push(e3));
            }
          }), f2 = { classes: false, active: null, inactive: null, fontactive: function(e3) {
            n2.loaded.push(t.find(function(t2) {
              return t2.en === e3;
            })), n2.failed = n2.failed.filter(function(t2) {
              return t2.en !== e3;
            });
          }, fontinactive: function(e3) {
            n2.failed.push(t.find(function(t2) {
              return t2.en === e3;
            }));
          }, timeout: 5e3 }, d2.length > 0 && (f2.google = { families: d2 }), h2.length > 0 && (f2.custom = { families: h2, urls: p2 }), !f2.google && !f2.custom) return [3, 6];
          v2.label = 1;
        case 1:
          return v2.trys.push([1, 5, , 6]), (g2 = "undefined" != typeof window && (null === window || void 0 === window ? void 0 : window.WebFont)) ? [3, 3] : [4, import("./webfontloader-E5SZR5U7.js")];
        case 2:
          g2 = v2.sent(), v2.label = 3;
        case 3:
          return y2 = g2, [4, new Promise(function(t2) {
            f2.active = f2.inactive = t2, y2.load(f2);
          })];
        case 4:
        case 5:
          return v2.sent(), [3, 6];
        case 6:
          return [2, n2];
      }
    });
  });
}
function xn(t, e2) {
  return yn(this, 0, void 0, function() {
    var r2, n2, i2, o2, s2, a2, u2;
    return gn(this, function(c2) {
      switch (c2.label) {
        case 0:
          if (r2 = { loaded: [], failed: [] }, !("undefined" != typeof window && window.document && window.document.head && window.Ts && window.Ts.loadFontAsync)) return r2.failed = t.slice(), [2, r2];
          for (n2 = window.document.head, i2 = {}, o2 = function(t2) {
            var e3 = n2.children.item(t2);
            if ("style" !== e3.tagName.toLowerCase() || "text/css" !== e3.getAttribute("type") || "stylesheet" !== e3.getAttribute("rel") || !e3.hasAttribute("data-cssName")) return "continue";
            var r3 = e3.getAttribute("data-cssName");
            if (void 0 === i2[r3]) return i2[r3] = new Set(e3.getAttribute("data-text")), "continue";
            e3.getAttribute("data-text").split("").forEach(function(t3) {
              return i2[r3].add(t3);
            });
          }, s2 = 0; s2 < n2.children.length; s2++) o2(s2);
          return a2 = window.Ts, u2 = [], t.forEach(function(t2) {
            var n3 = new Set(e2 + t2.en + t2.ja);
            if (i2[t2.en] && i2[t2.en].forEach(function(t3) {
              return n3.delete(t3);
            }), n3.size <= 0) return r2.loaded.push(t2), r2;
            u2.push(new Promise(function(e3) {
              return function(t3, e4, r3, n4, i3) {
                var o3 = e4.en;
                t3.loadFontAsync({ cssName: o3, text: n4, outputType: "json", callback: function(t4) {
                  try {
                    !function(t5, e5, r4) {
                      var n5 = JSON.parse(r4), i4 = JSON.parse(n5.res), o4 = document.createElement("style");
                      o4.setAttribute("data-cssName", t5), o4.setAttribute("data-text", e5), o4.setAttribute("type", "text/css"), o4.setAttribute("rel", "stylesheet"), o4.innerHTML = "@font-face {font-family: '" + i4.fontFamily + "';font-weight: " + i4["font-weight"] + ";src: url(data:font/woff;base64," + i4.src + ");}", document.head.appendChild(o4);
                    }(o3, n4, t4.data), r3.loaded.push(e4);
                  } catch (t5) {
                    r3.failed.push(e4);
                  }
                  i3();
                } });
              }(a2, t2, r2, Array.from(n3.values()).join(""), e3);
            }));
          }), [4, Promise.all(u2)];
        case 1:
          return c2.sent(), [2, r2];
      }
    });
  });
}
var An = function(t) {
  function e2(e3, r2) {
    var n2 = this.constructor, i2 = t.call(this, e3) || this;
    return i2.fonts = r2, Object.setPrototypeOf(i2, n2.prototype), i2;
  }
  return dn(e2, t), e2;
}(Error);
var Rn = function() {
  function t(t2, e2, r2) {
    this.fontInfoManager = t2, this.textFetcher = e2, this.listener = r2, this._failed = [], this._loaded = [];
  }
  return Object.defineProperty(t.prototype, "failed", { get: function() {
    return this._failed;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "loaded", { get: function() {
    return this._loaded;
  }, enumerable: false, configurable: true }), t.prototype.loadAll = function() {
    return yn(this, 0, void 0, function() {
      var t2;
      return gn(this, function(e2) {
        switch (e2.label) {
          case 0:
            return [4, this.listAvailableFonts()];
          case 1:
            return t2 = e2.sent(), [2, this.loadFonts(t2)];
        }
      });
    });
  }, t.prototype.loadForVideo = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return (e2 = this.listFontFamiliesInVideo(t2)) ? [4, this.listAvailableFonts()] : (this.listener && this.listener.onFontsLoad && this.listener.onFontsLoad(this.loaded), [2, Promise.resolve(this.loaded)]);
          case 1:
            return r2 = n2.sent(), [2, this.loadFonts(r2.filter(function(t3) {
              return e2.indexOf(t3.en) >= 0;
            }))];
        }
      });
    });
  }, t.prototype.listFontFamiliesInVideo = function(t2) {
    if (!t2 || !t2.phrases) return null;
    var e2 = [];
    return t2.phrases.forEach(function(t3) {
      return t3.words.forEach(function(t4) {
        return t4.characters.forEach(function(t5) {
          return e2.push(t5.fontFamily);
        });
      });
    }), e2.filter(function(t3, e3, r2) {
      return r2.indexOf(t3) === e3;
    });
  }, t.prototype.listAvailableFonts = function() {
    return yn(this, 0, void 0, function() {
      return gn(this, function(t2) {
        return [2, this.fontInfoManager.listAvailableFonts()];
      });
    });
  }, t.prototype.isLoading = function() {
    return !!this.queue;
  }, t.prototype.load = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return e2 = [], r2 = [], t2.forEach(function(t3) {
              "string" == typeof t3 ? e2.push(t3) : r2.push(t3);
            }), [4, this.fontInfoManager.listAvailableFonts()];
          case 1:
            return n2.sent().forEach(function(t3) {
              e2.indexOf(t3.key) >= 0 && r2.push(t3);
            }), [2, this.loadFonts(r2)];
        }
      });
    });
  }, t.prototype.loadFonts = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2 = this;
      return gn(this, function(r2) {
        return this.queue ? (this.listener && this.listener.onFontsLoad && this.listener.onFontsLoad(null, new An("Failed to load some fonts because there is an ongoing font loding process", this.failed.slice())), [2, this.loaded]) : (this.queue = this.doLoad(t2).then(function(t3) {
          return e2.queue = null, t3;
        }), [2, this.queue]);
      });
    });
  }, t.prototype.doLoad = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2 = this;
      return gn(this, function(s2) {
        switch (s2.label) {
          case 0:
            return e2 = [], r2 = [], [4, this.fontInfoManager.getFrequentChars()];
          case 1:
            return n2 = s2.sent(), t2.forEach(function(t3) {
              t3.typesquare || t3.typekit || e2.push(t3), t3.typesquare && r2.push(t3);
            }), i2 = (this.textFetcher && this.textFetcher() || "").split("").filter(function(t3, e3, r3) {
              return r3.indexOf(t3) === e3;
            }).sort().join(""), [2, Promise.all([Tn(e2, n2, i2), xn(r2, i2)]).then(function(t3) {
              var e3 = t3[0], r3 = t3[1], n3 = e3.loaded.concat(r3.loaded);
              if (o2.addLoadedFonts(n3), e3.failed.length > 0 || r3.failed.length > 0) {
                var i3 = e3.failed.concat(r3.failed);
                o2.addFailedFonts(i3), o2.listener && o2.listener.onFontsLoad && o2.listener.onFontsLoad(null, new An("Failed to load some fonts", o2.failed.slice()));
              } else o2.listener && o2.listener.onFontsLoad && o2.listener.onFontsLoad(n3);
              return o2.loaded;
            }).catch(function(t3) {
              return o2.listener && o2.listener.onFontsLoad && o2.listener.onFontsLoad(null, new An(t3, o2.failed.slice())), o2.loaded;
            })];
        }
      });
    });
  }, t.prototype.addLoadedFonts = function(t2) {
    var e2 = this;
    this._loaded = this.loaded.concat(t2.filter(function(t3) {
      return e2.failed.findIndex(function(e3) {
        return e3.key === t3.key;
      }) < 0;
    }));
  }, t.prototype.addFailedFonts = function(t2) {
    var e2 = this;
    this._failed = this.failed.concat(t2.filter(function(t3) {
      return e2.failed.findIndex(function(e3) {
        return e3.key === t3.key;
      }) < 0;
    }));
  }, t;
}();
var Cn = function() {
  function t() {
  }
  return Object.defineProperty(t.prototype, "duration", { get: function() {
    return this.endTime - this.startTime;
  }, enumerable: false, configurable: true }), t.prototype.contains = function(t2) {
    return t2 >= this.startTime && t2 <= this.endTime;
  }, t.prototype.overlaps = function(t2, e2) {
    if ("object" == typeof t2) return this.overlaps(t2.startTime, t2.endTime);
    var r2 = t2;
    return this.contains(r2) || this.contains(e2) || this.startTime <= r2 && this.endTime >= e2;
  }, t.prototype.progress = function(t2) {
    return this.contains(t2) ? this.startTime === this.endTime ? 0 : (t2 - this.startTime) / (this.endTime - this.startTime) : -1;
  }, t;
}();
var Nn = function(t) {
  function e2() {
    var e3 = t.call(this) || this;
    return e3.previous = e3.next = null, e3;
  }
  return dn(e2, t), Object.defineProperty(e2.prototype, "endTime", { get: function() {
    return this.next ? this.next.startTime : this.startTime;
  }, enumerable: false, configurable: true }), e2;
}(Cn);
var kn = function(t) {
  function e2() {
    var e3 = t.call(this) || this;
    return e3.previous = e3.next = null, e3;
  }
  return dn(e2, t), e2;
}(Cn);
var jn = function(t) {
  function e2() {
    var e3 = t.call(this) || this;
    return e3.previous = e3.next = null, e3;
  }
  return dn(e2, t), e2;
}(Cn);
var In = function(t) {
  function e2() {
    var e3 = t.call(this) || this;
    return e3.previous = e3.next = null, e3;
  }
  return dn(e2, t), e2;
}(Cn);
var Un = function() {
  function t(t2) {
    var e2 = t2.analysis, r2 = t2.info;
    this.beats = [], this.chords = [], this.segments = [], this.voice = [], this._revisions = { beatId: (null == r2 ? void 0 : r2.beatRevisionId) || -1, chordId: (null == r2 ? void 0 : r2.chordRevisionId) || -1, repetitiveSegmentId: (null == r2 ? void 0 : r2.chorusRevisionId) || -1 }, this.parseBeats(null == e2 ? void 0 : e2.beats), this.parseSegments(null == e2 ? void 0 : e2.repetitive_segment), this.parseChords(null == e2 ? void 0 : e2.chords), this.parseVoice(e2.voice);
  }
  return Object.defineProperty(t.prototype, "revisions", { get: function() {
    return this._revisions;
  }, enumerable: false, configurable: true }), t.prototype.parseBeats = function(t2) {
    var e2 = this;
    if (this.beats.splice(0, this.beats.length), Array.isArray(t2) && Array.isArray(t2[0])) {
      var r2 = null, n2 = 0;
      t2[0].forEach(function(t3) {
        var i2 = new Nn();
        i2.startTime = 1e3 * t3[0], i2.length = t3[2], i2.position = t3[3], i2.previous = r2, null !== r2 && (r2.next = i2), i2.index = n2++, e2.beats.push(i2), r2 = i2;
      }), null !== r2 && (r2.next = null);
    }
  }, t.prototype.parseChords = function(t2) {
    var e2 = this;
    if (this.chords.splice(0, this.chords.length), Array.isArray(t2)) {
      var r2 = null, n2 = 0;
      t2.forEach(function(t3) {
        var i2 = new kn();
        i2.startTime = 1e3 * t3[0], i2.endTime = 1e3 * t3[1], i2.name = t3[2], i2.previous = r2, null !== r2 && (r2.next = i2), i2.index = n2++, e2.chords.push(i2), r2 = i2;
      }), null !== r2 && (r2.next = null);
    }
  }, t.prototype.parseSegments = function(t2) {
    var e2 = this;
    this.segments.splice(0, this.segments.length), Array.isArray(t2) && t2.forEach(function(t3) {
      var r2 = { chorus: !!t3.chorus, duration: 10 * t3.segment_length, segments: null }, n2 = null, i2 = 0;
      r2.segments = t3.start_frames.map(function(t4) {
        var e3 = new jn();
        return e3.startTime = 10 * t4, e3.endTime = e3.startTime + r2.duration, e3.previous = n2, null !== n2 && (n2.next = e3), e3.index = i2++, n2 = e3, e3;
      }), null !== n2 && (n2.next = null), e2.segments.push(r2);
    });
  }, t.prototype.parseVoice = function(t2) {
    var e2 = this;
    this.voice.splice(0, this.voice.length), Array.isArray(t2) && t2.forEach(function(t3) {
      var r2 = [], n2 = null, i2 = 0, o2 = 0;
      t3.forEach(function(t4) {
        var e3 = new In();
        e3.startTime = o2, e3.endTime = e3.startTime + 10 * t4[1], e3.f0 = t4[0][0], e3.initialF0 = t4[0][1], e3.previous = n2, null !== n2 && (n2.next = e3), e3.index = i2++, r2.push(e3), n2 = e3, o2 = e3.endTime;
      }), null !== n2 && (n2.next = null), e2.voice.push(r2);
    });
  }, t;
}();
var Fn = function() {
  function t(t2) {
    var e2 = t2.song, r2 = t2.analysis, n2 = t2.vocalAmplitude, i2 = t2.maxVocalAmplitude, o2 = t2.valenceArousal;
    this._song = e2, this._analysis = r2, this._vocalAmplitude = n2, this._maxVocalAmplitude = i2, this._valenceArousal = o2;
  }
  return Object.defineProperty(t.prototype, "song", { get: function() {
    return this._song;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "analysis", { get: function() {
    return this._analysis;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "vocalAmplitude", { get: function() {
    return this._vocalAmplitude;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "maxVocalAmplitude", { get: function() {
    return this._maxVocalAmplitude;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "valenceArousal", { get: function() {
    return this._valenceArousal;
  }, enumerable: false, configurable: true }), t.prototype.getChoruses = function() {
    var t2;
    if (!this._analysis) return [];
    var e2 = this._analysis.segments.filter(function(t3) {
      return t3.chorus;
    });
    return e2.length <= 0 ? [] : (null === (t2 = e2[0].segments) || void 0 === t2 ? void 0 : t2.slice()) || [];
  }, t.prototype.findChorus = function(t2, e2) {
    return st(this.getChoruses(), t2, e2);
  }, t.prototype.findChorusBetween = function(t2, e2) {
    return this.findChorus(t2, { endTime: e2 });
  }, t.prototype.findChorusChange = function(t2, e2) {
    return at(this.getChoruses(), t2, e2);
  }, t.prototype.getBeats = function() {
    var t2, e2;
    return (null === (e2 = null === (t2 = this._analysis) || void 0 === t2 ? void 0 : t2.beats) || void 0 === e2 ? void 0 : e2.slice()) || [];
  }, t.prototype.findBeat = function(t2, e2) {
    return st(this.getBeats(), t2, e2);
  }, t.prototype.findBeatChange = function(t2, e2) {
    return at(this.getBeats(), t2, e2);
  }, t.prototype.getChords = function() {
    var t2, e2;
    return (null === (e2 = null === (t2 = this._analysis) || void 0 === t2 ? void 0 : t2.chords) || void 0 === e2 ? void 0 : e2.slice()) || [];
  }, t.prototype.findChord = function(t2, e2) {
    return st(this.getChords(), t2, e2);
  }, t.prototype.findChordChange = function(t2, e2) {
    return at(this.getChords(), t2, e2);
  }, t.prototype.getVocalFrequency = function(t2) {
    var e2;
    if (!Array.isArray(null === (e2 = this._analysis) || void 0 === e2 ? void 0 : e2.voice)) return -1;
    var n2 = this._analysis.voice[0];
    if (n2.length <= 0) return -1;
    var i2 = r.sortedIndex(n2, t2, function(t3) {
      return t3.endTime;
    });
    return n2[i2].contains(t2) ? n2[i2].f0 : -1;
  }, t.prototype.getVocalAmplitude = function(t2) {
    var e2 = this._vocalAmplitude, r2 = Math.round(t2 / 10);
    return !Array.isArray(this._vocalAmplitude) || r2 < 0 || r2 >= e2.length ? -1 : this._vocalAmplitude[r2];
  }, t.prototype.getMaxVocalAmplitude = function() {
    return "number" == typeof this._maxVocalAmplitude ? this._maxVocalAmplitude : -1;
  }, t.prototype.getValenceArousal = function(t2) {
    var e2 = this._valenceArousal;
    if (!e2) return null;
    var n2 = r.sortedIndex(e2.seq, t2, function(t3) {
      return 1e3 * t3.t[1];
    });
    if (n2 < 0) return { a: e2.seq[0].a, v: e2.seq[0].v };
    if (n2 + 1 >= e2.seq.length || t2 < 1e3 * e2.seq[n2 + 1].t[0]) return { a: e2.seq[Math.min(n2, e2.seq.length - 1)].a, v: e2.seq[Math.min(n2, e2.seq.length - 1)].v };
    var i2 = e2.seq[n2], o2 = e2.seq[n2 + 1], s2 = t2 / 1e3, a2 = o2.t[0], u2 = i2.t[1], c2 = u2 - a2;
    return { a: (i2.a * (u2 - s2) + o2.a * (s2 - a2)) / c2, v: (i2.v * (u2 - s2) + o2.v * (s2 - a2)) / c2 };
  }, t.prototype.getMedianValenceArousal = function() {
    var t2 = this._valenceArousal;
    return t2 ? t2.stats.median : null;
  }, t;
}();
var Ln = function() {
  function t(t2, e2, r2) {
    this.songManager = t2, this.options = r2, this.listener = e2;
  }
  return Object.defineProperty(t.prototype, "song", { get: function() {
    return this._song;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "analysis", { get: function() {
    return this._analysis;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "vocalAmplitude", { get: function() {
    return this._vocalAmplitude;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "maxVocalAmplitude", { get: function() {
    return this._maxVocalAmplitude;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "valenceArousal", { get: function() {
    return this._valenceArousal;
  }, enumerable: false, configurable: true }), t.prototype.loadSong = function(t2, e2) {
    var r2, n2, i2;
    return yn(this, 0, void 0, function() {
      var o2, s2;
      return gn(this, function(a2) {
        switch (a2.label) {
          case 0:
            return "number" == typeof t2 && t2 < 0 || !t2 ? (this.onSongLoad(null, new Error("Neither Songle ID or code provided")), [2, null]) : [4, this.songManager.load("number" == typeof t2 ? { id: t2 } : { code: t2 })];
          case 1:
            return o2 = a2.sent(), this.onSongLoad(o2, o2 ? void 0 : new Error("Song data not found")), o2 ? (s2 = { chord: null == e2 ? void 0 : e2.chordId, beat: null == e2 ? void 0 : e2.beatId, chorus: null == e2 ? void 0 : e2.repetitiveSegmentId }, [4, Promise.all([(null === (r2 = this.options) || void 0 === r2 ? void 0 : r2.vocalFrequencyEnabled) ? this.loadSongDetailInfo(o2.song.code, { revisions: s2 }) : this.loadSongInfo(o2.song.code, { revisions: s2 }), (null === (n2 = this.options) || void 0 === n2 ? void 0 : n2.vocalAmplitudeEnabled) ? this.loadVocalAmplitude(o2.song.code) : Promise.resolve(null), (null === (i2 = this.options) || void 0 === i2 ? void 0 : i2.valenceArousalEnabled) ? this.loadValenceArousal(o2.song.code) : Promise.resolve(null)])]) : [2, null];
          case 2:
            return a2.sent(), [2, new Fn(this)];
        }
      });
    });
  }, t.prototype.onSongLoad = function(t2, e2) {
    this._song = t2, this.listener && this.listener.onSongLoad && this.listener.onSongLoad(t2, e2);
  }, t.prototype.loadSongInfo = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, this.songManager.loadInfo(String(t2), e2)];
          case 1:
            return r2 = n2.sent(), this.onSongMapLoad(r2, r2 ? void 0 : new Error("Song analysis data not found")), [2, r2];
        }
      });
    });
  }, t.prototype.loadSongDetailInfo = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, this.songManager.loadDetailInfo(String(t2), e2)];
          case 1:
            return r2 = n2.sent(), this.onSongMapLoad(r2, r2 ? void 0 : new Error("Song analysis data not found")), [2, r2];
        }
      });
    });
  }, t.prototype.mockSongInfo = function(t2) {
    var e2 = function(t3) {
      for (var e3 = t3.beat, r2 = t3.chorusSegment, n2 = t3.duration, i2 = [], o2 = 0; 60 * o2 / e3.bpm < n2 / 1e3; ) i2.push([60 * o2 / e3.bpm, 1, e3.length, o2 % e3.length + 1, 1]), o2++;
      return { beats: [i2], chords: null, repetitive_segment: [{ chorus: true, index: 0, segment_length: r2.duration / 10, start_frames: r2.startTimes.map(function(t4) {
        return t4 / 10;
      }) }], voice: null };
    }(t2);
    return this._song = null, this.onSongMapLoad({ analysis: e2, info: null }), new Fn(this);
  }, t.prototype.onSongMapLoad = function(t2, e2) {
    var r2, n2;
    this._analysis = new Un(t2), (null === (r2 = this.listener) || void 0 === r2 ? void 0 : r2.onSongMapLoad) && this.listener.onSongMapLoad(this._analysis, e2), (null === (n2 = this.listener) || void 0 === n2 ? void 0 : n2.onSongInfoLoad) && this.listener.onSongInfoLoad(t2, e2);
  }, t.prototype.loadVocalAmplitude = function(t2) {
    var e2;
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, this.songManager.loadVocalAmplitude(String(t2))];
          case 1:
            return r2._vocalAmplitude = n2.sent(), this._maxVocalAmplitude = Math.max.apply(Math, this._vocalAmplitude), (null === (e2 = this.listener) || void 0 === e2 ? void 0 : e2.onVocalAmplitudeLoad) && this.listener.onVocalAmplitudeLoad(this._vocalAmplitude, this._vocalAmplitude ? void 0 : new Error("Vocal amplitude data not found")), [2, this._vocalAmplitude];
        }
      });
    });
  }, t.prototype.loadValenceArousal = function(t2) {
    var e2;
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, this.songManager.loadValenceArousal(String(t2))];
          case 1:
            return r2._valenceArousal = n2.sent(), (null === (e2 = this.listener) || void 0 === e2 ? void 0 : e2.onValenceArousalLoad) && this.listener.onValenceArousalLoad(this._valenceArousal, this._valenceArousal ? void 0 : new Error("Valence arousal data not found")), [2, this._valenceArousal];
        }
      });
    });
  }, t;
}();
var Dn = function() {
  function t(t2, e2, r2) {
    this.managers = t2, this.listener = e2, this.options = r2;
  }
  return t.prototype.loadRawText = function(t2) {
    var e2;
    return e2 = !t2.phrases || t2.phrases.length < 0 ? "" : t2.phrases.map(function(t3) {
      return t3.words.map(function(t4) {
        return t4.characters.map(function(t5) {
          return t5.char;
        }).join("");
      }).join("");
    }).join(""), this.onTextLoad({ text: e2 }), { lyricsId: -1, lyrics: null, lyricsBody: { text: e2, artist: null, name: null, url: null } };
  }, t.prototype.loadLyrics = function(t2) {
    var e2 = t2.songCode, r2 = t2.lyricId, n2 = void 0 === r2 ? -1 : r2, i2 = t2.lyricDiffId, o2 = void 0 === i2 ? -1 : i2, s2 = t2.altLyricsUrl, a2 = t2.directAccess;
    return yn(this, 0, void 0, function() {
      var t3, r3, i3, u2;
      return gn(this, function(c2) {
        switch (c2.label) {
          case 0:
            return n2 <= 0 ? (0 === n2 ? this.onLyricsLoad(null, new Error("Lyrics not loaded")) : this.onLyricsLoad(null, new Error("Lyrics not found")), [2, null]) : [4, this.managers.lyrics.loadDiff(e2, n2, o2)];
          case 1:
            return (null == (t3 = c2.sent()) ? void 0 : t3.data) ? (r3 = fn(fn({}, t3), { processing: false, failed: false, id: n2, diff: { id: o2 } }), this.onLyricsLoad(r3), s2 || a2 ? [3, 3] : [4, this.managers.lyrics.fetchLocalLyricBody(n2)]) : (this.onLyricsLoad(null, new Error("Lyrics timing information not found")), [2, null]);
          case 2:
            i3 = c2.sent(), c2.label = 3;
          case 3:
            if (null == i3 ? void 0 : i3.text) return [3, 7];
            c2.label = 4;
          case 4:
            return c2.trys.push([4, 6, , 7]), [4, this.loadLyricsText(t3, { altLyricsUrl: s2, directAccess: a2 })];
          case 5:
            return i3 = c2.sent(), [3, 7];
          case 6:
            return u2 = c2.sent(), this.onTextLoad(null, u2), [3, 7];
          case 7:
            return i3 && this.onTextLoad(i3), [2, { lyricsId: r3.id, lyrics: r3, lyricsBody: i3 }];
        }
      });
    });
  }, t.prototype.loadLyricsText = function(t2, e2) {
    var r2 = void 0 === e2 ? {} : e2, n2 = r2.altLyricsUrl, i2 = r2.directAccess;
    return yn(this, 0, void 0, function() {
      var e3, r3, o2 = this;
      return gn(this, function(s2) {
        switch (s2.label) {
          case 0:
            return e3 = this.options && "number" == typeof this.options.lyricsFetchTimeout && this.options.lyricsFetchTimeout >= 0, r3 = this.managers.lyrics.fetchLyricBody(n2 || t2.url, { parserPath: t2.parser_path, directAccess: i2 }), [4, e3 ? Promise.race([r3, new Promise(function(t3, e4) {
              return setTimeout(function() {
                return e4(new Error("Fetching lyrics text timeout"));
              }, o2.options.lyricsFetchTimeout);
            })]) : r3];
          case 1:
            return [2, s2.sent()];
        }
      });
    });
  }, t.prototype.onLyricsLoad = function(t2, e2) {
    this.listener && this.listener.onLyricsLoad && this.listener.onLyricsLoad(t2, e2);
  }, t.prototype.onTextLoad = function(t2, e2) {
    this.listener && this.listener.onTextLoad && this.listener.onTextLoad(t2, e2);
  }, t;
}();
var Mn = function() {
  function t(t2) {
    var e2 = t2.video;
    this._video = e2;
  }
  return Object.defineProperty(t.prototype, "video", { get: function() {
    return this._video;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "data", { get: function() {
    return this._video.json;
  }, enumerable: false, configurable: true }), t;
}();
var Bn = function() {
  function t(t2, e2) {
    this.managers = t2, this.listener = e2, this.listener = e2;
  }
  return Object.defineProperty(t.prototype, "video", { get: function() {
    return this._video;
  }, enumerable: false, configurable: true }), t.prototype.onVideoLoad = function(t2, e2) {
    var r2 = t2 ? Object.assign(t2, e2) : null;
    return r2 && ("string" == typeof r2.json ? r2.json = JSON.parse(r2.json) : "object" == typeof r2.json && null !== r2.json || (r2.json = {}), "string" == typeof r2.config ? r2.config = JSON.parse(r2.config) : "object" == typeof r2.config && null !== r2.config || (r2.config = {})), this._video = r2, this.listener && this.listener.onVideoLoad && this.listener.onVideoLoad(r2), new Mn({ video: r2 });
  }, t.prototype.createFromVideoId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, this.managers.video.load(t2)];
          case 1:
            return r2 = n2.sent(), [2, this.onVideoLoad(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromVideo = function(t2, e2) {
    return this.onVideoLoad(t2, e2);
  }, t.prototype.createFromSongUrl = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(r2) {
        return [2, this.createFromSongPath(this.managers.song.getSongPathFromUrl(t2), e2)];
      });
    });
  }, t.prototype.createFromSongPath = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, this.managers.song.load({ songPath: t2 })];
          case 1:
            return (r2 = n2.sent()) ? [2, this.createFromSong(r2.song, e2)] : [2, null];
        }
      });
    });
  }, t.prototype.createFromSongId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, this.managers.song.load({ id: t2 })];
          case 1:
            return (r2 = n2.sent()) ? [2, this.createFromSong(r2.song, e2)] : [2, null];
        }
      });
    });
  }, t.prototype.createFromSongCode = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, this.managers.song.load({ code: t2 })];
          case 1:
            return (r2 = n2.sent()) ? [2, this.createFromSong(r2.song, e2)] : [2, null];
        }
      });
    });
  }, t.prototype.createFromSong = function(t2, e2) {
    var r2;
    return yn(this, 0, void 0, function() {
      var n2, i2, o2, s2, a2, u2;
      return gn(this, function(c2) {
        switch (c2.label) {
          case 0:
            return n2 = null == e2 ? void 0 : e2.lyricId, i2 = null == e2 ? void 0 : e2.lyricDiffId, "number" != typeof n2 || n2 < 0 ? [4, this.managers.lyrics.load(t2.code)] : [3, 4];
          case 1:
            return o2 = c2.sent(), (a2 = o2 && !o2.status.failed && !o2.status.processing && Array.isArray(o2.lyrics) && o2.lyrics.length > 0) ? [4, this.managers.lyrics.loadDetail(t2.code, o2.lyrics[0].id)] : [3, 3];
          case 2:
            a2 = c2.sent(), c2.label = 3;
          case 3:
            (s2 = a2) && (n2 = s2.id, i2 = null === (r2 = s2.diff) || void 0 === r2 ? void 0 : r2.id), c2.label = 4;
          case 4:
            return "number" != typeof n2 && (n2 = -1), "number" != typeof i2 && (i2 = -1), u2 = { id: -1, sourceId: -1, sourceOriginId: -1, songleId: t2.id, songleCode: t2.code, lyricId: n2, lyricDiffId: i2, title: null, log: null, background: null, config: null, json: null, synthJson: null, author: null, createdDate: null, accessCount: -1, altUrl: null }, [2, this.onVideoLoad(u2, e2)];
        }
      });
    });
  }, t.prototype.createFromText = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2, n2, i2, o2, s2, a2;
      return gn(this, function(u2) {
        switch (u2.label) {
          case 0:
            return [4, this.managers.text.parse(t2)];
          case 1:
            return r2 = u2.sent(), n2 = r2 && "success" === r2.status ? this.createVideoDataFromParsedText(r2, t2) : this.createVideoDataFromText(t2), i2 = n2[n2.length - 1], o2 = i2 && i2.words[i2.words.length - 1], s2 = o2 && o2.characters[o2.characters.length - 1], a2 = s2 ? s2.endTime : 0, [2, this.createFromJSON({ phrases: n2, startTime: 0, endTime: a2, duration: a2 }, e2)];
        }
      });
    });
  }, t.prototype.createFromJSON = function(t2, e2) {
    var r2 = { id: -1, sourceId: -1, sourceOriginId: -1, songleId: -1, lyricId: -1, lyricDiffId: -1, title: null, log: null, background: null, config: null, json: t2, synthJson: null, author: null, createdDate: null, accessCount: -1, altUrl: null };
    return this.onVideoLoad(r2, e2);
  }, t.prototype.createVideoDataFromParsedText = function(t2, e2) {
    var r2 = 0, n2 = e2.split(/\r\n|[\n\v\f\r\x85\u2028\u2029]/);
    return t2.result.map(function(t3, e3) {
      return { words: t3.map(function(t4) {
        return { characters: n2[e3].substr(t4.startPosition, t4.wordLength).split("").map(function(t5) {
          return { char: t5, startTime: 300 * r2, endTime: 300 * ++r2 };
        }), pos: t4.PoS, rawPoS: t4.rawPoS, language: t4.language };
      }), templates: [{ type: "DefaultAlignment" }] };
    });
  }, t.prototype.createVideoDataFromText = function(t2) {
    for (var e2, r2 = { characters: [] }, n2 = { words: [r2], templates: [{ type: "DefaultAlignment" }] }, i2 = 0, o2 = [n2], s2 = 0; s2 < t2.length; s2++) {
      var a2 = t2.charAt(s2);
      "\n" !== a2 ? " " !== a2 ? (e2 = { char: a2, startTime: 300 * i2, endTime: 300 * ++i2 }, r2.characters.push(e2)) : (r2 = { characters: [] }, n2.words.push(r2)) : (n2 = { words: [r2 = { characters: [] }], templates: [{ type: "DefaultAlignment" }] }, o2.push(n2));
    }
    return r2.characters.length <= 0 && n2.words.pop(), n2.words.length <= 0 && o2.pop(), o2;
  }, t;
}();
var Vn = function() {
  function t(t2, e2, r2) {
    void 0 === e2 && (e2 = null);
    var n2 = this;
    this.managers = t2, this.listener = e2, this.options = r2, this.fontLoader = new Rn(t2.font, function() {
      return n2.text;
    }, e2);
  }
  return Object.defineProperty(t.prototype, "permalink", { get: function() {
    var t2;
    return "https://textalive.jp".concat((null === (t2 = this.song) || void 0 === t2 ? void 0 : t2.permalink) ? "/songs/".concat(encodeURIComponent(c.getSongPathFromUrl(this.song.permalink))) : "");
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "video", { get: function() {
    var t2;
    return null === (t2 = this.videoProvider) || void 0 === t2 ? void 0 : t2.video;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "song", { get: function() {
    var t2, e2;
    return null === (e2 = null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.song) || void 0 === e2 ? void 0 : e2.song;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "songStatus", { get: function() {
    var t2, e2;
    return null === (e2 = null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.song) || void 0 === e2 ? void 0 : e2.status;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "songMap", { get: function() {
    var t2;
    return null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.analysis;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "lyricsId", { get: function() {
    var t2, e2;
    return null === (e2 = null === (t2 = this.textProvider) || void 0 === t2 ? void 0 : t2.lyrics) || void 0 === e2 ? void 0 : e2.id;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "lyrics", { get: function() {
    var t2;
    return null === (t2 = this.textProvider) || void 0 === t2 ? void 0 : t2.lyrics;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "lyricsBody", { get: function() {
    var t2;
    return null === (t2 = this.textProvider) || void 0 === t2 ? void 0 : t2.lyricsBody;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "text", { get: function() {
    var t2, e2;
    return null === (e2 = null === (t2 = this.textProvider) || void 0 === t2 ? void 0 : t2.lyricsBody) || void 0 === e2 ? void 0 : e2.text;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "fonts", { get: function() {
    return this.fontLoader;
  }, enumerable: false, configurable: true }), t.prototype.createFromVideoId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, new Bn(this.managers, this.listener).createFromVideoId(t2, e2)];
          case 1:
            return r2.videoProvider = n2.sent(), [2, this.videoProvider];
        }
      });
    });
  }, t.prototype.createFromVideo = function(t2, e2) {
    return this.videoProvider = new Bn(this.managers, this.listener).createFromVideo(t2, e2), this.videoProvider;
  }, t.prototype.createFromSongUrl = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, new Bn(this.managers, this.listener).createFromSongUrl(t2, e2)];
          case 1:
            return r2.videoProvider = n2.sent(), [2, this.videoProvider];
        }
      });
    });
  }, t.prototype.createFromSongPath = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, new Bn(this.managers, this.listener).createFromSongPath(t2, e2)];
          case 1:
            return r2.videoProvider = n2.sent(), [2, this.videoProvider];
        }
      });
    });
  }, t.prototype.createFromSongId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, new Bn(this.managers, this.listener).createFromSongId(t2, e2)];
          case 1:
            return r2.videoProvider = n2.sent(), [2, this.videoProvider];
        }
      });
    });
  }, t.prototype.createFromSongCode = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, new Bn(this.managers, this.listener).createFromSongCode(t2, e2)];
          case 1:
            return r2.videoProvider = n2.sent(), [2, this.videoProvider];
        }
      });
    });
  }, t.prototype.createFromText = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return r2 = this, [4, new Bn(this.managers, this.listener).createFromText(t2, e2)];
          case 1:
            return r2.videoProvider = n2.sent(), [2, this.videoProvider];
        }
      });
    });
  }, t.prototype.createFromJSON = function(t2, e2) {
    return this.videoProvider = new Bn(this.managers, this.listener).createFromJSON(t2, e2), this.videoProvider;
  }, t.prototype.finalize = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        switch (e2.label) {
          case 0:
            return this.video ? [4, this.loadSong()] : [2, null];
          case 1:
            return e2.sent(), [4, this.loadText(t2)];
          case 2:
            return e2.sent(), [4, this.loadFonts()];
          case 3:
            return e2.sent(), [2];
        }
      });
    });
  }, t.prototype.mockSongInfo = function(t2) {
    this.songProvider = new Ln(this.managers.song, this.listener, this.options).mockSongInfo(t2);
  }, t.prototype.loadSong = function() {
    return yn(this, 0, void 0, function() {
      var t2;
      return gn(this, function(e2) {
        switch (e2.label) {
          case 0:
            return t2 = this, [4, new Ln(this.managers.song, this.listener, this.options).loadSong(this.video.songleCode || this.video.songleId, this.video)];
          case 1:
            return t2.songProvider = e2.sent(), [2];
        }
      });
    });
  }, t.prototype.loadText = function(t2) {
    var e2, r2;
    return yn(this, 0, void 0, function() {
      var n2, i2, o2, s2, a2, u2, c2, l2;
      return gn(this, function(p2) {
        switch (p2.label) {
          case 0:
            return n2 = this.video, i2 = n2.lyricId, o2 = n2.lyricDiffId, s2 = this.song ? this.song.code : null, a2 = new Dn(this.managers, this.listener, this.options), !s2 && i2 < 0 ? (u2 = a2.loadRawText(null === (e2 = this.videoProvider) || void 0 === e2 ? void 0 : e2.data), [3, 3]) : [3, 1];
          case 1:
            return c2 = (null == t2 ? void 0 : t2.altLyricsUrl) || void 0, l2 = (null == t2 ? void 0 : t2.lyricsDirectAccess) || void 0, [4, a2.loadLyrics({ songCode: s2, lyricId: i2, lyricDiffId: o2, altLyricsUrl: c2, directAccess: l2 })];
          case 2:
            u2 = p2.sent(), p2.label = 3;
          case 3:
            return this.textProvider = u2, (null == u2 ? void 0 : u2.lyrics) && (null === (r2 = null == u2 ? void 0 : u2.lyricsBody) || void 0 === r2 ? void 0 : r2.text) && this.importLyrics(), [2];
        }
      });
    });
  }, t.prototype.loadFonts = function() {
    var t2, e2, r2;
    return yn(this, 0, void 0, function() {
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return "number" == typeof this.video.id && this.video.id >= 0 ? [4, this.fontLoader.loadForVideo(null === (t2 = this.videoProvider) || void 0 === t2 ? void 0 : t2.data)] : [3, 2];
          case 1:
          case 3:
          case 5:
            return n2.sent(), [2];
          case 2:
            return Array.isArray(null === (e2 = this.options) || void 0 === e2 ? void 0 : e2.fontFamilies) ? [4, this.fontLoader.load(this.options.fontFamilies)] : [3, 4];
          case 4:
            return null !== (null === (r2 = this.options) || void 0 === r2 ? void 0 : r2.fontFamilies) ? [3, 6] : [4, this.fontLoader.loadAll()];
          case 6:
            return [2];
        }
      });
    });
  }, t.prototype.importLyrics = function() {
    var t2 = this.text.replace(/[\s\r\n]/g, ""), e2 = 0, r2 = { phrases: this.lyrics.data.map(function(r3) {
      return { words: r3.map(function(r4) {
        return { characters: r4.map(function(r5) {
          return { char: t2.charAt(e2++), startTime: 1e3 * r5.start_time, endTime: 1e3 * r5.end_time };
        }) };
      }) };
    }) };
    this.video.json && Array.isArray(this.video.json.phrases) ? this.video.json.phrases.forEach(function(t3, e3) {
      t3.words.forEach(function(t4, n2) {
        t4.characters.forEach(function(t5, i2) {
          var o2 = r2.phrases[e3].words[n2].characters[i2];
          t5.char = o2.char, t5.startTime = o2.startTime, t5.endTime = o2.endTime;
        });
      });
    }) : this.video.json = r2;
  }, t.prototype.getChoruses = function() {
    var t2;
    return null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.getChoruses();
  }, t.prototype.findChorus = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findChorus(t2, e2);
  }, t.prototype.findChorusBetween = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findChorusBetween(t2, e2);
  }, t.prototype.findChorusChange = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findChorusChange(t2, e2);
  }, t.prototype.getBeats = function() {
    var t2;
    return null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.getBeats();
  }, t.prototype.findBeat = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findBeat(t2, e2);
  }, t.prototype.findBeatChange = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findBeatChange(t2, e2);
  }, t.prototype.getChords = function() {
    var t2;
    return null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.getChords();
  }, t.prototype.findChord = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findChord(t2, e2);
  }, t.prototype.findChordChange = function(t2, e2) {
    var r2;
    return null === (r2 = this.songProvider) || void 0 === r2 ? void 0 : r2.findChordChange(t2, e2);
  }, t.prototype.getVocalFrequency = function(t2) {
    var e2;
    return null === (e2 = this.songProvider) || void 0 === e2 ? void 0 : e2.getVocalFrequency(t2);
  }, t.prototype.getVocalAmplitude = function(t2) {
    var e2;
    return null === (e2 = this.songProvider) || void 0 === e2 ? void 0 : e2.getVocalAmplitude(t2);
  }, t.prototype.getMaxVocalAmplitude = function() {
    var t2;
    return null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.getMaxVocalAmplitude();
  }, t.prototype.getValenceArousal = function(t2) {
    var e2;
    return null === (e2 = this.songProvider) || void 0 === e2 ? void 0 : e2.getValenceArousal(t2);
  }, t.prototype.getMedianValenceArousal = function() {
    var t2;
    return null === (t2 = this.songProvider) || void 0 === t2 ? void 0 : t2.getMedianValenceArousal();
  }, t;
}();
var Gn = function() {
  function t(t2, e2) {
    this.player = t2, this.listener = e2, this.initialize();
  }
  return Object.defineProperty(t.prototype, "options", { get: function() {
    return this._options ? fn({}, this._options) : null;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "name", { get: function() {
    return this._name;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "author", { get: function() {
    return this._author;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "status", { get: function() {
    return this._status;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "server", { get: function() {
    return this._server;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "managed", { get: function() {
    return !!this._host;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "host", { get: function() {
    return this._host;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "songUrl", { get: function() {
    return this._songUrl;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "songOptions", { get: function() {
    return this._songOptions;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "parameters", { get: function() {
    return this._parameters;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "isConnecting", { get: function() {
    return !!this.connecting;
  }, enumerable: false, configurable: true }), t.prototype.initialize = function() {
    var t2, e2, r2, n2;
    return yn(this, 0, void 0, function() {
      return gn(this, function(i2) {
        switch (i2.label) {
          case 0:
            return this._options = null === (e2 = null === (t2 = this.player) || void 0 === t2 ? void 0 : t2.options) || void 0 === e2 ? void 0 : e2.app, this._options && (this._options = fn({}, this._options), this._name = null === (r2 = this._options) || void 0 === r2 ? void 0 : r2.appName, this._author = null === (n2 = this._options) || void 0 === n2 ? void 0 : n2.appAuthor, this._options.token && (m.textalive.appToken = this._options.token)), this._parameters = {}, this.parseQueryString(), this.initializeServerConnection(), "undefined" != typeof window && this._options ? [4, this.connect()] : [3, 2];
          case 1:
            i2.sent(), this.initializePlayerListener(), this.initializeMessageListener(), i2.label = 2;
          case 2:
            return this._songUrl && this.createFromSongUrl(), [2];
        }
      });
    });
  }, t.prototype.initializeServerConnection = function() {
    var t2, e2, r2, n2, i2, o2;
    return yn(this, 0, void 0, function() {
      var s2, a2, u2, c2, l2;
      return gn(this, function(p2) {
        switch (p2.label) {
          case 0:
            return [4, A.getServerStatus()];
          case 1:
            return s2 = p2.sent(), a2 = "ja" === (null == s2 ? void 0 : s2.lang), m.textalive.appToken && (null == s2 ? void 0 : s2.app) && (s2.app.data && (this._name = null === (t2 = s2.app.data) || void 0 === t2 ? void 0 : t2.name, this._author = null === (r2 = null === (e2 = s2.app) || void 0 === e2 ? void 0 : e2.data) || void 0 === r2 ? void 0 : r2.author, u2 = null === (i2 = null === (n2 = s2.app) || void 0 === n2 ? void 0 : n2.data) || void 0 === i2 ? void 0 : i2.status, this._status = "number" == typeof u2 ? u2 : -1), this._server = { version: s2.version, message: s2.app.message, error: s2.app.error }, !this._server.error) ? (c2 = this._server.message ? "\n".concat(this._server.message) : "", a2 ? console.info("[TextAlive API]  v".concat(m.client.version, "  v").concat(this._server.version || "0.0.0", " ").concat(c2)) : console.info("[TextAlive API] App API client v".concat(m.client.version, " connected to server v").concat(this._server.version || "0.0.0").concat(c2)), this.listener.onAppLoad(this), [2]) : (l2 = (null === (o2 = this._server) || void 0 === o2 ? void 0 : o2.error) ? "\n".concat(this._server.error) : "", a2 ? console.warn("[TextAlive API]  https://developer.textalive.jp ".concat(l2)) : console.warn("[TextAlive API] This app requires a valid app token to run properly. You could get a token from https://developer.textalive.jp. ".concat(l2)), this.listener.onAppLoad(null, l2), [2]);
        }
      });
    });
  }, t.prototype.initializePlayerListener = function() {
    var t2 = this;
    this.playerListener = { onVideoReady: function(e2) {
      t2._host && window.parent.postMessage({ kind: "ta_video", options: { lyrics: !!t2.player.data.lyrics, duration: t2.player.video.duration } }, "*");
    }, onThrottledTimeUpdate: function(e2) {
      t2._host && window.parent.postMessage({ kind: "ta_position", options: { position: e2 } }, "*");
    }, onPlay: function() {
      t2._host && window.parent.postMessage({ kind: "ta_status", options: { status: "play" } }, "*");
    }, onPause: function() {
      t2._host && window.parent.postMessage({ kind: "ta_status", options: { status: "pause" } }, "*");
    }, onStop: function() {
      t2._host && window.parent.postMessage({ kind: "ta_status", options: { status: "stop" } }, "*");
    }, onVolumeUpdate: function(e2) {
      t2._host && window.parent.postMessage({ kind: "ta_volume", options: { volume: e2 } }, "*");
    }, onDispose: function() {
      t2.dispose();
    } }, this.player.addListener(this.playerListener);
  }, t.prototype.initializeMessageListener = function() {
    var t2 = this;
    this.messageListener = function(e2) {
      if (e2.data.kind && /^ta_/.test(e2.data.kind)) {
        var r2 = t2.player;
        switch (e2.data.kind.substring(3)) {
          case "status":
            switch (e2.data.options.status) {
              case "play":
                r2.requestPlay();
                break;
              case "pause":
                r2.requestPause();
                break;
              case "stop":
                r2.requestStop();
            }
            break;
          case "seek":
            r2.requestMediaSeek(e2.data.options.position);
            break;
          case "volume":
            r2.volume = e2.data.options.volume;
            break;
          case "parameter":
            var n2 = e2.data.options, i2 = n2.name, o2 = n2.value;
            t2.parameters[i2] = o2, t2.listener.onAppParameterUpdate(i2, o2);
            break;
          case "media":
            t2._songUrl = e2.data.options.url, t2._songOptions = e2.data.options.options || {}, r2.requestStop();
            var s2 = t2.createFromSongUrl();
            t2.listener.onAppMediaChange(t2._songUrl, s2);
        }
      }
    }, window.addEventListener("message", this.messageListener);
  }, t.prototype.createFromSongUrl = function() {
    var t2, e2 = this._songOptions;
    return e2 && (t2 = { video: {} }, e2.altLyricsUrl && (t2.altLyricsUrl = e2.altLyricsUrl), e2.lyricsDirectAccess && (t2.lyricsDirectAccess = e2.lyricsDirectAccess), e2.lyricId && (t2.video.lyricId = e2.lyricId), e2.lyricDiffId && (t2.video.lyricDiffId = e2.lyricDiffId), e2.chordId && (t2.video.chordId = e2.chordId), e2.beatId && (t2.video.beatId = e2.beatId), e2.repetitiveSegmentId && (t2.video.repetitiveSegmentId = e2.repetitiveSegmentId)), this.player.createFromSongUrl(this._songUrl, t2);
  }, t.prototype.parseQueryString = function() {
    var t2 = pn("ta_app_token");
    t2 && (m.textalive.appToken = t2), this._songUrl = pn("ta_song_url"), this._songOptions = {};
    var e2 = pn("ta_lyric_id");
    e2 && (this._songOptions.lyricId = parseInt(e2), isNaN(this._songOptions.lyricId) && delete this._songOptions.lyricId);
    var r2 = pn("ta_lyric_diff_id");
    r2 && (this._songOptions.lyricDiffId = parseInt(r2), isNaN(this._songOptions.lyricDiffId) && delete this._songOptions.lyricDiffId);
    var n2 = pn("ta_alt_lyrics_url");
    n2 && (this._songOptions.altLyricsUrl = n2);
    var i2 = pn("ta_lyrics_direct_access");
    i2 && (this._songOptions.lyricsDirectAccess = "true" === i2, this._songOptions.lyricsDirectAccess || delete this._songOptions.lyricsDirectAccess);
    var o2 = pn("ta_chord_id");
    o2 && (this._songOptions.chordId = parseInt(o2), isNaN(this._songOptions.chordId) && delete this._songOptions.chordId);
    var s2 = pn("ta_beat_id");
    s2 && (this._songOptions.beatId = parseInt(s2), isNaN(this._songOptions.beatId) && delete this._songOptions.beatId);
    var a2 = pn("ta_repetitive_segment_id");
    a2 && (this._songOptions.repetitiveSegmentId = parseInt(a2), isNaN(this._songOptions.repetitiveSegmentId) && delete this._songOptions.repetitiveSegmentId);
  }, t.prototype.connect = function() {
    return yn(this, 0, void 0, function() {
      var t2, e2 = this;
      return gn(this, function(r2) {
        switch (r2.label) {
          case 0:
            return this.connecting ? [2, this.connecting] : "undefined" != typeof window && this.options && window.parent && window !== window.parent ? [3, 2] : [4, new Promise(function(t3) {
              return setTimeout(t3, 1);
            })];
          case 1:
            return r2.sent(), this.listener.onAppReady(this), [2, false];
          case 2:
            return this.connecting = Promise.race([new Promise(function(r3) {
              t2 = function(n2) {
                n2.data.kind && /^ta_/.test(n2.data.kind) && "ack" === n2.data.kind.substring(3) && (window.removeEventListener("message", t2), e2._host = n2.data.options, r3(true));
              }, window.addEventListener("message", t2);
            }), yn(e2, 0, void 0, function() {
              var e3;
              return gn(this, function(r3) {
                switch (r3.label) {
                  case 0:
                    e3 = 0, r3.label = 1;
                  case 1:
                    return e3 < 5 ? (window.parent.postMessage({ kind: "ta_connect", options: this.options }, "*"), [4, new Promise(function(t3) {
                      return setTimeout(t3, 200);
                    })]) : [3, 4];
                  case 2:
                    if (r3.sent(), this._host) return [3, 4];
                    r3.label = 3;
                  case 3:
                    return e3++, [3, 1];
                  case 4:
                    return !this._host && t2 && window.removeEventListener("message", t2), [2, !!this._host];
                }
              });
            })]), this.connecting.finally(function() {
              e2.connecting = null, e2.listener.onAppReady(e2);
            }), [2, this.connecting];
        }
      });
    });
  }, t.prototype.dispose = function() {
    "undefined" != typeof window && this.options && (this.player.removeListener(this.playerListener), window.removeEventListener("message", this.messageListener)), this._host = null, this.player = null;
  }, t;
}();
function qn(t) {
  return t;
}
function Wn(t) {
  return t < -1 ? t = -1 : t > 1 && (t = 1), function(e2) {
    return 0 == t ? e2 : t < 0 ? e2 * (e2 * -t + 1 + t) : e2 * ((2 - e2) * t + (1 - t));
  };
}
function Yn(t) {
  return function(e2) {
    return Math.pow(e2, t);
  };
}
function zn(t) {
  return function(e2) {
    return 1 - Math.pow(1 - e2, t);
  };
}
function Jn(t) {
  return function(e2) {
    return (e2 *= 2) < 1 ? 0.5 * Math.pow(e2, t) : 1 - 0.5 * Math.abs(Math.pow(2 - e2, t));
  };
}
var Hn = Yn(2);
var Xn = zn(2);
var Zn = Jn(2);
var $n = Yn(3);
var Kn = zn(3);
var Qn = Jn(3);
var ti = Yn(4);
var ei = zn(4);
var ri = Jn(4);
var ni = Yn(5);
var ii = zn(5);
var oi = Jn(5);
function si(t) {
  return 1 - Math.cos(t * Math.PI / 2);
}
function ai(t) {
  return Math.sin(t * Math.PI / 2);
}
function ui(t) {
  return -0.5 * (Math.cos(Math.PI * t) - 1);
}
function ci(t) {
  return function(e2) {
    return e2 * e2 * ((t + 1) * e2 - t);
  };
}
var li = ci(1.7);
function pi(t) {
  return function(e2) {
    return --e2 * e2 * ((t + 1) * e2 + t) + 1;
  };
}
var hi = pi(1.7);
function di(t) {
  return t *= 1.525, function(e2) {
    return (e2 *= 2) < 1 ? e2 * e2 * ((t + 1) * e2 - t) * 0.5 : 0.5 * ((e2 -= 2) * e2 * ((t + 1) * e2 + t) + 2);
  };
}
var fi = di(1.7);
function yi(t) {
  return -(Math.sqrt(1 - t * t) - 1);
}
function gi(t) {
  return Math.sqrt(1 - --t * t);
}
function vi(t) {
  return (t *= 2) < 1 ? -0.5 * (Math.sqrt(1 - t * t) - 1) : 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);
}
function mi(t) {
  return 1 - bi(1 - t);
}
function bi(t) {
  return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + 0.75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375 : 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375;
}
function _i(t) {
  return t < 0.5 ? 0.5 * mi(2 * t) : 0.5 * bi(2 * t - 1) + 0.5;
}
function wi(t, e2) {
  var r2 = 2 * Math.PI;
  return function(n2) {
    if (0 == n2 || 1 == n2) return n2;
    var i2 = e2 / r2 * Math.asin(1 / t);
    return -t * Math.pow(2, 10 * (n2 -= 1)) * Math.sin((n2 - i2) * r2 / e2);
  };
}
var Pi = wi(1, 0.3);
function Ei(t, e2) {
  var r2 = 2 * Math.PI;
  return function(n2) {
    if (0 == n2 || 1 == n2) return n2;
    var i2 = e2 / r2 * Math.asin(1 / t);
    return t * Math.pow(2, -10 * n2) * Math.sin((n2 - i2) * r2 / e2) + 1;
  };
}
var Oi = Ei(1, 0.3);
function Si(t, e2) {
  var r2 = 2 * Math.PI;
  return function(n2) {
    var i2 = e2 / r2 * Math.asin(1 / t);
    return (n2 *= 2) < 1 ? t * Math.pow(2, 10 * (n2 -= 1)) * Math.sin((n2 - i2) * r2 / e2) * -0.5 : t * Math.pow(2, -10 * (n2 -= 1)) * Math.sin((n2 - i2) * r2 / e2) * 0.5 + 1;
  };
}
var Ti = Si(1, 0.3 * 1.5);
var xi = Object.freeze({ __proto__: null, backIn: li, backInOut: fi, backOut: hi, bounceIn: mi, bounceInOut: _i, bounceOut: bi, circIn: yi, circInOut: vi, circOut: gi, cubicIn: $n, cubicInOut: Qn, cubicOut: Kn, elasticIn: Pi, elasticInOut: Ti, elasticOut: Oi, get: Wn, getBackIn: ci, getBackInOut: di, getBackOut: pi, getElasticIn: wi, getElasticInOut: Si, getElasticOut: Ei, getPowIn: Yn, getPowInOut: Jn, getPowOut: zn, linear: qn, quadIn: Hn, quadInOut: Zn, quadOut: Xn, quartIn: ti, quartInOut: ri, quartOut: ei, quintIn: ni, quintInOut: oi, quintOut: ii, sineIn: si, sineInOut: ui, sineOut: ai });
var Ai = function() {
  function t() {
  }
  return t.linear = qn, t.get = Wn, t.getPowIn = Yn, t.getPowOut = zn, t.getPowInOut = Jn, t.quadIn = Hn, t.quadOut = Xn, t.quadInOut = Zn, t.cubicIn = $n, t.cubicOut = Kn, t.cubicInOut = Qn, t.quartIn = ti, t.quartOut = ei, t.quartInOut = ri, t.quintIn = ni, t.quintOut = ii, t.quintInOut = oi, t.sineIn = si, t.sineOut = ai, t.sineInOut = ui, t.getBackIn = ci, t.backIn = li, t.getBackOut = pi, t.backOut = hi, t.getBackInOut = di, t.backInOut = fi, t.circIn = yi, t.circOut = gi, t.circInOut = vi, t.bounceIn = mi, t.bounceOut = bi, t.bounceInOut = _i, t.getElasticIn = wi, t.elasticIn = Pi, t.getElasticOut = Ei, t.elasticOut = Oi, t.getElasticInOut = Si, t.elasticInOut = Ti, t;
}();
var Ri = function() {
  function t() {
    this.cursor = -1, this.widgets = [], this.instances = [], this.model = { id: -1, type: n.NONE, sourceId: -1, author: null, originalAuthor: null, className: null, createdDate: null };
  }
  return Object.defineProperty(t.prototype, "id", { get: function() {
    return this.model ? this.model.id : -1;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "script", { get: function() {
    return this.model ? this.model.script : null;
  }, enumerable: false, configurable: true }), t;
}();
var Ci = function() {
};
var Ni = function() {
  function t(t2, e2) {
    this.onTemplateLoad = e2, this._emitter = null, this._loaded = null, this._loading = null, this.verbose = false, this._emitter = t2, this.clear();
  }
  return Object.defineProperty(t.prototype, "loaded", { get: function() {
    return this._loaded;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "loading", { get: function() {
    return this._loading;
  }, enumerable: false, configurable: true }), t.prototype.clear = function() {
    this._loaded = {}, this._loading = {};
  }, t.prototype.loadLatest = function(t2) {
    return void 0 === t2 && (t2 = 100), yn(this, 0, void 0, function() {
      var e2;
      return gn(this, function(r2) {
        switch (r2.label) {
          case 0:
            return [4, q.list({ maxResults: t2, withoutAuthors: true, withoutOriginalAuthors: true, script: true })];
          case 1:
            return (e2 = r2.sent()) && e2.list ? (this.verbose && console.log("--- loading template classes ---"), [2, this.registerMany(e2.list)]) : [2];
        }
      });
    });
  }, t.prototype.loadForVideo = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2 = this;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, q.loadForVideo(t2)];
          case 1:
            return (e2 = n2.sent()) && e2.list ? (this.verbose && console.log("--- loading template classes for vid:".concat(t2, " ---")), [4, this.registerMany(e2.list)]) : [2, null];
          case 2:
            return [2, n2.sent().map(function(t3) {
              return t3 ? r2.getByName(t3) : null;
            })];
        }
      });
    });
  }, t.prototype.loadByNames = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2 = this;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return !Array.isArray(t2) || t2.length <= 0 ? [2, []] : (this.verbose && console.log("--- loading template classes ---"), [4, Promise.all(t2.map(function(t3) {
              return r2.doLoadByName(t3);
            }))]);
          case 1:
            return (e2 = n2.sent()) && this._emitter.onTemplatesLoad(e2.filter(function(t3) {
              return !!t3;
            }).map(function(t3) {
              return t3.className;
            })), [2, e2];
        }
      });
    });
  }, t.prototype.loadByName = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return n2.trys.push([0, 2, , 3]), [4, this.doLoadByName(t2)];
          case 1:
            return e2 = n2.sent(), this._emitter.onTemplatesLoad([e2.className]), [2, e2];
          case 2:
            return r2 = n2.sent(), this._emitter.onTemplatesLoad(null, r2), [2, null];
          case 3:
            return [2];
        }
      });
    });
  }, t.prototype.doLoadByName = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2 = this;
      return gn(this, function(i2) {
        return null !== (e2 = this.getByName(t2)) ? [2, e2] : this._loading[t2] ? [2, this._loading[t2]] : (r2 = new Promise(function(e3) {
          return q.loadByName(t2).then(function(t3) {
            return n2.onTemplateLoad(t3);
          }).then(e3);
        }), this._loading[t2] = r2, r2.finally(function() {
          return delete n2._loading[t2];
        }), [2, r2]);
      });
    });
  }, t.prototype.loadById = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2;
      return gn(this, function(i2) {
        switch (i2.label) {
          case 0:
            return i2.trys.push([0, 2, , 3]), [4, this.doLoadById(t2)];
          case 1:
            return e2 = i2.sent(), r2 = null, [3, 3];
          case 2:
            return n2 = i2.sent(), r2 = n2, [3, 3];
          case 3:
            return this._emitter.onTemplatesLoad(e2 ? [e2.className] : null, r2), [2, e2];
        }
      });
    });
  }, t.prototype.doLoadById = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2 = this;
      return gn(this, function(i2) {
        return (e2 = this.getById(t2)) ? [2, e2] : this._loading[t2] ? [2, this._loading[t2]] : (r2 = new Promise(function(e3) {
          return q.load(t2).then(function(t3) {
            return n2.onTemplateLoad(t3);
          }).then(e3);
        }), this._loading[t2] = r2, r2.finally(function() {
          return delete n2._loading[t2];
        }), [2, r2]);
      });
    });
  }, t.prototype.registerMany = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2 = this;
      return gn(this, function(i2) {
        switch (i2.label) {
          case 0:
            return e2 = t2.map(function(t3) {
              var e3 = n2.onTemplateLoad(t3);
              return n2._loading[t3.className] = e3, n2._loading["".concat(t3.className, "@").concat(t3.id)] = e3, e3;
            }), [4, Promise.all(e2.map(function(t3) {
              return t3.then(function(t4) {
                return t4.className;
              }).catch(function(t4) {
                return null;
              });
            }))];
          case 1:
            return r2 = i2.sent().filter(function(t3) {
              return !!t3;
            }), this._emitter.onTemplatesLoad(r2), [2, r2];
        }
      });
    });
  }, t.prototype.commit = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, q.create({ sourceId: t2.model.sourceId, script: t2.model.script, log: e2 })];
          case 1:
            return (r2 = n2.sent()).success && (t2.model.id = r2.id, this._emitter.onTemplateCommit(t2.className)), [2, r2];
        }
      });
    });
  }, t.prototype.getByName = function(t2, e2) {
    var r2;
    if (void 0 === e2 && (e2 = false), t2 && (r2 = t2.match(/(.+)@([0-9]+)/))) {
      t2 = r2[1];
      var n2 = parseInt(r2[2]);
      if (!this._loaded[t2]) return null;
      var i2 = this._loaded[t2].model;
      if (i2.id !== n2) {
        if (!e2) return null;
        this.verbose && console.log("[warning] template ".concat(t2, " version ").concat(n2, " is requested but ").concat(i2.id, " is used"));
      }
    }
    return this._loaded[t2] ? this._loaded[t2] : null;
  }, t.prototype.getById = function(t2) {
    var e2 = null;
    for (var r2 in this._loaded) if (this._loaded[r2].model.id === t2) {
      e2 = this._loaded[r2];
      break;
    }
    return e2;
  }, t;
}();
var ki = { Matrix2D: pt, Point: ht, Color: X, Font: Z, RenderingUnit: K, TextUnit: et, Graphic: nt, Phrase: ot, Word: it, Char: rt, Beat: Nn, RepetitiveSegment: jn };
var ji = ["headTime", "tailTime", "insomnia"];
var Ii = ["animate", "getAssignedUnit", "name", "type"];
var Ui = function() {
  function t(t2, e2, r2) {
    this._emitter = null, this._player = null, this.interpreter = null, this.unsafeAcceleration = false, this._verbose = false, this.ignoreVersion = false, this.rawConsole = false, this._player = t2, this._emitter = e2, this.unsafeAcceleration = r2, this.loader = new Ni(e2, this.register.bind(this)), t2.addListener({ onVideoReady: this.onVideoReady.bind(this) });
  }
  return Object.defineProperty(t.prototype, "verbose", { get: function() {
    return this._verbose;
  }, set: function(t2) {
    this._verbose = this.loader.verbose = t2;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "ready", { get: function() {
    return !!this.interpreter;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "loaded", { get: function() {
    return this.loader.loaded;
  }, enumerable: false, configurable: true }), t.prototype.initialize = function() {
    var t2 = this;
    if (!this.ready) {
      var e2 = function(t3) {
        var e3 = t3.player, r3 = t3.ignoredPropNames, i3 = t3.rawConsole, o2 = t3.templateGetter, s2 = e3.graphics.wrapperTable, a2 = new cn(fn(fn({}, ki), s2), r3, function(t4, r4) {
          return e3.graphics.isGraphics(t4) && r4 instanceof X ? r4.toString() : r4;
        }), u2 = { require: { func: function(t4) {
          if (!(t4.length < 1 || "string" != typeof t4[0])) {
            var e4 = t4[0], r4 = o2(e4);
            return null === r4 ? void 0 : r4.functionDefinition;
          }
        }, raw: true, isConstructor: true }, print: { func: function(t4) {
          e3.isEditing && console.log.apply(console, t4);
        }, raw: i3 }, findChorus: { func: function(t4) {
          return t4.length < 1 || "number" != typeof t4[0] ? null : e3.findChorus(t4[0]);
        } }, findBeat: { func: function(t4) {
          return t4.length < 1 || "number" != typeof t4[0] ? null : e3.findBeat(t4[0]);
        } }, getVocalFrequency: { func: function(t4) {
          return t4.length < 1 || "number" != typeof t4[0] ? null : e3.getVocalFrequency(t4[0]);
        } }, getVocalAmplitude: { func: function(t4) {
          return t4.length < 1 || "number" != typeof t4[0] ? -1 : e3.getVocalAmplitude(t4[0]);
        } }, getMaxVocalAmplitude: { func: function(t4) {
          return e3.getMaxVocalAmplitude();
        } }, getValenceArousal: { func: function(t4) {
          return t4.length < 1 || "number" != typeof t4[0] ? null : e3.getValenceArousal(t4[0]);
        } }, getMedianValenceArousal: { func: function(t4) {
          return e3.getMedianValenceArousal();
        } } };
        Object.keys(n).forEach(function(t4) {
          a2.setProperty(a2.globalScope, t4, n[t4]), u2[t4] = { value: n[t4] };
        }), Object.keys(xi).forEach(function(t4) {
          var e4 = xi[t4];
          0 !== t4.indexOf("get") && (u2[t4] = { func: e4 });
        });
        var c2 = Object.keys(a2.wrapperTable);
        return c2 && c2.forEach(function(t4) {
          return u2[t4] = { cls: a2.wrapperTable[t4] };
        }), Object.keys(u2).forEach(function(t4) {
          var e4 = u2[t4];
          e4.func ? a2.createGlobalFunction(t4, e4) : e4.value && a2.setProperty(a2.globalScope, t4, e4.value);
        }), { interpreter: a2, unsafeGlobalScope: u2 };
      }({ player: this._player, ignoredPropNames: Ii, rawConsole: this.rawConsole, templateGetter: function(e3) {
        return t2.getByName(e3, true);
      } }), r2 = e2.interpreter, i2 = e2.unsafeGlobalScope;
      this.unsafeGlobalScope = i2, this.interpreter = r2, this.onVideoReady(this._player.video);
    }
  }, t.prototype.getByName = function(t2, e2) {
    return void 0 === e2 && (e2 = false), this.loader.getByName(t2, e2);
  }, t.prototype.getById = function(t2) {
    return this.loader.getById(t2);
  }, t.prototype.clear = function() {
    this.loader.clear();
  }, t.prototype.loadLatest = function(t2) {
    return void 0 === t2 && (t2 = 100), yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return this.ready || this.initialize(), [2, this.loader.loadLatest(t2)];
      });
    });
  }, t.prototype.loadForVideo = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return this.ready || this.initialize(), [2, this.loader.loadForVideo(t2)];
      });
    });
  }, t.prototype.loadByNames = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return this.ready || this.initialize(), [2, this.loader.loadByNames(t2)];
      });
    });
  }, t.prototype.loadByName = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return this.ready || this.initialize(), [2, this.loader.loadByName(t2)];
      });
    });
  }, t.prototype.loadById = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return this.ready || this.initialize(), [2, this.loader.loadById(t2)];
      });
    });
  }, t.prototype.commit = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(r2) {
        return [2, this.loader.commit(t2, e2)];
      });
    });
  }, t.prototype.register = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2, r2, n2, i2, o2, s2, a2 = this;
      return gn(this, function(u2) {
        switch (u2.label) {
          case 0:
            if (!t2) return [2, null];
            if ("number" == typeof t2.sourceId) {
              if (e2 = t2, !(r2 = this.createClass(t2.script))) return [2, null];
            } else r2 = t2;
            n2 = nn(r2.ast).dependencies, u2.label = 1;
          case 1:
            return u2.trys.push([1, 3, , 4]), [4, Promise.all(n2.map(function(t3) {
              var e3 = a2.getByName(t3, a2.ignoreVersion);
              return e3 ? Promise.resolve(e3) : a2.loadByName(t3);
            }))];
          case 2:
            return u2.sent(), this.verbose && console.log("load dependencies for", r2.className, n2), [3, 4];
          case 3:
            return i2 = u2.sent(), this.verbose && console.error("failed loading dependencies for", r2.className, i2), [3, 4];
          case 4:
            try {
              if (!(e2 ? this.loadModel(r2, e2) : this.createModel(r2))) throw new Error("failed to create a template instance");
              return [2, this.registerClass(r2)];
            } catch (t3) {
              throw o2 = void 0, e2 && (delete (s2 = fn({}, e2)).script, o2 = s2), { error: t3.message, stack: t3.stack, cause: o2 };
            }
            return [2];
        }
      });
    });
  }, t.prototype.updateClassScript = function(t2, e2) {
    var r2 = this.createClass(e2);
    return this.updateClass(t2, r2);
  }, t.prototype.registerClass = function(t2) {
    if (!t2) return null;
    if (this.loader.loaded[t2.className]) {
      this.verbose && console.log("updating", t2.className, t2.model.id);
      var e2 = this.updateClass(this.loader.loaded[t2.className], t2);
      return this.verbose && console.log("updated", e2.className, e2.id), e2;
    }
    return this.loader.loaded[t2.className] = t2, this.verbose && console.log("loaded", t2.className, t2.model.id), t2;
  }, t.prototype.updateClass = function(t2, e2) {
    var r2 = t2, n2 = e2;
    if (!n2) return null;
    if (r2.model.script === n2.model.script) return this.verbose && console.log("no diff for", r2.className), r2;
    if (!this.createModel(n2)) return null;
    if (r2.className !== n2.className) {
      var i2 = this.getByName(n2.className);
      if (!i2) return n2.cursor = r2.cursor, this.loader.loaded[n2.className] = n2, this.verbose && console.log("create", n2.className), n2;
      r2 = i2;
    }
    return r2.newStatement = n2.newStatement, r2.widgets = n2.widgets, r2.scope = n2.scope, r2.functionDefinition = n2.functionDefinition, r2.newStatement = n2.newStatement, r2.unsafeConstructorGenerator = n2.unsafeConstructorGenerator, r2.ast = n2.ast, r2.cursor < 0 && (r2.cursor = n2.cursor), n2.id >= 0 ? (this.verbose && console.log("replace", n2.className, r2.id, n2.id), r2.model = n2.model) : (this.verbose && console.log("update", n2.className, r2.id, n2.id), r2.model.type = n2.model.type, r2.model.className = n2.model.className, r2.model.prettyName = n2.model.prettyName, r2.model.script = n2.model.script, r2.model.createdDate = null, r2.id >= 0 && (r2.model.sourceId = r2.model.id, r2.model.id = -1)), n2 = r2, this.updateInstances(r2.instances.slice(), n2), this._emitter.onTemplateUpdate(n2.className), n2;
  }, t.prototype.loadModel = function(t2, e2) {
    var r2 = this.newRawInstance(t2);
    return t2.model = e2, this.updateWidgetInitialValues(t2, r2), r2;
  }, t.prototype.createModel = function(t2) {
    var e2 = this.newRawInstance(t2);
    if (null === e2) return false;
    if (t2.id >= 0) return true;
    var r2 = e2.templateInstance, n2 = t2.model.script;
    return t2.model = { id: -1, sourceId: -1, className: t2.className, prettyName: r2 ? this.interpreter.getProperty(r2, "name") : e2.unsafeTemplateInstance.name, type: r2 ? this.interpreter.getProperty(r2, "type") : e2.unsafeTemplateInstance.type, script: n2, author: null, originalAuthor: null, createdDate: null }, this.updateWidgetInitialValues(t2, e2), e2;
  }, t.prototype.updateWidgetInitialValues = function(t2, e2) {
    var r2 = this;
    t2.widgets.forEach(function(t3) {
      t3.initialValue = r2.getProperty(e2, t3.name);
    });
  }, t.prototype.updateInstances = function(t2, e2) {
    var r2 = this;
    t2.forEach(function(t3) {
      try {
        r2.updateInstance(t3, e2);
      } catch (r3) {
        console.log("failed updating template for", t3.assignedUnit, ":", e2);
      }
    }), this._player.isPlaying || this._player.requestStageUpdate();
  }, t.prototype.createClass = function(t2) {
    var e2 = this;
    this.ready || this.initialize();
    var r2 = new Ri();
    r2.model = { id: -1, sourceId: -1, className: null, prettyName: null, type: 0, script: t2, author: null, originalAuthor: null, createdDate: null };
    var n2 = rn(t2, Ii), i2 = n2.ast, o2 = n2.widgets;
    if (r2.ast = i2, r2.widgets = o2, r2.className = r2.ast.body[0].id.name, r2.scope = this.interpreter.prepareRun(r2.ast), this.interpreter.run(1e3, "to define " + r2.className), r2.functionDefinition = this.interpreter.getRawProperty(r2.scope, r2.className), r2.newStatement = this.interpreter.newStatementFor(r2.className), this.unsafeAcceleration) {
      var s2 = Object.keys(this.unsafeGlobalScope), a2 = Object.keys(this.getGlobalProperties()).map(function(t3) {
        return "".concat(t3, "=props.").concat(t3);
      }).join(","), u2 = "return function(props){var ".concat(a2, ";").concat(t2, "return ").concat(r2.className, ";}"), c2 = new (Function.bind.apply(Function, vn(vn([void 0], s2, false), [u2], false)))(), l2 = function(t3) {
        var r3 = e2.getByName(t3);
        return r3 ? r3.unsafeConstructorGenerator(e2.getGlobalProperties()) : null;
      }, p2 = s2.map(function(t3) {
        if ("require" === t3) return l2;
        var r3 = e2.unsafeGlobalScope[t3];
        return r3.func ? function() {
          for (var t4 = [], e3 = 0; e3 < arguments.length; e3++) t4[e3] = arguments[e3];
          return r3.func(t4);
        } : r3.cls || r3.value;
      });
      r2.unsafeConstructorGenerator = c2.apply({}, p2);
    }
    return r2;
  }, t.prototype.getGlobalProperties = function() {
    var t2;
    return { width: this._player.videoWidth, height: this._player.videoHeight, margin: this._player.margin, duration: (null === (t2 = this._player.video) || void 0 === t2 ? void 0 : t2.duration) || 0 };
  }, t.prototype.newRawInstance = function(t2) {
    var e2 = t2, r2 = new Ci();
    if (this.unsafeAcceleration) {
      var n2 = new (e2.unsafeConstructorGenerator(this.getGlobalProperties()))();
      r2.unsafeTemplateInstance = n2;
    } else {
      this.interpreter.prepareNewInstance(e2.newStatement, e2.scope);
      var i2 = this.interpreter.run(700, "to instantiate " + e2.className);
      r2.templateInstance = i2, r2.templateInstance._nativeInstance = r2;
    }
    return r2.templateClass = e2, r2.ignore = false, r2;
  }, t.prototype.setProperty = function(t2, e2, r2) {
    this.unsafeAcceleration ? t2.unsafeTemplateInstance[e2] = r2 : this.interpreter.setProperty(t2.templateInstance, e2, r2);
  }, t.prototype.getProperty = function(t2, e2) {
    return this.unsafeAcceleration ? t2.unsafeTemplateInstance[e2] : this.interpreter.getProperty(t2.templateInstance, e2);
  }, t.prototype.exportInstance = function(t2) {
    for (var e2 = {}, r2 = 0, n2 = t2.templateClass.widgets.map(function(t3) {
      return t3.name;
    }).concat(ji); r2 < n2.length; r2++) {
      var i2 = n2[r2], o2 = this.getProperty(t2, i2);
      try {
        var s2 = gt(o2);
        void 0 !== s2 && (e2[i2] = s2);
      } catch (e3) {
        console.error("cannot export ".concat(t2.templateClass.className, ".").concat(i2), o2, "assigned to", t2.assignedUnit);
      }
    }
    return { type: t2.templateClass.className, value: e2 };
  }, t.prototype.importInstances = function(t2, e2) {
    try {
      this.importPhraseTemplates(t2.firstCredit, e2.credits), this.importPhraseTemplates(t2.firstPhrase, e2.phrases);
      for (var r2 = e2.graphics, n2 = t2.firstGraphic, i2 = 0; null !== n2; ) {
        var o2 = r2[i2++];
        this.importTemplates(n2, o2.templates), n2 = n2.next;
      }
    } catch (t3) {
      return console.error("restoring templates failed", t3), false;
    }
    return true;
  }, t.prototype.importPhraseTemplates = function(t2, e2) {
    if (Array.isArray(e2)) for (var r2 = 0; t2; ) {
      var n2 = e2[r2++];
      this.importTemplates(t2, n2.templates);
      for (var i2 = t2.firstWord, o2 = 0; o2 < t2.wordCount; o2++) {
        var s2 = n2.words[o2];
        this.importTemplates(i2, s2.templates);
        for (var a2 = i2.firstChar, u2 = 0; u2 < i2.charCount; u2++) {
          var c2 = s2.characters[u2];
          this.importTemplates(a2, c2.templates), a2 = a2.next;
        }
        i2 = i2.next;
      }
      if (e2.length < r2 + 1) break;
      t2 = t2.next;
    }
  }, t.prototype.importTemplates = function(t2, e2) {
    if (Array.isArray(e2)) for (var r2 = 0, n2 = e2; r2 < n2.length; r2++) {
      var i2 = n2[r2], o2 = this.importInstance(i2);
      o2 && t2.addTemplate(o2);
    }
  }, t.prototype.importInstance = function(t2) {
    var e2 = this.getByName(t2.type), r2 = this.newInstance(e2);
    if (!r2 || !t2.value) return null;
    for (var n2 = 0, i2 = Object.keys(t2.value); n2 < i2.length; n2++) {
      var o2 = i2[n2], s2 = vt(t2.value[o2], this.interpreter.wrapperTable);
      void 0 !== s2 && this.setProperty(r2, o2, s2);
    }
    return r2;
  }, t.prototype.updateInstance = function(t2, e2) {
    var r2 = t2, n2 = e2, i2 = this.newRawInstance(n2), o2 = r2.templateInstance, s2 = this.interpreter.cleanupProperties(o2);
    r2.templateClass !== n2 && (this.disposeInstance(r2), n2.instances.push(r2)), r2.templateClass = n2, r2.scope = i2.scope, r2.templateInstance = i2.templateInstance, r2.ignore = i2.ignore, this.interpreter.restoreProperties(r2.templateInstance, s2), this.attachGetAssignedUnitMethod(r2);
  }, t.prototype.newInstance = function(t2) {
    var e2;
    try {
      if (null === (e2 = this.newRawInstance(t2))) return null;
    } catch (t3) {
      return null;
    }
    return this.attachGetAssignedUnitMethod(e2), t2.instances.push(e2), e2;
  }, t.prototype.attachGetAssignedUnitMethod = function(t2) {
    var e2 = this;
    if (this.unsafeAcceleration) t2.unsafeTemplateInstance.getAssignedUnit = function() {
      return t2.assignedUnit;
    };
    else {
      var r2 = this.interpreter.createFunction(function() {
        return e2.interpreter.wrap(t2.assignedUnit);
      });
      this.interpreter.setRawProperty(t2.templateInstance, "getAssignedUnit", r2);
    }
  }, t.prototype.disposeInstance = function(t2) {
    var e2 = t2.templateClass;
    e2.instances = e2.instances.filter(function(e3) {
      return e3 !== t2;
    });
  }, t.prototype.disposeInstances = function(t2) {
    var e2 = this;
    if (Array.isArray(t2)) t2.forEach(function(t3) {
      return e2.disposeInstance(t3);
    });
    else {
      var r2 = t2;
      [r2.firstCredit, r2.firstPhrase, r2.firstWord, r2.firstChar, r2.firstGraphic].forEach(function(t3) {
        for (; t3; ) e2.disposeInstances(t3.removeTemplates()), t3 = t3.next;
      });
    }
  }, t.prototype.setTemplate = function(t2, e2) {
    this.removeTemplates(t2), t2.addTemplate(e2);
  }, t.prototype.clearTemplate = function(t2) {
    this.removeTemplates(t2);
  }, t.prototype.removeTemplateAt = function(t2, e2) {
    var r2 = t2.removeTemplateAt(e2);
    r2 && this.disposeInstance(r2);
  }, t.prototype.removeTemplates = function(t2) {
    var e2 = t2.removeTemplates();
    this.disposeInstances(e2);
  }, t.prototype.getRequiredTemplates = function(t2) {
    return nn(t2).dependencies;
  }, t.prototype.getRequiredTemplateAt = function(t2, e2) {
    return nn(t2, e2).dependencyAtCursor;
  }, t.prototype.exec = function(t2, e2, r2) {
    if (t2.unsafeTemplateInstance) {
      var n2 = t2.unsafeTemplateInstance;
      return n2[e2].apply(n2, r2);
    }
    var i2 = this.interpreter.exec(t2.templateInstance, e2, r2, t2.assignedUnit ? " assigned to " + t2.assignedUnit.toString() : "");
    return this.interpreter.unwrap(i2);
  }, t.prototype.declareVariable = function(t2, e2, r2, n2) {
    return this.updateClassScript(t2, function(t3, e3, r3, n3) {
      try {
        var i2 = rn(t3), o2 = i2.ast, s2 = i2.fields, a2 = s2[s2.length - 1], u2 = t3.match(/(\r\n|[\n\v\f\r\x85\u2028\u2029])/), c2 = u2 ? u2.pop() : "\n", l2 = t3.split(c2), p2 = a2 ? Array(a2.loc.start.column + 1).join(" ") : "  ", h2 = a2 ? a2.loc.end.line : 0;
        if (h2 <= 0) {
          var d2 = o2.body[0].body, f2 = l2[d2.loc.start.line - 1], y2 = f2.substring(0, d2.loc.start.column + 1), g2 = f2.substring(d2.loc.start.column + 1);
          l2[d2.loc.start.line - 1] = y2, l2.splice(d2.loc.start.line, 0, g2), h2 = d2.loc.start.line;
        }
        for (var v2 = void 0; (v2 = "var" + Math.random().toString().substring(2)).length > 8 && (v2 = v2.substring(0, 8)), !(t3.indexOf(v2) < 0); ) ;
        l2.length > h2 && l2[h2].length > 0 && l2.splice(h2, 0, ""), l2.splice(h2, 0, "", p2 + "// @proposed", p2 + "// @title " + e3, p2 + "// " + function(t4, e4) {
          if ("Slider" === t4) return "@ui Slider(" + e4.min + ", " + e4.max + ")";
          if ("Check" === t4) return "@ui Check()";
          if ("Color" === t4) return "@ui Color()";
          var r4 = e4.etc;
          return "@comment " + (r4 = r4.replace(/(\r\n|[\n\v\f\r\x85\u2028\u2029])/g, "")).replace(/\/[*/]/g, "");
        }(r3, n3), p2 + "this." + v2 + " = " + function(t4, e4) {
          return "Slider" === t4 ? ((e4.min + e4.max) / 2).toString() : "Check" === t4 ? "false" : "Color" === t4 ? 'new Color("#000000")' : "null";
        }(r3, n3) + ";"), t3 = l2.join(c2);
      } catch (t4) {
      }
      return t3;
    }(t2.model.script, e2, r2, n2));
  }, t.prototype.onVideoReady = function(t2) {
    this.ready && (this.interpreter.setRawProperty(this.interpreter.globalScope, "width", this._player.resolutionWidth), this.interpreter.setRawProperty(this.interpreter.globalScope, "height", this._player.resolutionHeight), this.interpreter.setRawProperty(this.interpreter.globalScope, "margin", this.interpreter.wrap(this._player.margin)), this.interpreter.setRawProperty(this.interpreter.globalScope, "duration", (null == t2 ? void 0 : t2.duration) || 0));
  }, t;
}();
var Fi = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><style>.bg{fill:#1f4391;}.fg{fill:#fff;}</style></defs><g class="logo-sq"><rect class="bg" x="-20" y="-20" width="240" height="240"/><g class="textalive-logo-art"><path class="fg" d="M97.33,130.81V142a3,3,0,0,0,4.78,2.41l56.81-42.09a3,3,0,0,0,0-4.81l-8.33-6.14Z"/><path class="fg" d="M137.14,81.43l-35-25.84A3,3,0,0,0,97.33,58v52.92Z"/><path class="fg" d="M51,55H80.33a2,2,0,0,1,2,2V71.67a0,0,0,0,1,0,0H51a2,2,0,0,1-2-2V57A2,2,0,0,1,51,55Z"/><path class="fg" d="M44.83,107.5h56.33a2,2,0,0,1,2,2v12.67a2,2,0,0,1-2,2H44.83a0,0,0,0,1,0,0V107.5A0,0,0,0,1,44.83,107.5Z" transform="translate(189.83 41.84) rotate(90)"/></g></g></svg>';
var Li = "https://textalive.jp";
var Di = function() {
  function t(t2) {
    var e2, r2 = this;
    if (this.player = t2, this._position = "embed", this._rounded = false, this._bordered = false, this._shadowed = false, this._background = "#fff", this._color = "#1f4391", void 0 !== (null === (e2 = t2.options) || void 0 === e2 ? void 0 : e2.mediaBannerPosition) && (this._position = t2.options.mediaBannerPosition), this.domEnabled) {
      this.logoAnchor = document.createElement("a"), this.logoAnchor.className = "textalive-logo", this.logoAnchor.innerHTML = Fi, this.logoAnchor.style.padding = this.bordered ? "1px 2px" : "1px 3px", this.logoAnchor.href = Li, this.logoAnchor.target = "_blank", this.logoAnchor.title = "Powered by TextAlive App API", this.logoSvg = this.logoAnchor.querySelector("svg"), this.logoSvg.style.width = "24px", this.songNameDiv = document.createElement("div"), this.songNameDiv.className = "name", this.songNameDiv.style.fontWeight = "bold", this.songNameDiv.style.overflow = "hidden", this.songNameDiv.style.textOverflow = "ellipsis", this.songNameDiv.style.marginBottom = "2px", this.songNameDiv.textContent = "-", this.songArtistDiv = document.createElement("div"), this.songArtistDiv.className = "artist", this.songArtistDiv.textContent = "-", this.songArtistDiv.style.overflow = "hidden", this.songArtistDiv.style.textOverflow = "ellipsis";
      var n2 = document.createElement("span");
      n2.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 150"><g class="song"><path d="M120.95,45.77l-59.12,13a2.57,2.57,0,0,0-2,2.51v47.8c0,13.61-12.4,23.74-24.2,23.74-8.92,0-14.82-4.23-14.82-13,0-13,12.86-21.93,23.9-21.93a16.33,16.33,0,0,1,10,3V35a2.57,2.57,0,0,1,2-2.51l69.41-15.29a2.57,2.57,0,0,1,3.13,2.51V92.84c0,13.61-12.1,23.9-24.2,23.9-8.92,0-14.82-4.24-14.82-13,0-13.16,12.86-21.93,23.9-21.93a16.31,16.31,0,0,1,10,2.87V48.29A2.57,2.57,0,0,0,120.95,45.77Z"/><path d="M35.61,134.36c-10.22,0-16.32-5.42-16.32-14.51,0-13.81,13.38-23.43,25.4-23.43a18.4,18.4,0,0,1,8.48,1.88V35a4,4,0,0,1,3.2-4l69.41-15.29a4.07,4.07,0,0,1,5,4V92.83c0,15-13.54,25.4-25.7,25.4-10.22,0-16.32-5.42-16.32-14.51,0-13.81,13.38-23.43,25.4-23.43A19,19,0,0,1,122.57,82V48.29a1.07,1.07,0,0,0-1.3-1h0l-59.12,13a1.08,1.08,0,0,0-.84,1v47.8C61.3,124,47.76,134.36,35.61,134.36Zm9.07-34.94c-10.57,0-22.4,8.74-22.4,20.43,0,10,8.35,11.51,13.32,11.51,13.38,0,22.7-11.72,22.7-22.24V61.31a4.1,4.1,0,0,1,3.2-4l59.12-13h0a4.07,4.07,0,0,1,5,4V87.56l-2.37-1.67a14.88,14.88,0,0,0-9.12-2.6c-10.59,0-22.4,8.39-22.4,20.43,0,10,8.35,11.51,13.32,11.51,10.74,0,22.7-9.2,22.7-22.4V19.72a1.07,1.07,0,0,0-1.3-1L57,34a1.07,1.07,0,0,0-.84,1v68.83l-2.37-1.67A14.87,14.87,0,0,0,44.68,99.42Z"/></g></svg>', n2.style.padding = "0 3px 0 0", this.songSvg = n2.querySelector("svg"), this.songSvg.style.width = "14px", this.songWrapper = document.createElement("div"), this.songWrapper.style.width = "203px", this.songWrapper.style.maxWidth = "203px", this.songWrapper.appendChild(this.songNameDiv), this.songWrapper.appendChild(this.songArtistDiv), this.songAnchor = document.createElement("a"), this.songAnchor.className = "song", this.songAnchor.target = "_blank", this.songAnchor.style.display = "flex", this.songAnchor.style.lineHeight = "1.2em", this.songAnchor.style.padding = "4px 3px 3px 3px", this.songAnchor.style.textDecoration = "none", this.songAnchor.appendChild(n2), this.songAnchor.appendChild(this.songWrapper), this.lyricsNameDiv = document.createElement("div"), this.lyricsNameDiv.className = "name", this.lyricsNameDiv.style.fontWeight = "bold", this.lyricsNameDiv.textContent = "-", this.lyricsNameDiv.style.overflow = "hidden", this.lyricsNameDiv.style.textOverflow = "ellipsis", this.lyricsNameDiv.style.marginBottom = "2px", this.lyricsArtistDiv = document.createElement("div"), this.lyricsArtistDiv.className = "artist", this.lyricsArtistDiv.textContent = "-", this.lyricsArtistDiv.style.overflow = "hidden", this.lyricsArtistDiv.style.textOverflow = "ellipsis";
      var i2 = document.createElement("span");
      i2.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 150"><g class="lyrics"><path d="M78,126.3H67.52l-6.26-23.82H24.4L18.14,126.3H7.7L35.7,22H50ZM27,92.39H58.65l-15.82-61Z"/><path d="M78,128.3H67.52a2,2,0,0,1-1.93-1.49l-5.87-22.33H25.94l-5.87,22.33a2,2,0,0,1-1.93,1.49H7.7a2,2,0,0,1-1.93-2.52l28-104.34A2,2,0,0,1,35.7,20H50a2,2,0,0,1,1.93,1.48l28,104.34A2,2,0,0,1,78,128.3Zm-8.89-4h6.29L48.43,24H37.23L10.31,124.3h6.28L22.46,102a2,2,0,0,1,1.93-1.49H61.26A2,2,0,0,1,63.2,102ZM58.65,94.39H27a2,2,0,0,1-1.94-2.5l15.82-61a2,2,0,0,1,3.87,0l15.82,61a2,2,0,0,1-1.94,2.5Zm-29.06-4H56.07L42.83,39.32Z"/><path d="M106.82,128c-17.74,0-26.43-13-26.43-36.52S89.09,55,106.82,55a21.78,21.78,0,0,1,15.83,6.43L134,56.22V112c0,5.22,1.56,8,4.7,8a7.31,7.31,0,0,0,3.65-1v6.61A17.77,17.77,0,0,1,133.6,128a9.61,9.61,0,0,1-9.74-7.65A22.4,22.4,0,0,1,106.82,128Zm0-10.09a18.15,18.15,0,0,0,16.69-10.61V75.7a18.15,18.15,0,0,0-16.69-10.61c-11.3,0-16,9.56-16,26.43S95.52,118,106.82,118Z"/><path d="M133.6,130A11.61,11.61,0,0,1,123.08,124,24.48,24.48,0,0,1,106.82,130c-13,0-28.43-6.68-28.43-38.52S93.85,53,106.82,53A23.88,23.88,0,0,1,123,59.05l10.08-4.65A2,2,0,0,1,136,56.22V112c0,4,.91,6,2.7,6a5.3,5.3,0,0,0,2.66-.78,2,2,0,0,1,3,1.74v6.61a2,2,0,0,1-1,1.74A19.64,19.64,0,0,1,133.6,130Zm-9.74-11.65a2,2,0,0,1,1.95,1.55,7.63,7.63,0,0,0,7.79,6.1,15.19,15.19,0,0,0,6.69-1.64v-2.52a8.51,8.51,0,0,1-1.65.16c-2.5,0-6.7-1.3-6.7-10V59.34l-8.46,3.91a2,2,0,0,1-2.25-.4A19.67,19.67,0,0,0,106.82,57C90.61,57,82.39,68.62,82.39,91.52S90.61,126,106.82,126a20.33,20.33,0,0,0,15.55-7A2,2,0,0,1,123.86,118.39Zm-17,1.57c-11.94,0-18-9.57-18-28.43s6.06-28.43,18-28.43a20.07,20.07,0,0,1,18.5,11.75,2,2,0,0,1,.19.86v31.65a2,2,0,0,1-.19.86A20.06,20.06,0,0,1,106.82,120Zm0-52.86c-12.55,0-14,13.94-14,24.43,0,21.9,8,24.43,14,24.43a16.13,16.13,0,0,0,14.69-9.07V76.16A16.13,16.13,0,0,0,106.82,67.09Z"/></g></svg>', i2.style.padding = "0 3px 0 0", this.lyricsSvg = i2.querySelector("svg"), this.lyricsSvg.style.width = "14px", this.lyricsWrapper = document.createElement("div"), this.lyricsWrapper.style.width = "90px", this.lyricsWrapper.style.maxWidth = "90px", this.lyricsWrapper.appendChild(this.lyricsNameDiv), this.lyricsWrapper.appendChild(this.lyricsArtistDiv), this.lyricsAnchor = document.createElement("a"), this.lyricsAnchor.className = "lyrics", this.lyricsAnchor.target = "_blank", this.lyricsAnchor.style.display = "flex", this.lyricsAnchor.style.lineHeight = "1.2em", this.lyricsAnchor.style.padding = "4px 3px 3px 3px", this.lyricsAnchor.style.textDecoration = "none", this.lyricsAnchor.appendChild(i2), this.lyricsAnchor.appendChild(this.lyricsWrapper), this.bannerDiv = document.createElement("div"), this.bannerDiv.className = "textalive-banner", this.bannerDiv.style.cursor = "pointer", this.bannerDiv.style.zIndex = "10000", this.bannerDiv.style.background = "#1f4391", this.bannerDiv.style.lineHeight = "0", this.bannerDiv.style.display = "flex", this.bannerDiv.style.maxWidth = "256px", this.bannerDiv.style.fontFamily = "'Hiragino Kaku Gothic Pro','','Yu Gothic',YuGothic,Meiryo,HelveticaNeue,'Helvetica Neue',Helvetica,Arial,sans-serif", this.bannerDiv.style.fontSize = "9px", this.bannerDiv.style.alignItems = "center", this.bannerDiv.style.whiteSpace = "nowrap", this.bannerDiv.appendChild(this.logoAnchor), this.bannerDiv.appendChild(this.songAnchor), this.bannerDiv.appendChild(this.lyricsAnchor), this.songAnchor.style.display = "none", this.lyricsAnchor.style.display = "none", this.updatePosition(), this.updateRounded(), this.updateBordered(), this.updateShadowed(), this.updateBackground(), this.updateColor();
    }
    this.listener = { onAppReady: function() {
      r2.updatePosition();
    }, onMediaElementSet: function(t3) {
      r2.domEnabled && (r2.bannerDiv && r2.bannerDiv.parentElement && r2.bannerDiv.parentElement.removeChild(r2.bannerDiv), r2.player.mediaBannerElement && r2.player.mediaBannerElement.appendChild(r2.bannerDiv));
    }, onVideoLoad: function() {
      r2.domEnabled && (r2.logoAnchor.href = Li, r2.songAnchor.style.display = "none", r2.lyricsAnchor.style.display = "none", r2.songAnchor.style.borderRadius = "0");
    }, onSongLoad: function(t3) {
      return yn(r2, 0, void 0, function() {
        var e3, r3, n3, i3, o2, s2, a2, u2, l2;
        return gn(this, function(p2) {
          switch (p2.label) {
            case 0:
              return t3 ? (e3 = null === (a2 = null === (s2 = null == t3 ? void 0 : t3.song) || void 0 === s2 ? void 0 : s2.artist) || void 0 === a2 ? void 0 : a2.name, r3 = null === (u2 = null == t3 ? void 0 : t3.song) || void 0 === u2 ? void 0 : u2.name, n3 = null === (l2 = null == t3 ? void 0 : t3.song) || void 0 === l2 ? void 0 : l2.permalink, i3 = "".concat(Li).concat(n3 ? "/songs/".concat(encodeURIComponent(c.getSongPathFromUrl(n3))) : ""), this.domEnabled && (this.logoAnchor.href = i3, this.songArtistDiv.textContent = Mi(e3), this.songNameDiv.textContent = Mi(r3), this.songAnchor.title = "".concat(Mi(r3), " by ").concat(Mi(e3)), this.songAnchor.href = n3, this.songAnchor.style.display = "flex", this.songAnchor.style.borderRadius = this.rounded ? "0 4px 4px 0" : "0", this.songWrapper.style.width = "auto"), [4, A.getServerStatus()]) : [2];
            case 1:
              return "ja" === (null == (o2 = p2.sent()) ? void 0 : o2.lang) ? console.warn("[TextAlive API]  :", Mi(e3), "/ :", Mi(r3), "/ :", Mi(n3)) : console.warn("[TextAlive API] Song artist:", Mi(e3), "/ song name:", Mi(r3), "/ distributed at:", Mi(n3)), [2];
          }
        });
      });
    }, onLyricsLoad: function(t3) {
      t3 && r2.domEnabled && (r2.songWrapper.style.maxWidth = "90px", r2.lyricsAnchor.style.display = "flex", r2.songAnchor.style.borderRadius = "0");
    }, onTextLoad: function(t3) {
      return yn(r2, 0, void 0, function() {
        var e3, r3, n3, i3, o2;
        return gn(this, function(s2) {
          switch (s2.label) {
            case 0:
              return t3 ? (e3 = null === (o2 = null == t3 ? void 0 : t3.artist) || void 0 === o2 ? void 0 : o2.name, r3 = null == t3 ? void 0 : t3.name, n3 = null == t3 ? void 0 : t3.url, this.domEnabled && (this.lyricsArtistDiv.textContent = Mi(e3), this.lyricsNameDiv.textContent = Mi(r3), this.lyricsAnchor.title = "".concat(Mi(r3), " by ").concat(Mi(e3)), this.lyricsAnchor.href = n3, this.lyricsWrapper.style.width = "auto"), [4, A.getServerStatus()]) : [2];
            case 1:
              return "ja" === (null == (i3 = s2.sent()) ? void 0 : i3.lang) ? console.warn("[TextAlive API]  :", Mi(e3), "/ :", Mi(r3), "/ :", Mi(n3)) : console.warn("[TextAlive API] Song lyrics artist:", Mi(e3), "/ lyrics name:", Mi(r3), "/ distributed at:", Mi(n3)), [2];
          }
        });
      });
    }, onDispose: function() {
      r2.dispose();
    } }, t2.addListener(this.listener), t2.mediaBannerElement && this.player.mediaBannerElement.appendChild(this.bannerDiv);
  }
  return Object.defineProperty(t.prototype, "domEnabled", { get: function() {
    return "undefined" != typeof window && "undefined" != typeof document && "function" == typeof document.createElement;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "position", { get: function() {
    return this._position;
  }, set: function(t2) {
    this._position = t2, this.updatePosition();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "rounded", { get: function() {
    return this._rounded;
  }, set: function(t2) {
    this._rounded = t2, this.updateRounded();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "bordered", { get: function() {
    return this._bordered;
  }, set: function(t2) {
    this._bordered = t2, this.updateBordered();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "shadowed", { get: function() {
    return this._shadowed;
  }, set: function(t2) {
    this._shadowed = t2, this.updateShadowed();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "background", { get: function() {
    return this._background;
  }, set: function(t2) {
    this._background = t2, this.updateBackground();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "color", { get: function() {
    return this._color;
  }, set: function(t2) {
    this._color = t2, this.updateColor();
  }, enumerable: false, configurable: true }), t.prototype.dispose = function() {
    this.player.removeListener(this.listener);
  }, t.prototype.updatePosition = function() {
    var t2, e2;
    if (this.domEnabled) {
      var r2 = this.position, n2 = this.player;
      if (null === r2 || !(null === (t2 = n2.options) || void 0 === t2 ? void 0 : t2.app) || (null === (e2 = n2.app) || void 0 === e2 ? void 0 : e2.managed)) this.bannerDiv.style.display = "none";
      else if (this.bannerDiv.style.display = "flex", "embed" === r2) this.bannerDiv.style.position = "initial", this.bannerDiv.style.marginTop = "4px", this.songAnchor.style.flexGrow = "1", this.lyricsAnchor.style.flexGrow = "1";
      else {
        this.bannerDiv.style.position = "fixed", this.bannerDiv.style.marginTop = "0";
        var i2 = r2.indexOf("top") >= 0, o2 = r2.indexOf("right") >= 0, s2 = r2.indexOf("bottom") >= 0, a2 = r2.indexOf("left") >= 0;
        this.bannerDiv.style.top = i2 ? "4px" : "initial", this.bannerDiv.style.right = o2 ? "4px" : "initial", this.bannerDiv.style.bottom = s2 ? "4px" : "initial", this.bannerDiv.style.left = a2 ? "4px" : "initial", this.songAnchor.style.flexGrow = "0", this.lyricsAnchor.style.flexGrow = "0";
      }
    }
  }, t.prototype.updateRounded = function() {
    if (this.domEnabled) {
      var t2 = this.rounded;
      this.logoSvg.style.borderRadius = t2 ? "4px 0 0 4px" : "0", this.lyricsAnchor.style.borderRadius = t2 ? "0 4px 4px 0" : "0", this.bannerDiv.style.borderRadius = t2 ? "4px" : "0";
    }
  }, t.prototype.updateBordered = function() {
    if (this.domEnabled) {
      var t2 = this.bordered;
      this.logoAnchor.style.padding = t2 ? "1px 2px" : "1px 3px", this.bannerDiv.style.border = t2 ? "1px solid rgba(31, 67, 145, 0.3)" : "none";
    }
  }, t.prototype.updateShadowed = function() {
    if (this.domEnabled) {
      var t2 = this.shadowed;
      this.bannerDiv.style.boxShadow = t2 ? "1px 1px 3px 0 rgba(9, 19, 42, 0.9)" : "none";
    }
  }, t.prototype.updateBackground = function() {
    this.domEnabled && (this.songAnchor.style.background = this.background, this.lyricsAnchor.style.background = this.background);
  }, t.prototype.updateColor = function() {
    this.domEnabled && (this.songSvg.style.fill = this.color, this.songAnchor.style.color = this.color, this.lyricsSvg.style.fill = this.color, this.lyricsAnchor.style.color = this.color);
  }, t;
}();
function Mi(t) {
  return t && "" !== t ? t : "-";
}
var Bi = function() {
  this.halted = [], this.errors = [];
};
var Vi = function() {
  function t(t2, e2) {
    var r2 = this;
    this.listener = e2, this.player = null, this._scale = 1, this.playerListener = { onResize: function(t3) {
      r2.elementWidth = Math.floor(t3.width), r2.updateSize();
    }, onVideoReady: function() {
      r2.elementWidth = r2.calcWidth(), r2.updateSize();
    }, onStageElementSet: function(t3) {
      r2.elementWidth = r2.calcWidth(), r2.updateSize(), r2.player.graphics.setCanvas(t3);
    }, onDispose: function() {
      r2.dispose();
    } }, this.requestedTime = 0, this.request = null, this.player = t2, t2.addListener(this.playerListener);
  }
  return Object.defineProperty(t.prototype, "scale", { get: function() {
    return this._scale;
  }, set: function(t2) {
    this._scale = t2, this.updateSize();
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "width", { get: function() {
    return this.player.graphics.width;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "height", { get: function() {
    return this.player.graphics.height;
  }, enumerable: false, configurable: true }), t.prototype.requestUpdate = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2 = this;
      return gn(this, function(r2) {
        return this.requestedTime = void 0 === t2 ? this.player.videoPosition : t2, this.request || (this.request = new Promise(function(t3) {
          setTimeout(function() {
            try {
              e2.update(e2.requestedTime);
            } catch (t4) {
            }
            e2.request = null, t3(e2.requestedTime);
          }, 0);
        })), [2, this.request];
      });
    });
  }, t.prototype.update = function(t2) {
    t2 || (t2 = this.player.mediaPosition), "number" == typeof t2 && (this.player.graphics.reset(), this.animate(t2), this.player.graphics.update(), this.listener.onStageUpdate(t2));
  }, t.prototype.animate = function(t2) {
    for (var e2 = new Bi(), r2 = e2.errors, n2 = e2.halted, i2 = 0, o2 = [this.player.video.firstCredit, this.player.video.firstPhrase, this.player.video.firstWord, this.player.video.firstChar, this.player.video.firstGraphic]; i2 < o2.length; i2++) for (var s2 = o2[i2]; s2; ) this.animateRenderingUnit(t2, s2, e2), s2 = s2.next;
    if (n2.length > 0) {
      console.error("---");
      for (var a2 = 0; a2 < n2.length; a2++) console.error("halted", n2[a2], r2[a2]);
    }
  }, t.prototype.animateRenderingUnit = function(t2, e2, r2) {
    if (e2.animate) e2.animate(t2, e2);
    else if (e2.templateCount <= 0) Gi(e2) && e2.getType() === n.CHAR && (e2.rendering.visible = false);
    else for (var i2 = 0; i2 < e2.templateCount; i2++) this.animateTemplate(t2, e2, e2.getTemplate(i2), r2);
  }, t.prototype.animateTemplate = function(t2, e2, r2, i2) {
    var o2 = this;
    if (r2.ignore) e2.rendering.visible = false;
    else {
      if (e2.getType() !== n.GRAPHIC) for (var s2 = e2.parent; s2; ) {
        if (s2.templateCount > 0 && (!s2.rendering.visible || 0 === s2.rendering.alpha)) return void (e2.rendering.visible = false);
        s2 = s2.parent;
      }
      var a2 = this.player.templates.getProperty(r2, "insomnia"), u2 = Gi(e2);
      if (!a2 && u2) {
        var c2 = function(t3, e3, r3, i3) {
          var o3 = i3 && t3(i3, "headTime") || 500, s3 = i3 && t3(i3, "tailTime") || 500;
          return !(r3.startTime - o3 <= e3 && r3.endTime + s3 >= e3) && (r3.getType() !== n.GRAPHIC && (r3.rendering.visible = false), true);
        }(function(t3, e3) {
          return o2.player.templates.getProperty(t3, e3);
        }, t2, e2, r2);
        if (c2) return;
      }
      this.doAnimateTemplate(t2, r2, i2);
    }
  }, t.prototype.doAnimateTemplate = function(t2, e2, r2) {
    var n2 = r2.errors, i2 = r2.halted;
    try {
      this.player.templates.exec(e2, "animate", [t2]);
    } catch (t3) {
      n2.push(t3), i2.push(e2);
    }
  }, t.prototype.calcWidth = function() {
    var t2 = this.player.stageElement;
    if (!t2) return 0;
    var e2 = window.getComputedStyle(t2);
    return t2.offsetWidth - ln(e2.borderLeftWidth) - ln(e2.borderRightWidth) - ln(e2.paddingLeft) - ln(e2.paddingRight);
  }, t.prototype.updateSize = function() {
    var t2 = this.player.stageElement;
    if (t2) {
      var e2 = this.elementWidth * this.player.videoProportion;
      if (t2.style.height = "".concat(e2, "px"), t2.width = this.elementWidth * this._scale, t2.height = e2 * this._scale, this.player.video) {
        var r2 = t2.width / this.player.videoWidth;
        this.player.graphics.updateStageTx(r2, this.player.margin), this.player.isPlaying || this.requestUpdate();
      }
    }
  }, t.prototype.dispose = function() {
    this.player.removeListener(this.playerListener), this.player = null;
  }, t;
}();
function Gi(t) {
  if (t.getType() === n.GRAPHIC) return true;
  for (var e2 = true, r2 = t.parent; r2; ) {
    if (r2.templateCount > 0) {
      e2 = false;
      break;
    }
    r2 = r2.parent;
  }
  return e2;
}
var qi = function(t) {
  function e2(e3, r2) {
    var n2 = this.constructor, i2 = t.call(this, e3) || this;
    return i2.video = r2, Object.setPrototypeOf(i2, n2.prototype), i2;
  }
  return dn(e2, t), e2;
}(Error);
function Wi(t, e2) {
  var r2 = e2.parser;
  return yn(this, 0, void 0, function() {
    var e3, n2, i2;
    return gn(this, function(o2) {
      switch (o2.label) {
        case 0:
          return t && t.length > 0 && t[0].words && t[0].words.length > 0 && t[0].words[0] && !t[0].words[0].pos ? (e3 = t.map(function(t2) {
            return t2.words.map(function(t3) {
              return t3.characters.map(function(t4) {
                return t4.char;
              }).join("");
            }).join(" ");
          }), n2 = e3.join("\n"), [4, r2(n2)]) : [2];
        case 1:
          return (i2 = o2.sent()) && "success" === i2.status ? (t.forEach(function(t2, r3) {
            var n3 = i2.result[r3], o3 = 0;
            t2.words.forEach(function(t3) {
              var i3 = t3.characters.map(function(t4) {
                return t4.char;
              }).join(""), s2 = e3[r3].indexOf(i3, o3);
              if (!(s2 < 0)) {
                o3 = s2;
                var a2 = n3.find(function(t4) {
                  return t4.startPosition <= s2 && t4.endPosition >= s2;
                });
                a2 && (t3.pos = a2.PoS, t3.rawPoS = a2.rawPoS, t3.language = a2.language);
              }
            });
          }), [2]) : [2];
      }
    });
  });
}
function Yi(t) {
  for (; t.firstElementChild; ) t.removeChild(t.firstElementChild);
}
function zi(t, e2) {
  var r2 = e2.id, n2 = e2.data, i2 = e2.loader, o2 = e2.deserializer;
  return yn(this, 0, void 0, function() {
    return gn(this, function(e3) {
      switch (e3.label) {
        case 0:
          return r2 && r2 >= 0 ? [4, i2(r2)] : [3, 2];
        case 1:
          e3.sent(), e3.label = 2;
        case 2:
          return o2(t, n2), [2];
      }
    });
  });
}
function Ji(t) {
  return "string" != typeof t ? t : "undefined" == typeof window ? null : document.querySelector(t);
}
var Hi = function() {
  function t(t2) {
    this._mediaPosition = 0, this._videoPosition = 0, this.isEditing = false, this._isVideoSeeking = false, this._volume = 100, this._options = t2, this.emitter = new On(t2), this._templates = new Ui(this, this.emitter, t2 && t2.unsafeAcceleration);
    var e2 = Object.assign({}, Y);
    t2 && t2.managers && (e2 = Object.assign(e2, t2.managers)), this.managers = e2, this._timer = t2 && t2.timer || this.createDefaultTimer(), this._data = new Vn(e2, this.emitter, t2), this._backgroundGraphics = new Sn(this, e2.asset, this.emitter), this._graphics = t2 && t2.graphics || this.createDefaultGraphicsDriver(), this.stage = new Vi(this, { onStageUpdate: this.onStageUpdate.bind(this) }), this._banner = new Di(this), this.stageElement = Ji(null == t2 ? void 0 : t2.stageElement) || null, this.mediaElement = Ji(null == t2 ? void 0 : t2.mediaElement) || null, this._app = new Gn(this, this.emitter);
  }
  return Object.defineProperty(t.prototype, "options", { get: function() {
    return this._options ? fn({}, this._options) : null;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "app", { get: function() {
    return this._app;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "data", { get: function() {
    return this._data;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "backgroundGraphics", { get: function() {
    return this._backgroundGraphics;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "video", { get: function() {
    return this._video;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "templates", { get: function() {
    return this._templates;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "graphics", { get: function() {
    return this._graphics;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "stageElement", { get: function() {
    return this._stageElement;
  }, set: function(t2) {
    this._stageElement = t2, this.emitter.onStageElementSet(t2);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "stageScale", { get: function() {
    return this.stage.scale;
  }, set: function(t2) {
    this.stage.scale = t2;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "mediaElement", { get: function() {
    return this._mediaElement;
  }, set: function(t2) {
    this.updateMediaElement(t2);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "mediaSourceElement", { get: function() {
    return this._mediaSourceElement;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "mediaBannerElement", { get: function() {
    return this._mediaBannerElement;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "mediaPosition", { get: function() {
    return this._mediaPosition;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "videoPosition", { get: function() {
    return this._videoPosition;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "wait", { get: function() {
    return this._timer ? this._timer.wait : 0;
  }, set: function(t2) {
    this._timer && (this._timer.wait = t2);
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "fps", { get: function() {
    return 1e3 / this.wait;
  }, set: function(t2) {
    this.wait = 1e3 / t2;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "resolutionWidth", { get: function() {
    var t2, e2, r2, n2;
    return "object" == typeof (null === (e2 = null === (t2 = this._data) || void 0 === t2 ? void 0 : t2.video) || void 0 === e2 ? void 0 : e2.config) && "number" == typeof this._data.video.config.width ? this._data.video.config.width : "number" == typeof (null === (n2 = null === (r2 = this._options) || void 0 === r2 ? void 0 : r2.defaultVideoSize) || void 0 === n2 ? void 0 : n2.width) ? this._options.defaultVideoSize.width : 1280;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "resolutionHeight", { get: function() {
    var t2, e2, r2, n2;
    return "object" == typeof (null === (e2 = null === (t2 = this._data) || void 0 === t2 ? void 0 : t2.video) || void 0 === e2 ? void 0 : e2.config) && "number" == typeof this._data.video.config.height ? this._data.video.config.height : "number" == typeof (null === (n2 = null === (r2 = this._options) || void 0 === r2 ? void 0 : r2.defaultVideoSize) || void 0 === n2 ? void 0 : n2.height) ? this._options.defaultVideoSize.height : 720;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "resolutionProportion", { get: function() {
    return this.resolutionHeight / this.resolutionWidth;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "margin", { get: function() {
    var t2, e2, r2, n2;
    return "object" == typeof (null === (e2 = null === (t2 = this._data) || void 0 === t2 ? void 0 : t2.video) || void 0 === e2 ? void 0 : e2.config) && this._data.video.config.margin ? this._data.video.config.margin : (null === (n2 = null === (r2 = this._options) || void 0 === r2 ? void 0 : r2.defaultVideoSize) || void 0 === n2 ? void 0 : n2.margin) || _n;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "videoWidth", { get: function() {
    var t2 = this.resolutionWidth, e2 = this.margin;
    return t2 + e2[1] + e2[3];
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "videoHeight", { get: function() {
    var t2 = this.resolutionHeight, e2 = this.margin;
    return t2 + e2[0] + e2[2];
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "videoProportion", { get: function() {
    return this.videoHeight / this.videoWidth;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "stageWidth", { get: function() {
    return this.stage.width;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "stageHeight", { get: function() {
    return this.stage.height;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "isLoading", { get: function() {
    return !!this._videoPromise;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "isPlaying", { get: function() {
    return !!this._timer && this._timer.isPlaying;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "isVideoSeeking", { get: function() {
    return this._isVideoSeeking;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "banner", { get: function() {
    return this._banner;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "timer", { get: function() {
    return this._timer;
  }, enumerable: false, configurable: true }), Object.defineProperty(t.prototype, "volume", { get: function() {
    return this._volume;
  }, set: function(t2) {
    isNaN(t2) || (this._volume = Math.min(100, Math.max(0, t2)), this.emitter.onVolumeUpdate(this._volume));
  }, enumerable: false, configurable: true }), t.prototype.createDefaultTimer = function() {
    try {
      if ("undefined" != typeof window && "basic" !== pn("ta_timer")) return new En();
    } catch (t2) {
    }
    return new wn();
  }, t.prototype.createDefaultGraphicsDriver = function() {
    return new yt();
  }, t.prototype.addListener = function(t2) {
    return this.emitter.addListener(t2);
  }, t.prototype.removeListener = function(t2) {
    return this.emitter.removeListener(t2);
  }, t.prototype.createFromVideoId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromVideoId(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromVideoId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, (r2 = new Vn(this.managers, this.emitter, this._options)).createFromVideoId(t2, null == e2 ? void 0 : e2.video)];
          case 1:
            return n2.sent(), [2, this.finalize(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromVideo = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromVideo(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromVideo = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        return (r2 = new Vn(this.managers, this.emitter, this._options)).createFromVideo(t2, null == e2 ? void 0 : e2.video), [2, this.finalize(r2, e2)];
      });
    });
  }, t.prototype.createFromSongUrl = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromSongUrl(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromSongUrl = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, (r2 = new Vn(this.managers, this.emitter, this._options)).createFromSongUrl(t2, null == e2 ? void 0 : e2.video)];
          case 1:
            return n2.sent(), [2, this.finalize(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromSongPath = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromSongPath(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromSongPath = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, (r2 = new Vn(this.managers, this.emitter, this._options)).createFromSongPath(t2, null == e2 ? void 0 : e2.video)];
          case 1:
            return n2.sent(), [2, this.finalize(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromSongId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromSongId(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromSongId = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, (r2 = new Vn(this.managers, this.emitter, this._options)).createFromSongId(t2, null == e2 ? void 0 : e2.video)];
          case 1:
            return n2.sent(), [2, this.finalize(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromSongCode = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromSongCode(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromSongCode = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, (r2 = new Vn(this.managers, this.emitter, this._options)).createFromSongCode(t2, null == e2 ? void 0 : e2.video)];
          case 1:
            return n2.sent(), [2, this.finalize(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromText = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromText(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromText = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        switch (n2.label) {
          case 0:
            return [4, (r2 = new Vn(this.managers, this.emitter, this._options)).createFromText(t2, null == e2 ? void 0 : e2.video)];
          case 1:
            return n2.sent(), [2, this.finalize(r2, e2)];
        }
      });
    });
  }, t.prototype.createFromJSON = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2 = this;
      return gn(this, function(n2) {
        return [2, this.create(function() {
          return r2.doCreateFromJSON(t2, e2);
        }, null == e2 ? void 0 : e2.dryRun)];
      });
    });
  }, t.prototype.doCreateFromJSON = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2;
      return gn(this, function(n2) {
        return (r2 = new Vn(this.managers, this.emitter, this._options)).createFromJSON(t2, null == e2 ? void 0 : e2.video), [2, this.finalize(r2, e2)];
      });
    });
  }, t.prototype.create = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2, n2 = this;
      return gn(this, function(i2) {
        if (this._videoPromise && !e2) throw new qi("Player.createFrom* method calls cannot run in parallel", this._videoPromise);
        return r2 = t2(), e2 || (this._videoPromise = r2, r2.finally(function() {
          return n2._videoPromise = null;
        })), [2, r2];
      });
    });
  }, t.prototype.finalize = function(t2, e2) {
    return yn(this, 0, void 0, function() {
      var r2, n2, i2, o2 = this;
      return gn(this, function(s2) {
        switch (s2.label) {
          case 0:
            return t2.video ? [4, Promise.all([t2.finalize(e2), this.backgroundGraphics.setBackground(t2.video.background)])] : [2, null];
          case 1:
            return s2.sent(), (null == e2 ? void 0 : e2.dryRun) ? [2, null] : (r2 = t2.video.json, function(t3, e3) {
              var r3 = e3.config, n3 = e3.song;
              r3 && "object" == typeof r3 && "number" == typeof r3.duration ? t3.duration = r3.duration : n3 ? t3.duration = 1e3 * n3.length : t3.duration || (t3.duration = t3.endTime);
            }(n2 = new ut(r2), { config: t2.video.config, song: t2.song }), [4, Promise.all([this.graphics.createRuntime(n2), zi(n2, { id: t2.video.id, data: r2, loader: function(t3) {
              return yn(o2, 0, void 0, function() {
                return gn(this, function(e3) {
                  switch (e3.label) {
                    case 0:
                      return [4, this.templates.loadForVideo(t3)];
                    case 1:
                      return e3.sent(), [2];
                  }
                });
              });
            }, deserializer: function(t3, e3) {
              return o2.templates.importInstances(t3, e3);
            } }), Wi(null == r2 ? void 0 : r2.phrases, { parser: R.parse.bind(R) })])]);
          case 2:
            return s2.sent(), this._data, this._video && this.templates.disposeInstances(this._video), this._data = t2, this._video = n2, this.emitter.onVideoReady(n2), i2 = (null == e2 ? void 0 : e2.altSourceUrl) || void 0, [4, this._timer.initialize({ player: this, updater: this.updateMediaPosition.bind(this), emitter: this.emitter, altSourceUrl: i2 })];
          case 3:
            return s2.sent(), this.emitter.onTimerReady(this._timer), [2, n2];
        }
      });
    });
  }, t.prototype.updateMediaPosition = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2 = this;
      return gn(this, function(r2) {
        return this._isVideoSeeking ? (this._mediaPosition = t2, this.emitter.onMediaSeek(t2), [2, t2]) : [2, this.stage.requestUpdate(t2).then(function(t3) {
          return e2._mediaPosition = t3, e2._videoPosition = t3, e2.emitter.onMediaSeek(t3), t3;
        })];
      });
    });
  }, t.prototype.exportVideo = function(t2) {
    var e2, r2, n2, i2, o2, s2, a2;
    return void 0 === t2 && (t2 = { legacyStringMode: true }), yn(this, 0, void 0, function() {
      var u2, c2, l2, p2;
      return gn(this, function(h2) {
        return u2 = { sourceId: (null === (e2 = this._data.video) || void 0 === e2 ? void 0 : e2.id) || -1, sourceOriginId: (null === (r2 = this._data.video) || void 0 === r2 ? void 0 : r2.sourceOriginId) || -1, songleId: (null === (n2 = this._data.song) || void 0 === n2 ? void 0 : n2.id) || -1, lyricId: this._data.lyricsId || -1, lyricDiffId: (null === (i2 = this._data.lyrics) || void 0 === i2 ? void 0 : i2.id) || -1, config: ((null == t2 ? void 0 : t2.legacyStringMode) ? (null === (o2 = this._data.video) || void 0 === o2 ? void 0 : o2.config) && JSON.stringify(this._data.video.config) : null === (s2 = this._data.video) || void 0 === s2 ? void 0 : s2.config) || null }, c2 = this.backgroundGraphics.exportPartialVideoEntry(t2), l2 = (null === (a2 = this._video) || void 0 === a2 ? void 0 : a2.exportData(this._templates)) || null, p2 = (null == t2 ? void 0 : t2.legacyStringMode) ? JSON.stringify(l2) : l2, [2, fn(fn(fn({}, u2), c2), { json: p2 })];
      });
    });
  }, t.prototype.getChoruses = function() {
    return this._data.getChoruses();
  }, t.prototype.findChorus = function(t2, e2) {
    return this._data.findChorus(t2, e2);
  }, t.prototype.findChorusBetween = function(t2, e2) {
    return this._data.findChorusBetween(t2, e2);
  }, t.prototype.findChorusChange = function(t2, e2) {
    return this._data.findChorusChange(t2, e2);
  }, t.prototype.getBeats = function() {
    return this._data.getBeats();
  }, t.prototype.findBeat = function(t2, e2) {
    return this._data.findBeat(t2, e2);
  }, t.prototype.findBeatChange = function(t2, e2) {
    return this._data.findBeatChange(t2, e2);
  }, t.prototype.getChords = function() {
    return this._data.getChords();
  }, t.prototype.findChord = function(t2, e2) {
    return this._data.findChord(t2, e2);
  }, t.prototype.findChordChange = function(t2, e2) {
    return this._data.findChordChange(t2, e2);
  }, t.prototype.getVocalFrequency = function(t2) {
    return this._data.getVocalFrequency(t2);
  }, t.prototype.getVocalAmplitude = function(t2) {
    return this._data.getVocalAmplitude(t2);
  }, t.prototype.getMaxVocalAmplitude = function() {
    return this._data.getMaxVocalAmplitude();
  }, t.prototype.getValenceArousal = function(t2) {
    return this._data.getValenceArousal(t2);
  }, t.prototype.getMedianValenceArousal = function() {
    return this._data.getMedianValenceArousal();
  }, t.prototype.resize = function(t2) {
    return this.emitter.onResize(t2);
  }, t.prototype.onResize = function(t2) {
    return this.resize(t2);
  }, t.prototype.setStageElement = function(t2) {
    return this._stageElement = t2, this.emitter.onStageElementSet(t2);
  }, t.prototype.setMediaElement = function(t2) {
    this.mediaElement = t2;
  }, t.prototype.updateMediaElement = function(t2) {
    "undefined" != typeof document && (this._mediaElement && Yi(this._mediaElement), t2 ? (Yi(t2), this._mediaSourceElement || (this._mediaSourceElement = document.createElement("div"), this._mediaSourceElement.classList.add("textalive-media-wrapper")), t2.appendChild(this._mediaSourceElement), this._mediaBannerElement || (this._mediaBannerElement = document.createElement("div"), this._mediaSourceElement.classList.add("textalive-banner-wrapper")), t2.appendChild(this._mediaBannerElement)) : (this._mediaSourceElement = null, this._mediaBannerElement = null)), this._mediaElement = t2, this.emitter.onMediaElementSet(t2);
  }, t.prototype.setVideoPosition = function(t2) {
    return yn(this, 0, void 0, function() {
      var e2 = this;
      return gn(this, function(r2) {
        return [2, this.stage.requestUpdate(t2).then(function(t3) {
          return e2._videoPosition = t3, e2.emitter.onVideoSeek(t3), t3;
        })];
      });
    });
  }, t.prototype.setMediaPosition = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return this.requestMediaSeek(t2), [2];
      });
    });
  }, t.prototype.requestPlay = function() {
    return this._timer.play(), true;
  }, t.prototype.requestStop = function() {
    return this._timer.stop(), true;
  }, t.prototype.requestPause = function() {
    return this._timer.pause(), true;
  }, t.prototype.requestMediaSeek = function(t2) {
    return this._timer.seek(t2), true;
  }, t.prototype.startVideoSeek = function() {
    return this._isVideoSeeking = true, this.emitter.onVideoSeekStart();
  }, t.prototype.endVideoSeek = function() {
    return this._isVideoSeeking = false, this.emitter.onVideoSeekEnd();
  }, t.prototype.requestSettingBackground = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return [2, this.backgroundGraphics.settingBackground(t2)];
      });
    });
  }, t.prototype.requestSetBackground = function(t2) {
    return yn(this, 0, void 0, function() {
      return gn(this, function(e2) {
        return [2, this.backgroundGraphics.setBackground(t2)];
      });
    });
  }, t.prototype.requestStageUpdate = function() {
    return yn(this, 0, void 0, function() {
      return gn(this, function(t2) {
        return [2, this.stage.requestUpdate()];
      });
    });
  }, t.prototype.onStageUpdate = function(t2) {
    this._isVideoSeeking || this.emitter.onTimeUpdate(t2);
  }, t.prototype.dispose = function() {
    this._timer && (this._timer.dispose(), this._timer = null), this.mediaElement && (Yi(this._mediaElement), this._mediaElement = null), this.stageElement && (this._stageElement = null), this.emitter.onDispose();
  }, t;
}();
console.log("# \n\n\n\n\n\nTextAlive App API\nTextAlive App API TextAlive https://textalive.jp/  https://developer.textalive.jp/ \n\n# \n\ntextalive-ml@aist.go.jp");
var Xi = r.sortedIndex;
export {
  wn as BasicTimer,
  X as Color,
  Ai as Ease,
  pt as Matrix2D,
  Hi as Player,
  Fi as PlayerLogoImage,
  ht as Point,
  En as SongleTimer,
  $ as TimedUnit,
  n as UnitTypes,
  S as dataUrlToString,
  st as findTimedObject,
  at as findTimedObjectsInRange,
  O as isStringEncodedDataUrl,
  Xi as sortedIndex,
  T as stringToDataUrl
};
//# sourceMappingURL=textalive-app-api.js.map
